<transformation>
  <info>
    <name>TR_FACT_POLICYCOVERAGE</name>
    <description>Calculates the monthly values for each coverage on a policy.</description>
    <extended_description/>
    <trans_version/>
    <trans_type>Normal</trans_type>
    <trans_status>0</trans_status>
    <directory>/Facts/Transformations</directory>
    <parameters>
    </parameters>
    <log>
      <trans-log-table>
        <connection/>
        <schema/>
        <table/>
        <size_limit_lines/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STATUS</id>
          <enabled>Y</enabled>
          <name>STATUS</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
          <subject/>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
          <subject/>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
          <subject/>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
          <subject/>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
          <subject/>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>STARTDATE</id>
          <enabled>Y</enabled>
          <name>STARTDATE</name>
        </field>
        <field>
          <id>ENDDATE</id>
          <enabled>Y</enabled>
          <name>ENDDATE</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>DEPDATE</id>
          <enabled>Y</enabled>
          <name>DEPDATE</name>
        </field>
        <field>
          <id>REPLAYDATE</id>
          <enabled>Y</enabled>
          <name>REPLAYDATE</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>Y</enabled>
          <name>LOG_FIELD</name>
        </field>
        <field>
          <id>EXECUTING_SERVER</id>
          <enabled>N</enabled>
          <name>EXECUTING_SERVER</name>
        </field>
        <field>
          <id>EXECUTING_USER</id>
          <enabled>N</enabled>
          <name>EXECUTING_USER</name>
        </field>
        <field>
          <id>CLIENT</id>
          <enabled>N</enabled>
          <name>CLIENT</name>
        </field>
      </trans-log-table>
      <perf-log-table>
        <connection/>
        <schema/>
        <table/>
        <interval/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>SEQ_NR</id>
          <enabled>Y</enabled>
          <name>SEQ_NR</name>
        </field>
        <field>
          <id>LOGDATE</id>
          <enabled>Y</enabled>
          <name>LOGDATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>INPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>INPUT_BUFFER_ROWS</name>
        </field>
        <field>
          <id>OUTPUT_BUFFER_ROWS</id>
          <enabled>Y</enabled>
          <name>OUTPUT_BUFFER_ROWS</name>
        </field>
      </perf-log-table>
      <channel-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>LOGGING_OBJECT_TYPE</id>
          <enabled>Y</enabled>
          <name>LOGGING_OBJECT_TYPE</name>
        </field>
        <field>
          <id>OBJECT_NAME</id>
          <enabled>Y</enabled>
          <name>OBJECT_NAME</name>
        </field>
        <field>
          <id>OBJECT_COPY</id>
          <enabled>Y</enabled>
          <name>OBJECT_COPY</name>
        </field>
        <field>
          <id>REPOSITORY_DIRECTORY</id>
          <enabled>Y</enabled>
          <name>REPOSITORY_DIRECTORY</name>
        </field>
        <field>
          <id>FILENAME</id>
          <enabled>Y</enabled>
          <name>FILENAME</name>
        </field>
        <field>
          <id>OBJECT_ID</id>
          <enabled>Y</enabled>
          <name>OBJECT_ID</name>
        </field>
        <field>
          <id>OBJECT_REVISION</id>
          <enabled>Y</enabled>
          <name>OBJECT_REVISION</name>
        </field>
        <field>
          <id>PARENT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>PARENT_CHANNEL_ID</name>
        </field>
        <field>
          <id>ROOT_CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>ROOT_CHANNEL_ID</name>
        </field>
      </channel-log-table>
      <step-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>TRANSNAME</id>
          <enabled>Y</enabled>
          <name>TRANSNAME</name>
        </field>
        <field>
          <id>STEPNAME</id>
          <enabled>Y</enabled>
          <name>STEPNAME</name>
        </field>
        <field>
          <id>STEP_COPY</id>
          <enabled>Y</enabled>
          <name>STEP_COPY</name>
        </field>
        <field>
          <id>LINES_READ</id>
          <enabled>Y</enabled>
          <name>LINES_READ</name>
        </field>
        <field>
          <id>LINES_WRITTEN</id>
          <enabled>Y</enabled>
          <name>LINES_WRITTEN</name>
        </field>
        <field>
          <id>LINES_UPDATED</id>
          <enabled>Y</enabled>
          <name>LINES_UPDATED</name>
        </field>
        <field>
          <id>LINES_INPUT</id>
          <enabled>Y</enabled>
          <name>LINES_INPUT</name>
        </field>
        <field>
          <id>LINES_OUTPUT</id>
          <enabled>Y</enabled>
          <name>LINES_OUTPUT</name>
        </field>
        <field>
          <id>LINES_REJECTED</id>
          <enabled>Y</enabled>
          <name>LINES_REJECTED</name>
        </field>
        <field>
          <id>ERRORS</id>
          <enabled>Y</enabled>
          <name>ERRORS</name>
        </field>
        <field>
          <id>LOG_FIELD</id>
          <enabled>N</enabled>
          <name>LOG_FIELD</name>
        </field>
      </step-log-table>
      <metrics-log-table>
        <connection/>
        <schema/>
        <table/>
        <timeout_days/>
        <field>
          <id>ID_BATCH</id>
          <enabled>Y</enabled>
          <name>ID_BATCH</name>
        </field>
        <field>
          <id>CHANNEL_ID</id>
          <enabled>Y</enabled>
          <name>CHANNEL_ID</name>
        </field>
        <field>
          <id>LOG_DATE</id>
          <enabled>Y</enabled>
          <name>LOG_DATE</name>
        </field>
        <field>
          <id>METRICS_DATE</id>
          <enabled>Y</enabled>
          <name>METRICS_DATE</name>
        </field>
        <field>
          <id>METRICS_CODE</id>
          <enabled>Y</enabled>
          <name>METRICS_CODE</name>
        </field>
        <field>
          <id>METRICS_DESCRIPTION</id>
          <enabled>Y</enabled>
          <name>METRICS_DESCRIPTION</name>
        </field>
        <field>
          <id>METRICS_SUBJECT</id>
          <enabled>Y</enabled>
          <name>METRICS_SUBJECT</name>
        </field>
        <field>
          <id>METRICS_TYPE</id>
          <enabled>Y</enabled>
          <name>METRICS_TYPE</name>
        </field>
        <field>
          <id>METRICS_VALUE</id>
          <enabled>Y</enabled>
          <name>METRICS_VALUE</name>
        </field>
      </metrics-log-table>
    </log>
    <maxdate>
      <connection/>
      <table/>
      <field/>
      <offset>0.0</offset>
      <maxdiff>0.0</maxdiff>
    </maxdate>
    <size_rowset>50000</size_rowset>
    <sleep_time_empty>50</sleep_time_empty>
    <sleep_time_full>50</sleep_time_full>
    <unique_connections>N</unique_connections>
    <feedback_shown>Y</feedback_shown>
    <feedback_size>250000</feedback_size>
    <using_thread_priorities>Y</using_thread_priorities>
    <shared_objects_file/>
    <capture_step_performance>N</capture_step_performance>
    <step_performance_capturing_delay>1000</step_performance_capturing_delay>
    <step_performance_capturing_size_limit>100</step_performance_capturing_size_limit>
    <dependencies>
    </dependencies>
    <partitionschemas>
    </partitionschemas>
    <slaveservers>
      <slaveserver>
        <name>4Sight BI - PDI Server</name>
        <hostname>10.0.0.21</hostname>
        <port>9080</port>
        <webAppName>pentaho-di</webAppName>
        <username>joe</username>
        <password>Encrypted 2be98afc86aa7f2e4bb18bd63c99dbdde</password>
        <proxy_hostname/>
        <proxy_port/>
        <non_proxy_hosts/>
        <master>Y</master>
        <sslMode>N</sslMode>
      </slaveserver>
    </slaveservers>
    <clusterschemas>
    </clusterschemas>
    <created_user>admin</created_user>
    <created_date>2011/09/26 23:04:53.000</created_date>
    <modified_user>joe</modified_user>
    <modified_date>2024/01/19 15:30:09.014</modified_date>
    <key_for_session_key>H4sIAAAAAAAAAAMAAAAAAAAAAAA=</key_for_session_key>
    <is_key_private>N</is_key_private>
  </info>
  <notepads>
  </notepads>
  <connection>
    <name>4SBI_DataWarehouse</name>
    <server>${FSBI_DB_DATAWAREHOUSE_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${FSBI_DB_DATAWAREHOUSE_DATABASENAME}</database>
    <port>-1</port>
    <username>${FSBI_DB_DATAWAREHOUSE_USERNAME}</username>
    <password>${FSBI_DB_DATAWAREHOUSE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>-1</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>4SBI_Redshift</name>
    <server>&#x24;&#x7b;FSBI_DB_REDSHIFT_HOSTNAME&#x7d;</server>
    <type>REDSHIFT</type>
    <access>Native</access>
    <database>pentaho</database>
    <port>5439</port>
    <username>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_REDSHIFT.loginTimeout</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_REDSHIFT.tcpKeepAlive</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5439</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>jdbcAuthMethod</code>
        <attribute>Standard</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>4SBI_Staging</name>
    <server>${FSBI_DB_STAGING_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${FSBI_DB_STAGING_DATABASENAME}</database>
    <port>-1</port>
    <username>${FSBI_DB_STAGING_USERNAME}</username>
    <password>${FSBI_DB_STAGING_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>-1</attribute>
      </attribute>
      <attribute>
        <code>PREFERRED_SCHEMA_NAME</code>
        <attribute>dbo</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>set nocount on;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>AgileBI</name>
    <server>localhost</server>
    <type>MONETDB</type>
    <access>Native</access>
    <database>pentaho-instaview</database>
    <port>50000</port>
    <username>monetdb</username>
    <password>Encrypted 2be98afc86aa7f2e4cb14a17edb86abd8</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <read_only>true</read_only>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_INFOBRIGHT.characterEncoding</code>
        <attribute>UTF-8</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>50000</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>CSE_BI</name>
    <server>${FSBI_DB_STAGING_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>CSE_BI</database>
    <port>-1</port>
    <username>${FSBI_DB_STAGING_USERNAME}</username>
    <password>${FSBI_DB_STAGING_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>-1</attribute>
      </attribute>
      <attribute>
        <code>PREFERRED_SCHEMA_NAME</code>
        <attribute>dbo</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>set nocount on;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>EC2_MSSQL_CSE_DataWarehouse</name>
    <server>${EC2_MSSQL_CSE_DATAWAREHOUSE_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${EC2_MSSQL_CSE_DATAWAREHOUSE_DATABASENAME}</database>
    <port>1433</port>
    <username>${EC2_MSSQL_CSE_DATAWAREHOUSE_USERNAME}</username>
    <password>${EC2_MSSQL_CSE_DATAWAREHOUSE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>SET NOCOUNT ON;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>ISCS_CSE_DataWarehouse</name>
    <server>${ISCS_CSE_DB_DATAWAREHOUSE_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${ISCS_CSE_DB_DATAWAREHOUSE_DATABASENAME}</database>
    <port>1433</port>
    <username>${ISCS_CSE_DB_DATAWAREHOUSE_USERNAME}</username>
    <password>${ISCS_CSE_DB_DATAWAREHOUSE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>SET NOCOUNT ON;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Mkt01</name>
    <server>REMOVED</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>prodCSE</database>
    <port>-1</port>
    <username>REMOVED</username>
    <password>REMOVED</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>-1</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>set nocount on;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>PROD-ETL</name>
    <server>prod-etl</server>
    <type>MSSQL</type>
    <access>Native</access>
    <database>FSBI_DW_SPINN</database>
    <port>1433</port>
    <username>REMOVED</username>
    <password>Encrypted 2be98afc86aa7f2e4cb79ce10d881add3</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Prod_DB</name>
    <server>${FSBI_DB_SOURCE_HOSTNAME}</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${FSBI_DB_SOURCE_DATABASENAME}</database>
    <port>3306</port>
    <username>${FSBI_DB_SOURCE_USERNAME}</username>
    <password>${FSBI_DB_SOURCE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>RDS_MSSQL_CSE_DataWarehouse</name>
    <server>${RDS_MSSQL_CSE_DATAWAREHOUSE_HOSTNAME}</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>${RDS_MSSQL_CSE_DATAWAREHOUSE_DATABASENAME}</database>
    <port>1433</port>
    <username>${RDS_MSSQL_CSE_DATAWAREHOUSE_USERNAME}</username>
    <password>${RDS_MSSQL_CSE_DATAWAREHOUSE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code>
        <attribute>3</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>MSSQLUseIntegratedSecurity</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>1433</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SQL_CONNECT</code>
        <attribute>SET NOCOUNT ON;</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Redshift</name>
    <server>ec2-52-33-70-247.us-west-2.compute.amazonaws.com</server>
    <type>REDSHIFT</type>
    <access>Native</access>
    <database>pentaho</database>
    <port>5439</port>
    <username>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_REDSHIFT.loginTimeout</code>
        <attribute>10</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_REDSHIFT.tcpKeepAlive</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>5439</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Source_DB</name>
    <server>${FSBI_DB_SOURCE_HOSTNAME}</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${FSBI_DB_SOURCE_DATABASENAME}</database>
    <port>3306</port>
    <username>${FSBI_DB_SOURCE_USERNAME}</username>
    <password>${FSBI_DB_SOURCE_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCompression</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useServerPrepStmts</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <connection>
    <name>Source_DB_READ</name>
    <server>${SOURCE_DB_READ_HOSTNAME}</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>${SOURCE_DB_READ_DATABASENAME}</database>
    <port>3306</port>
    <username>${SOURCE_DB_READ_USERNAME}</username>
    <password>${SOURCE_DB_READ_USERPASSWORD}</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.defaultFetchSize</code>
        <attribute>500</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCompression</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useCursorFetch</code>
        <attribute>true</attribute>
      </attribute>
      <attribute>
        <code>EXTRA_OPTION_MYSQL.useServerPrepStmts</code>
        <attribute>false</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_LOWERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>FORCE_IDENTIFIERS_TO_UPPERCASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>IS_CLUSTERED</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>PORT_NUMBER</code>
        <attribute>3306</attribute>
      </attribute>
      <attribute>
        <code>PRESERVE_RESERVED_WORD_CASE</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>QUOTE_ALL_FIELDS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>STREAM_RESULTS</code>
        <attribute>N</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_BOOLEAN_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>SUPPORTS_TIMESTAMP_DATA_TYPE</code>
        <attribute>Y</attribute>
      </attribute>
      <attribute>
        <code>USE_POOLING</code>
        <attribute>N</attribute>
      </attribute>
    </attributes>
  </connection>
  <order>
    <hop>
      <from>Status</from>
      <to>Lookup (policytransaction status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Calc Earned/Unearned Premium</from>
      <to>Zero Out History Records</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input (cancel status)</from>
      <to>Lookup (policy cancel status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Prior Policy Coverage</from>
      <to>Lkup (prior policy coverage)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input (Orig Covg Expiration)</from>
      <to>Lookup (orig covg expiration)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DB Lookup (policy transaction)</from>
      <to>JS: Calculate Summaries</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JS: Calculate Summaries</from>
      <to>Select values</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>New Issued Status</from>
      <to>Lkup (new issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Renew Issued Status</from>
      <to>Lkup (renew issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Nonrenew Issued Status</from>
      <to>Lkup (nonrenew issue status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Endorsement Issued Status</from>
      <to>Lkup (endorsement issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lkup (prior policy coverage)</from>
      <to>Javascript: Calc YTD, ITD</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup (orig covg expiration)</from>
      <to>Calc Earned/Unearned Premium</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Default Unknowns</from>
      <to>Add sequence</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table Input (fact_policytransaction)</from>
      <to>Rename Fields</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Zero Out History Records</from>
      <to>DB Lookup (policy transaction)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>DB Lookup (policy status id)</from>
      <to>Lkup (endorsement issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lkup (endorsement issued status)</from>
      <to>Lkup (nonrenew issue status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lkup (nonrenew issue status)</from>
      <to>Lkup (renew issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lkup (renew issued status)</from>
      <to>Lkup (new issued status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Select values</from>
      <to>Group by</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup (policytransaction status)</from>
      <to>JS: Determine Inforce</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>JS: Determine Inforce</from>
      <to>DB Lookup (policy status id)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Table input (DIM IDs)</from>
      <to>Lookup (DIM IDs)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Group by</from>
      <to>Lookup (DIM IDs)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup (DIM IDs)</from>
      <to>Lookup (policy cancel status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Rename Fields</from>
      <to>Get Period Dates</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Period Dates</from>
      <to>Lookup (orig covg expiration)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lookup (policy cancel status)</from>
      <to>Get processingDate</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get processingDate</from>
      <to>Set Cancel &amp; Expire Status</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Lkup (new issued status)</from>
      <to>Get Variables (periodEndDate)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Variables (periodEndDate)</from>
      <to>Lkup (prior policy coverage)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Convert Dates to IDs</from>
      <to>Default Unknowns</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Set Cancel &amp; Expire Status</from>
      <to>Map Risk Delete Status</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Map Risk Delete Status</from>
      <to>Lookup (policytransaction status)</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Javascript: Calc YTD, ITD</from>
      <to>Convert Dates to IDs</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Add sequence</from>
      <to>Get Variables loadId</to>
      <enabled>Y</enabled>
    </hop>
    <hop>
      <from>Get Variables loadId</from>
      <to>Table output</to>
      <enabled>Y</enabled>
    </hop>
  </order>
  <step>
    <name>Add sequence</name>
    <type>Sequence</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <valuename>FACTPOLICYCOVERAGE_ID</valuename>
    <use_database>N</use_database>
    <connection/>
    <schema/>
    <seqname>SEQ_</seqname>
    <use_counter>Y</use_counter>
    <counter_name/>
    <start_at>${MAX_POLICYCOVERAGE_ID}</start_at>
    <increment_by>1</increment_by>
    <max_value>99999999999</max_value>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>902</xloc>
      <yloc>977</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Calc Earned/Unearned Premium</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Premium Earnings</jsScript_name>
        <jsScript_script>var earnedStartDate;
var earnedEndDate;
var earnFromDate;
var earnToDate;
var earnedPremium = 0;
var unearnedPremium = 0;
var earnedPremiumITD = 0;
var earnedAtInception = 0;



earnFromDate = TRANSACTIONEFFECTIVEDATE;
earnToDate = ORIG_COVERAGEEXPIRATIONDATE;
//Not used in SPINN and set to default
EARNINGSTYPE = "Y";
PERCENTEARNEDINCEPTION = 0.000;
EARNFROM_DATE=defaultDate;
EARNTO_DATE=defaultDate;

if (EARNINGSTYPE == "O" || EARNINGSTYPE == "Y") {

    // if earnFromDate and earnToDate are defaulted then set them to transactionEffectiveDate and original coverage expiration date

    if (EARNFROM_DATE.getTime() > defaultDate.getTime()) {
        earnFromDate = EARNFROM_DATE;
    } else {
    	earnFromDate = TRANSACTIONEFFECTIVEDATE;
    }

    if (EARNTO_DATE.getTime() > defaultDate.getTime()) {
        earnToDate = EARNTO_DATE;
    } else {
		// if no coverage is supplied then use the policy expiration date
 		if (COVERAGE_UNIQUEID == "Unknown") {
    		earnToDate = POLICYEXPIRATIONDATE;	
		} else {
        	earnToDate = ORIG_COVERAGEEXPIRATIONDATE;
		}
    }

	// If the coverage is expired (coverage expiration is before period start date) // then set earned and unearned MTD to zero and don't calculate any values

	if (earnToDate.getTime() &lt; periodStartDate.getTime() &amp;&amp; ACCOUNTINGDATE.getTime() &lt; periodStartDate.getTime()) {
	    earnedPremium = 0;
	    unearnedPremium = 0;
	} else {
            // Determine the start date to use for calculating the earned premium
            if (earnFromDate.getTime() > periodStartDate.getTime()) 
			  earnedStartDate = earnFromDate
            else
            // Check if the effective date is less than the accounting date.
            //  If it is we need to earn from the effective date
            if (ACCOUNTINGDATE.getTime() >= periodStartDate.getTime() &amp;&amp; earnFromDate.getTime() &lt; ACCOUNTINGDATE.getTime()) 
			  earnedStartDate = earnFromDate
            else 
			  earnedStartDate = periodStartDate;

            // Determine the end date to use for calculating the earned premium
            if (earnToDate.getTime() &lt; periodEndDate.getTime()) 
			  earnedEndDate = earnToDate
            else 
			  if (earnToDate.getTime() != periodEndDate.getTime()) 
			    earnedEndDate = dateAdd(periodEndDate, "d", 1)
			  else
 				earnedEndDate = periodEndDate;

            // Determine the policy term in days, set it to one if the earn from and to dates equal
			if (earnFromDate.getTime() == earnToDate.getTime())
            	var policyTermLength = 1
			else
				var policyTermLength = dateDiff(earnFromDate, earnToDate, "d");

            // Determine the length of the evaluation period in days
			if (earnedStartDate.getTime() == earnedEndDate.getTime())
				var evalLength = 1
			else
                var evalLength = dateDiff(earnedStartDate, earnedEndDate, "d");

            // If the policy term is greater than zero then calc earned and unearned
            // otherwise set them to zero
            if (policyTermLength > 0) {

                // Calculate daily amount
                //var dailyPremium = Math.round(AMOUNT / policyTermLength * 1000) / 1000;
				var dailyPremium = AMOUNT / policyTermLength;

                // Calculate the earned premium amount
                earnedPremium = Math.round(evalLength * dailyPremium * 100) / 100;

                if (!isNum(earnedPremium)) earnedPremium = 0;


                // **** Calculate unearned, 1st need to calculate what has been earned
                //    from coverage inception then subtract from written

                // Set earned start date as the transaction effective date
                earnedStartDate = TRANSACTIONEFFECTIVEDATE;

                // If the coverage expiration date is before the period end date then
                // the coverage is fully earned so the unearned is 0
                if (earnedEndDate.getTime() &lt; periodEndDate.getTime()) {
                    unearnedPremium = 0;
                } else {
                    // Determine the length of the evaluation period in days
                    evalLength = dateDiff(earnedStartDate, earnedEndDate, "d");

                    // Calculate daily amount
                    var dailyPremium = Math.round(AMOUNT / policyTermLength * 1000) / 1000;

                    // Calculate the earned premium amount
                    var earnedPremiumITD = Math.round(evalLength * dailyPremium * 100) / 100;

                    // Calculate the unearned premium amount
                    unearnedPremium = AMOUNT - earnedPremiumITD;
                }
            } else {
                earnedPremium = 0.00;
                unearnedPremium = 0.00;
            }

			// If percentage earned at inception then calculate values

			if (PERCENTEARNEDINCEPTION > 0) {

				earnedAtInception = PERCENTEARNEDINCEPTION * AMOUNT;
	
				// Calculate the amount earned for the month
				if (month(TRANSACTIONEFFECTIVEDATE) == month(periodStartDate) &amp;&amp; year(TRANSACTIONEFFECTIVEDATE) == year(periodStartDate) &amp;&amp; ACCOUNTINGDATE.getTime() &lt;= periodEndDate.getTime()) {
					earnedPremium = earnedAtInception;
					unearnedPremium = AMOUNT - earnedAtInception;
				} else {
					// If it is a back dated effective date, then take the higher of the
					// earnedPremium or earned at inception premium
					if(TRANSACTIONEFFECTIVEDATE.getTime() &lt; periodStartDate.getTime() &amp;&amp; TRANSACTIONEFFECTIVEDATE.getTime() &lt; ACCOUNTINGDATE.getTime()  &amp;&amp; ACCOUNTINGDATE.getTime() > periodStartDate.getTime()) {
						if(earnedAtInception > earnedPremium) {
							earnedPremium = earnedAtInception;
						}
					} else {
						if (earnedPremiumITD > earnedAtInception) {
							if ((earnedPremiumITD - earnedAtInception) &lt;= earnedPremium) {
								earnedPremium = earnedPremiumITD - earnedAtInception;
								unearnedPremium = AMOUNT - earnedPremiumITD;
							}
						} else {
							earnedPremium = 0;
							unearnedPremium = AMOUNT - earnedAtInception;
						}
					}

				}
			}

            if (!isNum(unearnedPremium)) unearnedPremium = 0;
	}
}


// Set the AMOUNT to zero if this transaction is only for earnings.
// It should not be included in normal written premium amounts.
var newAmount = 0;

if (EARNINGSTYPE != "O") {
    newAmount = AMOUNT;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>earnedPremium</name>
        <rename>earnedPremium</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>unearnedPremium</name>
        <rename>unearnedPremium</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>newAmount</name>
        <rename>AMOUNT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Convert Dates to IDs</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <select_unspecified>N</select_unspecified>
      <meta>
        <name>COV_EFFECTIVEDATE</name>
        <rename>COVERAGEEFFECTIVEDATE_ID</rename>
        <type>String</type>
        <length>8</length>
        <precision>-2</precision>
        <conversion_mask>yyyyMMdd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
      <meta>
        <name>COV_EXPIRATIONDATE</name>
        <rename>COVERAGEEXPIRATIONDATE_ID</rename>
        <type>String</type>
        <length>8</length>
        <precision>-2</precision>
        <conversion_mask>yyyyMMdd</conversion_mask>
        <date_format_lenient>false</date_format_lenient>
        <date_format_locale/>
        <date_format_timezone/>
        <lenient_string_to_number>false</lenient_string_to_number>
        <encoding/>
        <decimal_symbol/>
        <grouping_symbol/>
        <currency_symbol/>
        <storage_type/>
      </meta>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>518</xloc>
      <yloc>977</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DB Lookup (policy status id)</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <cache>Y</cache>
    <cache_load_all>N</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>VDIM_POLICYSTATUS</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>POLICYSTATUS_CODE</name>
        <field>POLST_4SIGHTBISTATUSCD</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>POLICYSTATUS_ID</name>
        <rename>POLICYSTATUS_ID</rename>
        <default>0</default>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>518</xloc>
      <yloc>733</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>DB Lookup (policy transaction)</name>
    <type>DBLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <cache>Y</cache>
    <cache_load_all>Y</cache_load_all>
    <cache_size>0</cache_size>
    <lookup>
      <schema/>
      <table>DIM_POLICYTRANSACTIONTYPE</table>
      <orderby/>
      <fail_on_multiple>N</fail_on_multiple>
      <eat_row_on_failure>N</eat_row_on_failure>
      <key>
        <name>POLICYTRANSACTIONTYPE_ID</name>
        <field>POLICYTRANSACTIONTYPE_ID</field>
        <condition>=</condition>
        <name2/>
      </key>
      <value>
        <name>PTRANS_4SIGHTBICODE</name>
        <rename>PTRANS_4SIGHTBICODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_CODE</name>
        <rename>PTRANS_CODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_NAME</name>
        <rename>PTRANS_NAME</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_DESCRIPTION</name>
        <rename>PTRANS_DESCRIPTION</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_SUBCODE</name>
        <rename>PTRANS_SUBCODE</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_SUBNAME</name>
        <rename>PTRANS_SUBNAME</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_SUBDESCRIPTION</name>
        <rename>PTRANS_SUBDESCRIPTION</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_WRITTENPREM</name>
        <rename>PTRANS_WRITTENPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_COMMISSION</name>
        <rename>PTRANS_COMMISSION</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_GROSSWRITTENPREM</name>
        <rename>PTRANS_GROSSWRITTENPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_ORIGINALWRITTENPREM</name>
        <rename>PTRANS_ORIGINALWRITTENPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_EARNEDPREM</name>
        <rename>PTRANS_EARNEDPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_GROSSEARNEDPREM</name>
        <rename>PTRANS_GROSSEARNEDPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_EARNEDCOMMISSION</name>
        <rename>PTRANS_EARNEDCOMMISSION</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_MANUALWRITTENPREM</name>
        <rename>PTRANS_MANUALWRITTENPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_ENDORSEMENTPREM</name>
        <rename>PTRANS_ENDORSEMENTPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_AUDITPREM</name>
        <rename>PTRANS_AUDITPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_CANCELLATIONPREM</name>
        <rename>PTRANS_CANCELLATIONPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_REINSTATEMENTPREM</name>
        <rename>PTRANS_REINSTATEMENTPREM</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_TAXES</name>
        <rename>PTRANS_TAXES</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_FEES</name>
        <rename>PTRANS_FEES</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY1</name>
        <rename>PTRANS_USERDEFINEDSUMMARY1</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY2</name>
        <rename>PTRANS_USERDEFINEDSUMMARY2</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY3</name>
        <rename>PTRANS_USERDEFINEDSUMMARY3</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY4</name>
        <rename>PTRANS_USERDEFINEDSUMMARY4</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY5</name>
        <rename>PTRANS_USERDEFINEDSUMMARY5</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY6</name>
        <rename>PTRANS_USERDEFINEDSUMMARY6</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY7</name>
        <rename>PTRANS_USERDEFINEDSUMMARY7</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY8</name>
        <rename>PTRANS_USERDEFINEDSUMMARY8</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY9</name>
        <rename>PTRANS_USERDEFINEDSUMMARY9</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY10</name>
        <rename>PTRANS_USERDEFINEDSUMMARY10</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY11</name>
        <rename>PTRANS_USERDEFINEDSUMMARY11</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY12</name>
        <rename>PTRANS_USERDEFINEDSUMMARY12</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY13</name>
        <rename>PTRANS_USERDEFINEDSUMMARY13</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY14</name>
        <rename>PTRANS_USERDEFINEDSUMMARY14</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY15</name>
        <rename>PTRANS_USERDEFINEDSUMMARY15</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY16</name>
        <rename>PTRANS_USERDEFINEDSUMMARY16</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY17</name>
        <rename>PTRANS_USERDEFINEDSUMMARY17</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY18</name>
        <rename>PTRANS_USERDEFINEDSUMMARY18</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY19</name>
        <rename>PTRANS_USERDEFINEDSUMMARY19</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY20</name>
        <rename>PTRANS_USERDEFINEDSUMMARY20</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY21</name>
        <rename>PTRANS_USERDEFINEDSUMMARY21</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY22</name>
        <rename>PTRANS_USERDEFINEDSUMMARY22</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY23</name>
        <rename>PTRANS_USERDEFINEDSUMMARY23</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY24</name>
        <rename>PTRANS_USERDEFINEDSUMMARY24</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY25</name>
        <rename>PTRANS_USERDEFINEDSUMMARY25</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY26</name>
        <rename>PTRANS_USERDEFINEDSUMMARY26</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY27</name>
        <rename>PTRANS_USERDEFINEDSUMMARY27</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY28</name>
        <rename>PTRANS_USERDEFINEDSUMMARY28</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY29</name>
        <rename>PTRANS_USERDEFINEDSUMMARY29</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY30</name>
        <rename>PTRANS_USERDEFINEDSUMMARY30</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY31</name>
        <rename>PTRANS_USERDEFINEDSUMMARY31</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY32</name>
        <rename>PTRANS_USERDEFINEDSUMMARY32</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY33</name>
        <rename>PTRANS_USERDEFINEDSUMMARY33</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY34</name>
        <rename>PTRANS_USERDEFINEDSUMMARY34</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY35</name>
        <rename>PTRANS_USERDEFINEDSUMMARY35</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY36</name>
        <rename>PTRANS_USERDEFINEDSUMMARY36</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY37</name>
        <rename>PTRANS_USERDEFINEDSUMMARY37</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY38</name>
        <rename>PTRANS_USERDEFINEDSUMMARY38</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY39</name>
        <rename>PTRANS_USERDEFINEDSUMMARY39</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY40</name>
        <rename>PTRANS_USERDEFINEDSUMMARY40</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY41</name>
        <rename>PTRANS_USERDEFINEDSUMMARY41</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY42</name>
        <rename>PTRANS_USERDEFINEDSUMMARY42</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY43</name>
        <rename>PTRANS_USERDEFINEDSUMMARY43</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY44</name>
        <rename>PTRANS_USERDEFINEDSUMMARY44</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY45</name>
        <rename>PTRANS_USERDEFINEDSUMMARY45</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY46</name>
        <rename>PTRANS_USERDEFINEDSUMMARY46</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY47</name>
        <rename>PTRANS_USERDEFINEDSUMMARY47</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY48</name>
        <rename>PTRANS_USERDEFINEDSUMMARY48</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY49</name>
        <rename>PTRANS_USERDEFINEDSUMMARY49</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>PTRANS_USERDEFINEDSUMMARY50</name>
        <rename>PTRANS_USERDEFINEDSUMMARY50</rename>
        <default/>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Default Unknowns</name>
    <type>IfNull</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <replaceAllByValue/>
    <replaceAllMask/>
    <selectFields>Y</selectFields>
    <selectValuesType>N</selectValuesType>
    <setEmptyStringAll>Y</setEmptyStringAll>
    <valuetypes>
      </valuetypes>
    <fields>
      <field>
        <name>CLASS_ID</name>
        <value>${UNK_CLASSIFICATION_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>COMPANY_ID</name>
        <value>${UNK_COMPANY_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>COVERAGEEFFECTIVEDATE_ID</name>
        <value>${UNK_DATE_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>COVERAGEEXPIRATIONDATE_ID</name>
        <value>${UNK_DATE_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>COVERAGE_ID</name>
        <value>${UNK_COVERAGE_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>DEDUCTIBLE_ID</name>
        <value>${UNK_DEDUCTIBLE_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>FIRSTINSURED_ID</name>
        <value>${UNK_INSURED_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>LIMIT_ID</name>
        <value>${UNK_LIMIT_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>POLICY_ID</name>
        <value>${UNK_POLICY_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>PRIMARYRISKADDRESS_ID</name>
        <value>${UNK_ADDRESS_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>PRIMARYRISK_ID</name>
        <value>${UNK_COVEREDRISK_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>PRODUCER_ID</name>
        <value>${UNK_PRODUCER_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>PRODUCT_ID</name>
        <value>${UNK_PRODUCT_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>SystemId</name>
        <value>${UNK_POLICY_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>Building_Id</name>
        <value>${UNK_POLICY_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>Vehicle_Id</name>
        <value>${UNK_POLICY_ID}</value>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
      <field>
        <name>Driver_Id</name>
        <value/>
        <mask/>
        <set_empty_string>N</set_empty_string>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>710</xloc>
      <yloc>977</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Endorsement Issued Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID, 1 as STATUS_COUNTER,FP.POLICY_UNIQUEID
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP 
WHERE PTRANS_4SIGHTBICODE ='EN'
  AND ACCT_DATE >= ${sql_periodStartDate}
  AND ACCT_DATE &lt;= ${sql_periodEndDate}
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>POLICY_ID</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>POLICY_ID</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>STATUS_COUNTER</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>STATUS_COUNTER</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>POLICY_UNIQUEID</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>POLICY_UNIQUEID</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>ACCT_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>ACCT_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>EFF_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>EFF_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>TRANSACTIONSEQUENCE</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>TRANSACTIONSEQUENCE</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>TRANS_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Endorsement Issued Status</origin>
        <comments>TRANS_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
    </row-meta>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>710</xloc>
      <yloc>669</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Period Dates</name>
    <type>GetVariable</type>
    <description>Reads the period start and end date variables from memory.  
These variables are used in the querying and calculation of 
earned premium.</description>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>periodMonth</name>
        <variable>${periodMonth}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>month_id</name>
        <variable>${month_id}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>periodStartDate</name>
        <variable>${periodStartDate_str}</variable>
        <type>Date</type>
        <format>yyyy-MM-dd</format>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>periodEndDate</name>
        <variable>${periodEndDate_str}</variable>
        <type>Date</type>
        <format>yyyy-MM-dd</format>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>defaultDate</name>
        <variable>${FSBI_DEFAULT_DATE}</variable>
        <type>Date</type>
        <format>MM/dd/yyyy</format>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>356</xloc>
      <yloc>84</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Variables (periodEndDate)</name>
    <type>GetVariable</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>priorMonth_id</name>
        <variable>${priorMonth_id}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
      <field>
        <name>periodMonth</name>
        <variable>${periodMonth}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>0</length>
        <precision>0</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1286</xloc>
      <yloc>860</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get Variables loadId</name>
    <type>GetVariable</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>AUDIT_ID</name>
        <variable> ${loadId}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>10</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>SOURCE_SYSTEM</name>
        <variable>${SOURCE_SYSTEM}</variable>
        <type>String</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>both</trim_type>
      </field>
      <field>
        <name>LoadDate</name>
        <variable>${loadDate}</variable>
        <type>Date</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1105</xloc>
      <yloc>980</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Get processingDate</name>
    <type>GetVariable</type>
    <description>Reads the period start and end date variables from memory.  
These variables are used in the querying and calculation of 
earned premium.</description>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>processingDate</name>
        <variable>${processingDate}</variable>
        <type>Date</type>
        <format/>
        <currency/>
        <decimal/>
        <group/>
        <length>-1</length>
        <precision>-1</precision>
        <trim_type>none</trim_type>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>194</xloc>
      <yloc>305</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Group by</name>
    <type>GroupBy</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <all_rows>N</all_rows>
    <ignore_aggregate>N</ignore_aggregate>
    <field_ignore/>
    <directory>%%java.io.tmpdir%%</directory>
    <prefix>grp</prefix>
    <add_linenr>N</add_linenr>
    <linenr_fieldname/>
    <give_back_row>N</give_back_row>
    <group>
      <field>
        <name>POL_UNIQUEID</name>
      </field>
      <field>
        <name>COVERAGE_UNIQUEID</name>
      </field>
      <field>
        <name>month_id</name>
      </field>
      <field>
        <name>periodStartDate</name>
      </field>
      <field>
        <name>periodEndDate</name>
      </field>
      <field>
        <name>ORIG_COVERAGEEXPIRATIONDATE</name>
      </field>
    </group>
    <fields>
      <field>
        <aggregate>COMM_AMT</aggregate>
        <subject>COMM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>WRTN_PREM_AMT</aggregate>
        <subject>WRTN_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>GROSS_WRTN_PREM_AMT</aggregate>
        <subject>GROSS_WRTN_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>MAN_WRTN_PREM_AMT</aggregate>
        <subject>MAN_WRTN_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ORIG_WRTN_PREM_AMT</aggregate>
        <subject>ORIG_WRTN_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>EARNED_PREM_AMT</aggregate>
        <subject>EARNED_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>UNEARNEDPREMIUM</aggregate>
        <subject>unearnedPremium</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>GROSS_EARNED_PREM_AMT</aggregate>
        <subject>GROSS_EARNED_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>COMM_EARNED_AMT</aggregate>
        <subject>COMM_EARNED_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>TERM_PREM_AMT</aggregate>
        <subject>TERM_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>ENDORSE_PREM_AMT</aggregate>
        <subject>ENDORSE_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>AUDIT_PREM_AMT</aggregate>
        <subject>AUDIT_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>CNCL_PREM_AMT</aggregate>
        <subject>CNCL_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>REIN_PREM_AMT</aggregate>
        <subject>REIN_PREM_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>TAXES_AMT</aggregate>
        <subject>TAXES_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
      <field>
        <aggregate>FEES_AMT</aggregate>
        <subject>FEES_AMT</subject>
        <type>SUM</type>
        <valuefield/>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>352</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JS: Calculate Summaries</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var COMM_AMT = 0;
var WRTN_PREM_AMT = 0;
var GROSS_WRTN_PREM_AMT = 0;
var MAN_WRTN_PREM_AMT = 0;
var ORIG_WRTN_PREM_AMT = 0;
var EARNED_PREM_AMT = 0;
var GROSS_EARNED_PREM_AMT = 0;
var COMM_EARNED_AMT = 0;
var ENDORSE_PREM_AMT = 0;
var AUDIT_PREM_AMT = 0;
var CNCL_PREM_AMT = 0;
var REIN_PREM_AMT = 0;
var TAXES_AMT = 0;
var FEES_AMT = 0;

// If commission amount from transaction is not null then add it to comm_amt
if (COMMISSION_AMOUNT != 0 &amp;&amp; COMMISSION_AMOUNT != null)
  COMM_AMT += COMMISSION_AMOUNT;


// Check the transaction codes, if + then add, if - then subtract and 
// if E then add earned premium

if (PTRANS_COMMISSION == '+')
  COMM_AMT += AMOUNT;
else if (PTRANS_COMMISSION == '-')
  COMM_AMT -= AMOUNT
else if (PTRANS_COMMISSION == 'E')
  COMM_AMT += earnedPremium;


if (PTRANS_WRITTENPREM == '+')
  WRTN_PREM_AMT += AMOUNT;
else if (PTRANS_WRITTENPREM == '-')
  WRTN_PREM_AMT -= AMOUNT
else if (PTRANS_WRITTENPREM == 'E')
  WRTN_PREM_AMT += earnedPremium;


if (PTRANS_GROSSWRITTENPREM == '+')
  GROSS_WRTN_PREM_AMT += AMOUNT;
else if (PTRANS_GROSSWRITTENPREM == '-')
  GROSS_WRTN_PREM_AMT -= AMOUNT
else if (PTRANS_GROSSWRITTENPREM == 'E')
  GROSS_WRTN_PREM_AMT += earnedPremium;


if (PTRANS_MANUALWRITTENPREM == '+')
  MAN_WRTN_PREM_AMT += AMOUNT;
else if (PTRANS_MANUALWRITTENPREM == '-')
  MAN_WRTN_PREM_AMT -= AMOUNT
else if (PTRANS_MANUALWRITTENPREM == 'E')
  MAN_WRTN_PREM_AMT += earnedPremium;


if (PTRANS_ORIGINALWRITTENPREM == '+')
  ORIG_WRTN_PREM_AMT += AMOUNT;
else if (PTRANS_ORIGINALWRITTENPREM == '-')
  ORIG_WRTN_PREM_AMT -= AMOUNT
else if (PTRANS_ORIGINALWRITTENPREM == 'E')
  ORIG_WRTN_PREM_AMT += earnedPremium;


if (PTRANS_EARNEDPREM == '+')
  EARNED_PREM_AMT += AMOUNT;
else if (PTRANS_EARNEDPREM == '-')
  EARNED_PREM_AMT -= AMOUNT
else if (PTRANS_EARNEDPREM == 'E')
  EARNED_PREM_AMT += earnedPremium;


if (PTRANS_GROSSEARNEDPREM == '+')
  GROSS_EARNED_PREM_AMT += AMOUNT;
else if (PTRANS_GROSSEARNEDPREM == '-')
  GROSS_EARNED_PREM_AMT -= AMOUNT
else if (PTRANS_GROSSEARNEDPREM == 'E')
  GROSS_EARNED_PREM_AMT += earnedPremium;

if (PTRANS_EARNEDCOMMISSION == '+')
  COMM_EARNED_AMT += AMOUNT;
else if (PTRANS_EARNEDCOMMISSION == '-')
  COMM_EARNED_AMT -= AMOUNT
else if (PTRANS_EARNEDCOMMISSION == 'E')
  COMM_EARNED_AMT += earnedPremium;


if (PTRANS_ENDORSEMENTPREM == '+')
  ENDORSE_PREM_AMT += AMOUNT;
else if (PTRANS_ENDORSEMENTPREM == '-')
  ENDORSE_PREM_AMT -= AMOUNT
else if (PTRANS_ENDORSEMENTPREM == 'E')
  ENDORSE_PREM_AMT += earnedPremium;


if (PTRANS_AUDITPREM == '+')
  AUDIT_PREM_AMT += AMOUNT;
else if (PTRANS_AUDITPREM == '-')
  AUDIT_PREM_AMT -= AMOUNT
else if (PTRANS_AUDITPREM == 'E')
  AUDIT_PREM_AMT += earnedPremium;


if (PTRANS_CANCELLATIONPREM == '+')
  CNCL_PREM_AMT += AMOUNT;
else if (PTRANS_CANCELLATIONPREM == '-')
  CNCL_PREM_AMT -= AMOUNT
else if (PTRANS_CANCELLATIONPREM == 'E')
  CNCL_PREM_AMT += earnedPremium;


if (PTRANS_REINSTATEMENTPREM == '+')
  REIN_PREM_AMT += AMOUNT;
else if (PTRANS_REINSTATEMENTPREM == '-')
  REIN_PREM_AMT -= AMOUNT
else if (PTRANS_REINSTATEMENTPREM == 'E')
  REIN_PREM_AMT += earnedPremium;


if (PTRANS_TAXES == '+')
  TAXES_AMT += AMOUNT;
else if (PTRANS_TAXES == '-')
  TAXES_AMT -= AMOUNT
else if (PTRANS_TAXES == 'E')
  TAXES_AMT += earnedPremium;


if (PTRANS_FEES == '+')
  FEES_AMT += AMOUNT;
else if (PTRANS_FEES == '-')
  FEES_AMT -= AMOUNT
else if (PTRANS_FEES == 'E')
  FEES_AMT += earnedPremium;</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>COMM_AMT</name>
        <rename>COMM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>WRTN_PREM_AMT</name>
        <rename>WRTN_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>GROSS_WRTN_PREM_AMT</name>
        <rename>GROSS_WRTN_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>MAN_WRTN_PREM_AMT</name>
        <rename>MAN_WRTN_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ORIG_WRTN_PREM_AMT</name>
        <rename>ORIG_WRTN_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>EARNED_PREM_AMT</name>
        <rename>EARNED_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>GROSS_EARNED_PREM_AMT</name>
        <rename>GROSS_EARNED_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>COMM_EARNED_AMT</name>
        <rename>COMM_EARNED_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>ENDORSE_PREM_AMT</name>
        <rename>ENDORSE_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>AUDIT_PREM_AMT</name>
        <rename>AUDIT_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>CNCL_PREM_AMT</name>
        <rename>CNCL_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>REIN_PREM_AMT</name>
        <rename>REIN_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>TAXES_AMT</name>
        <rename>TAXES_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>FEES_AMT</name>
        <rename>FEES_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>736</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>JS: Determine Inforce</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// Determine policy status from the transaction type

var tmp_code = '';
var expire_last_day = getVariable('FSBI_POLICY_EXPIRES_LAST_DAY','Y')


if (PTRANS_4SIGHTBICODE == 'RI' || PTRANS_4SIGHTBICODE == 'UNK' || PTRANS_4SIGHTBICODE == 'NRR'|| PTRANS_4SIGHTBICODE == 'EXP') {
	if (expire_last_day == 'Y') {
		if (POLICYEXPIRATIONDATE.getTime() &lt;= processingDate.getTime())
	  		tmp_code = 'EXP'
        else if (POLICYEFFECTIVEDATE.getTime() > processingDate.getTime())
            tmp_code = 'FE'
		else
	  		tmp_code = 'INF';
	} else {
	
		if (POLICYEXPIRATIONDATE.getTime() &lt; processingDate.getTime())
	  		tmp_code = 'EXP'
        else if (POLICYEFFECTIVEDATE.getTime() > processingDate.getTime())
            tmp_code = 'FE'
		else
	  		tmp_code = 'INF';
	}

} else {
	tmp_code = PTRANS_4SIGHTBICODE
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>tmp_code</name>
        <rename>POLICYSTATUS_CODE</rename>
        <type>String</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>516</xloc>
      <yloc>565</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Javascript: Calc YTD, ITD</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var TMP_COMM_AMT_YTD = 0;
var TMP_WRTN_PREM_AMT_YTD = 0;
var TMP_GROSS_WRTN_PREM_AMT_YTD = 0;
var TMP_EARNED_PREM_AMT = 0;
var TMP_GROSS_EARNED_PREM_AMT
var TMP_EARNED_PREM_AMT_YTD = 0;
var TMP_GROSS_EARNED_PREM_AMT_YTD = 0;
var TMP_COMM_EARNED_AMT_YTD = 0;
var TMP_ENDORSE_PREM_AMT_YTD = 0;
var TMP_AUDIT_PREM_AMT_YTD = 0;
var TMP_CNCL_PREM_AMT_YTD = 0;
var TMP_REIN_PREM_AMT_YTD = 0;
var TMP_COMM_AMT_ITD = 0;
var TMP_WRTN_PREM_AMT_ITD = 0;
var TMP_GROSS_WRTN_PREM_AMT_ITD = 0;
var TMP_MAN_WRTN_PREM_AMT_ITD = 0;
var TMP_MAN_WRTN_PREM_AMT_YTD = 0;
var TMP_EARNED_PREM_AMT_ITD = 0;
var TMP_GROSS_EARNED_PREM_AMT_ITD = 0;
var TMP_COMM_EARNED_AMT_ITD = 0;
var TMP_ENDORSE_PREM_AMT_ITD = 0;
var TMP_AUDIT_PREM_AMT_ITD = 0;
var TMP_CNCL_PREM_AMT_ITD = 0;
var TMP_REIN_PREM_AMT_ITD = 0;
var TMP_FEES_AMT_YTD = 0;
var TMP_FEES_AMT_ITD = 0;
var TMP_TAXES_AMT_YTD = 0;
var TMP_TAXES_AMT_ITD = 0;
var TMP_TERM_PREM_AMT_YTD = 0;
var TMP_TERM_PREM_AMT_ITD = 0;	
var TMP_ORIG_WRTN_PREM_AMT_YTD = 0;
var TMP_ORIG_WRTN_PREM_AMT_ITD = 0;

//Not used in SPINN and set to default
EARNINGSTYPE = "Y";

// If the original coverage expiration date is within the 
// evaluation month then set the earned premium to the difference 
// of written premium ITD minus earned premium ITD.  The eliminates
// any discrepancies from rounding

if (month(ORIG_COVERAGEEXPIRATIONDATE) == month(periodStartDate) &amp;&amp; year(ORIG_COVERAGEEXPIRATIONDATE) == year(periodStartDate) &amp;&amp; (EARNINGSTYPE == "O" || EARNINGSTYPE == "Y")) {
TMP_EARNED_PREM_AMT = WRTN_PREM_AMT_ITD + WRTN_PREM_AMT - EARNED_PREM_AMT_ITD
} else {
TMP_EARNED_PREM_AMT = EARNED_PREM_AMT;
}

if (month(ORIG_COVERAGEEXPIRATIONDATE) == month(periodStartDate) &amp;&amp; year(ORIG_COVERAGEEXPIRATIONDATE) == year(periodStartDate) &amp;&amp; (EARNINGSTYPE == "O" || EARNINGSTYPE == "Y")) {
TMP_GROSS_EARNED_PREM_AMT = GROSS_WRTN_PREM_AMT_ITD + GROSS_WRTN_PREM_AMT - GROSS_EARNED_PREM_AMT_ITD
} else {
TMP_GROSS_EARNED_PREM_AMT = GROSS_EARNED_PREM_AMT;
}

// If it is January then start the year off with the MTD.
// Else add MTD to YTD
if (periodMonth == 1) {
	TMP_COMM_AMT_YTD = COMM_AMT;
	TMP_WRTN_PREM_AMT_YTD = WRTN_PREM_AMT;
	TMP_GROSS_WRTN_PREM_AMT_YTD = GROSS_WRTN_PREM_AMT;
	TMP_GROSS_EARNED_PREM_AMT_YTD = TMP_GROSS_EARNED_PREM_AMT;
	TMP_COMM_EARNED_AMT_YTD = COMM_EARNED_AMT;
	TMP_EARNED_PREM_AMT_YTD = TMP_EARNED_PREM_AMT;
	TMP_ENDORSE_PREM_AMT_YTD = ENDORSE_PREM_AMT;
	TMP_AUDIT_PREM_AMT_YTD = AUDIT_PREM_AMT;
	TMP_CNCL_PREM_AMT_YTD = CNCL_PREM_AMT;
	TMP_REIN_PREM_AMT_YTD = REIN_PREM_AMT;
	TMP_FEES_AMT_YTD = FEES_AMT;
	TMP_TAXES_AMT_YTD = TAXES_AMT;
    TMP_TERM_PREM_AMT_YTD = TERM_PREM_AMT;
    TMP_MAN_WRTN_PREM_AMT_YTD = MAN_WRTN_PREM_AMT;
    TMP_ORIG_WRTN_PREM_AMT_YTD = ORIG_WRTN_PREM_AMT;
} else {
	TMP_COMM_AMT_YTD = COMM_AMT_YTD + COMM_AMT;
	TMP_WRTN_PREM_AMT_YTD = WRTN_PREM_AMT_YTD + WRTN_PREM_AMT;
	TMP_GROSS_WRTN_PREM_AMT_YTD = GROSS_WRTN_PREM_AMT_YTD + GROSS_WRTN_PREM_AMT;
	TMP_GROSS_EARNED_PREM_AMT_YTD = GROSS_EARNED_PREM_AMT_YTD + TMP_GROSS_EARNED_PREM_AMT;
	TMP_EARNED_PREM_AMT_YTD = EARNED_PREM_AMT_YTD + TMP_EARNED_PREM_AMT;
	TMP_COMM_EARNED_AMT_YTD = COMM_EARNED_AMT_YTD + COMM_EARNED_AMT;
	TMP_ENDORSE_PREM_AMT_YTD = ENDORSE_PREM_AMT_YTD + ENDORSE_PREM_AMT;
	TMP_AUDIT_PREM_AMT_YTD = AUDIT_PREM_AMT_YTD + AUDIT_PREM_AMT;
	TMP_CNCL_PREM_AMT_YTD = CNCL_PREM_AMT_YTD + CNCL_PREM_AMT;
	TMP_REIN_PREM_AMT_YTD = REIN_PREM_AMT_YTD + REIN_PREM_AMT;
	TMP_FEES_AMT_YTD = FEES_AMT_YTD + FEES_AMT;
	TMP_TAXES_AMT_YTD = TAXES_AMT_YTD + TAXES_AMT;
  	TMP_TERM_PREM_AMT_YTD = TERM_PREM_AMT_YTD + TERM_PREM_AMT;
    TMP_MAN_WRTN_PREM_AMT_YTD = MAN_WRTN_PREM_AMT_YTD + MAN_WRTN_PREM_AMT;
    TMP_ORIG_WRTN_PREM_AMT_YTD = ORIG_WRTN_PREM_AMT_YTD + ORIG_WRTN_PREM_AMT;
}

// Calculate ITD
TMP_COMM_AMT_ITD = COMM_AMT_ITD + COMM_AMT;
TMP_WRTN_PREM_AMT_ITD = WRTN_PREM_AMT_ITD + WRTN_PREM_AMT;
TMP_GROSS_WRTN_PREM_AMT_ITD = GROSS_WRTN_PREM_AMT_ITD + GROSS_WRTN_PREM_AMT;
TMP_GROSS_EARNED_PREM_AMT_ITD = GROSS_EARNED_PREM_AMT_ITD + TMP_GROSS_EARNED_PREM_AMT;
TMP_EARNED_PREM_AMT_ITD = EARNED_PREM_AMT_ITD + TMP_EARNED_PREM_AMT;
TMP_COMM_EARNED_AMT_ITD = COMM_EARNED_AMT_ITD + COMM_EARNED_AMT;
TMP_ENDORSE_PREM_AMT_ITD = ENDORSE_PREM_AMT_ITD + ENDORSE_PREM_AMT;
TMP_AUDIT_PREM_AMT_ITD = AUDIT_PREM_AMT_ITD + AUDIT_PREM_AMT;
TMP_CNCL_PREM_AMT_ITD = CNCL_PREM_AMT_ITD + CNCL_PREM_AMT;
TMP_REIN_PREM_AMT_ITD = REIN_PREM_AMT_ITD + REIN_PREM_AMT;
TMP_FEES_AMT_ITD = FEES_AMT_ITD + FEES_AMT;
TMP_TAXES_AMT_ITD = TAXES_AMT_ITD + TAXES_AMT;
TMP_TERM_PREM_AMT_ITD = TERM_PREM_AMT_ITD + TERM_PREM_AMT;
TMP_ORIG_WRTN_PREM_AMT_ITD = ORIG_WRTN_PREM_AMT_ITD + ORIG_WRTN_PREM_AMT;
TMP_MAN_WRTN_PREM_AMT_ITD = MAN_WRTN_PREM_AMT_ITD + MAN_WRTN_PREM_AMT;</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>TMP_AUDIT_PREM_AMT_ITD</name>
        <rename>AUDIT_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_AUDIT_PREM_AMT_YTD</name>
        <rename>AUDIT_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_CNCL_PREM_AMT_ITD</name>
        <rename>CNCL_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_CNCL_PREM_AMT_YTD</name>
        <rename>CNCL_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_COMM_AMT_ITD</name>
        <rename>COMM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_COMM_AMT_YTD</name>
        <rename>COMM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_EARNED_PREM_AMT_ITD</name>
        <rename>EARNED_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_EARNED_PREM_AMT_YTD</name>
        <rename>EARNED_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_COMM_EARNED_AMT_ITD</name>
        <rename>COMM_EARNED_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_COMM_EARNED_AMT_YTD</name>
        <rename>COMM_EARNED_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_ENDORSE_PREM_AMT_ITD</name>
        <rename>ENDORSE_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_ENDORSE_PREM_AMT_YTD</name>
        <rename>ENDORSE_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_FEES_AMT_ITD</name>
        <rename>FEES_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_FEES_AMT_YTD</name>
        <rename>FEES_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_GROSS_WRTN_PREM_AMT_ITD</name>
        <rename>GROSS_WRTN_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_GROSS_WRTN_PREM_AMT_YTD</name>
        <rename>GROSS_WRTN_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_GROSS_EARNED_PREM_AMT_ITD</name>
        <rename>GROSS_EARNED_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_GROSS_EARNED_PREM_AMT_YTD</name>
        <rename>GROSS_EARNED_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_MAN_WRTN_PREM_AMT_ITD</name>
        <rename>MAN_WRTN_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_MAN_WRTN_PREM_AMT_YTD</name>
        <rename>MAN_WRTN_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_ORIG_WRTN_PREM_AMT_ITD</name>
        <rename>ORIG_WRTN_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_ORIG_WRTN_PREM_AMT_YTD</name>
        <rename>ORIG_WRTN_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_REIN_PREM_AMT_ITD</name>
        <rename>REIN_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_REIN_PREM_AMT_YTD</name>
        <rename>REIN_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_TAXES_AMT_ITD</name>
        <rename>TAXES_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_TAXES_AMT_YTD</name>
        <rename>TAXES_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_TERM_PREM_AMT_ITD</name>
        <rename>TERM_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_TERM_PREM_AMT_YTD</name>
        <rename>TERM_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_WRTN_PREM_AMT_ITD</name>
        <rename>WRTN_PREM_AMT_ITD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_WRTN_PREM_AMT_YTD</name>
        <rename>WRTN_PREM_AMT_YTD</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_EARNED_PREM_AMT</name>
        <rename>EARNED_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>TMP_GROSS_EARNED_PREM_AMT</name>
        <rename>GROSS_EARNED_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>521</xloc>
      <yloc>855</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lkup (endorsement issued status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Endorsement Issued Status</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLICY_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>STATUS_COUNTER</name>
        <rename>policyEndorsementIssuedInd</rename>
        <default>0</default>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>710</xloc>
      <yloc>733</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lkup (new issued status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>New Issued Status</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLICY_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>STATUS_COUNTER</name>
        <rename>policyNewIssuedInd</rename>
        <default>0</default>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1286</xloc>
      <yloc>733</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lkup (nonrenew issue status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Nonrenew Issued Status</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLICY_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>STATUS_COUNTER</name>
        <rename>policyNonRenewalIssuedInd</rename>
        <default>0</default>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>902</xloc>
      <yloc>733</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lkup (prior policy coverage)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Prior Policy Coverage</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>Y</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVERAGE_UNIQUEID</name>
        <field>COVERAGE_UNIQUEID</field>
      </key>
      <value>
        <name>COMM_AMT_YTD</name>
        <rename>COMM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>COMM_AMT_ITD</name>
        <rename>COMM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>WRTN_PREM_AMT_YTD</name>
        <rename>WRTN_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>WRTN_PREM_AMT_ITD</name>
        <rename>WRTN_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>GROSS_WRTN_PREM_AMT_YTD</name>
        <rename>GROSS_WRTN_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>GROSS_WRTN_PREM_AMT_ITD</name>
        <rename>GROSS_WRTN_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>MAN_WRTN_PREM_AMT_YTD</name>
        <rename>MAN_WRTN_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>MAN_WRTN_PREM_AMT_ITD</name>
        <rename>MAN_WRTN_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>ORIG_WRTN_PREM_AMT_YTD</name>
        <rename>ORIG_WRTN_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>ORIG_WRTN_PREM_AMT_ITD</name>
        <rename>ORIG_WRTN_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>TERM_PREM_AMT_YTD</name>
        <rename>TERM_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>TERM_PREM_AMT_ITD</name>
        <rename>TERM_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>EARNED_PREM_AMT_YTD</name>
        <rename>EARNED_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>EARNED_PREM_AMT_ITD</name>
        <rename>EARNED_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>GROSS_EARNED_PREM_AMT_YTD</name>
        <rename>GROSS_EARNED_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>GROSS_EARNED_PREM_AMT_ITD</name>
        <rename>GROSS_EARNED_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>COMM_EARNED_AMT_YTD</name>
        <rename>COMM_EARNED_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>COMM_EARNED_AMT_ITD</name>
        <rename>COMM_EARNED_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>ENDORSE_PREM_AMT_YTD</name>
        <rename>ENDORSE_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>ENDORSE_PREM_AMT_ITD</name>
        <rename>ENDORSE_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>AUDIT_PREM_AMT_YTD</name>
        <rename>AUDIT_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>AUDIT_PREM_AMT_ITD</name>
        <rename>AUDIT_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>CNCL_PREM_AMT_YTD</name>
        <rename>CNCL_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>CNCL_PREM_AMT_ITD</name>
        <rename>CNCL_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>REIN_PREM_AMT_YTD</name>
        <rename>REIN_PREM_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>REIN_PREM_AMT_ITD</name>
        <rename>REIN_PREM_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>TAXES_AMT_YTD</name>
        <rename>TAXES_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>TAXES_AMT_ITD</name>
        <rename>TAXES_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>FEES_AMT_YTD</name>
        <rename>FEES_AMT_YTD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
      <value>
        <name>FEES_AMT_ITD</name>
        <rename>FEES_AMT_ITD</rename>
        <default>0</default>
        <type>Number</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1094</xloc>
      <yloc>861</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lkup (renew issued status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Renew Issued Status</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLICY_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>STATUS_COUNTER</name>
        <rename>policyRenewedIssuedInd</rename>
        <default>0</default>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1094</xloc>
      <yloc>733</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lookup (DIM IDs)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Table input (DIM IDs)</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVERAGE_UNIQUEID</name>
        <field>COVERAGE_UNIQUEID</field>
      </key>
      <value>
        <name>POLICY_UNIQUEID</name>
        <rename>POLICY_UNIQUEID</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVERAGE_UNIQUEID</name>
        <rename>COVERAGE_UNIQUEID</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COVERAGE_ID</name>
        <rename>COVERAGE_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>CLASS_ID</name>
        <rename>CLASS_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>DEDUCTIBLE_ID</name>
        <rename>DEDUCTIBLE_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>LIMIT_ID</name>
        <rename>LIMIT_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>POLICY_ID</name>
        <rename>POLICY_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>PRODUCT_ID</name>
        <rename>PRODUCT_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>COMPANY_ID</name>
        <rename>COMPANY_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>PRODUCER_ID</name>
        <rename>PRODUCER_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>FIRSTINSURED_ID</name>
        <rename>FIRSTINSURED_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>PRIMARYRISK_ID</name>
        <rename>PRIMARYRISK_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>PRIMARYRISKADDRESS_ID</name>
        <rename>PRIMARYRISKADDRESS_ID</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>POLICYNEWORRENEWAL</name>
        <rename>POLICYNEWORRENEWAL</rename>
        <default/>
        <type>String</type>
      </value>
      <value>
        <name>COV_EFFECTIVEDATE</name>
        <rename>COV_EFFECTIVEDATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>COV_EXPIRATIONDATE</name>
        <rename>COV_EXPIRATIONDATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>POLICYEFFECTIVEDATE</name>
        <rename>POLICYEFFECTIVEDATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>POLICYEXPIRATIONDATE</name>
        <rename>POLICYEXPIRATIONDATE</rename>
        <default/>
        <type>Date</type>
      </value>
      <value>
        <name>SystemId</name>
        <rename>SystemId</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>LKUP_RSK_DELETED_INDICATOR</name>
        <rename>LKUP_RSK_DELETED_INDICATOR</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>Building_Id</name>
        <rename>Building_Id</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>Vehicle_Id</name>
        <rename>Vehicle_Id</rename>
        <default/>
        <type>Integer</type>
      </value>
      <value>
        <name>Driver_Id</name>
        <rename>Driver_Id</rename>
        <default/>
        <type>Integer</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>223</xloc>
      <yloc>103</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lookup (orig covg expiration)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Table input (Orig Covg Expiration)</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>COVERAGE_UNIQUEID</name>
        <field>COVERAGE_UNIQUEID</field>
      </key>
      <value>
        <name>COVEXP_DATE</name>
        <rename>ORIG_COVERAGEEXPIRATIONDATE</rename>
        <default>1900/1/1 00:00:00.000</default>
        <type>Date</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>512</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lookup (policy cancel status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Table input (cancel status)</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>Y</integer_pair>
    <lookup>
      <key>
        <name>POL_UNIQUEID</name>
        <field>POLICY_UNIQUEID</field>
      </key>
      <value>
        <name>PTRANS_4SIGHTBICODE</name>
        <rename>CAN_TRANS_CD</rename>
        <default>UNK</default>
        <type>String</type>
      </value>
      <value>
        <name>EFF_DATE</name>
        <rename>CAN_EFF_DATE</rename>
        <default>2200/1/1 00:00:00.000</default>
        <type>Date</type>
      </value>
      <value>
        <name>ACCT_DATE</name>
        <rename>CAN_ACCT_DATE</rename>
        <default>2200/1/1 00:00:00.000</default>
        <type>Date</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>192</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Lookup (policytransaction status)</name>
    <type>StreamLookup</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <from>Status</from>
    <input_sorted>N</input_sorted>
    <preserve_memory>N</preserve_memory>
    <sorted_list>N</sorted_list>
    <integer_pair>N</integer_pair>
    <lookup>
      <key>
        <name>POLICY_ID</name>
        <field>POLICY_ID</field>
      </key>
      <value>
        <name>PTRANS_4SIGHTBICODE</name>
        <rename>PTRANS_4SIGHTBICODE</rename>
        <default>UNK</default>
        <type>String</type>
      </value>
    </lookup>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>516</xloc>
      <yloc>389</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Map Risk Delete Status</name>
    <type>ValueMapper</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <field_to_use>LKUP_RSK_DELETED_INDICATOR</field_to_use>
    <target_field>RISK_DELETEDINDICATOR</target_field>
    <non_match_default>Y</non_match_default>
    <fields>
      <field>
        <source_value>1</source_value>
        <target_value>Y</target_value>
      </field>
      <field>
        <source_value>0</source_value>
        <target_value>N</target_value>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>329</xloc>
      <yloc>386</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>New Issued Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID, 1 as STATUS_COUNTER, FP.POLICY_UNIQUEID
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP 
WHERE PTRANS_4SIGHTBICODE ='NB'
  AND ACCT_DATE >= ${sql_periodStartDate}
  AND ACCT_DATE &lt;= ${sql_periodEndDate}
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1286</xloc>
      <yloc>669</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Nonrenew Issued Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID, 1 as STATUS_COUNTER, FP.POLICY_UNIQUEID
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP 
WHERE PTRANS_4SIGHTBICODE ='NR'
  AND ACCT_DATE >= ${sql_periodStartDate}
  AND ACCT_DATE &lt;= ${sql_periodEndDate}
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>902</xloc>
      <yloc>669</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Prior Policy Coverage</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT 
FP.MONTH_ID,
POLICY_UNIQUEID,
COVERAGE_UNIQUEID,
COMM_AMT_YTD,
COMM_AMT_ITD,
WRTN_PREM_AMT_YTD,
WRTN_PREM_AMT_ITD,
GROSS_WRTN_PREM_AMT_YTD,
GROSS_WRTN_PREM_AMT_ITD,
MAN_WRTN_PREM_AMT_YTD,
MAN_WRTN_PREM_AMT_ITD,
ORIG_WRTN_PREM_AMT_YTD,
ORIG_WRTN_PREM_AMT_ITD,
TERM_PREM_AMT_YTD,
TERM_PREM_AMT_ITD,
EARNED_PREM_AMT_YTD,
EARNED_PREM_AMT_ITD,
GROSS_EARNED_PREM_AMT_YTD,
GROSS_EARNED_PREM_AMT_ITD,
COMM_EARNED_AMT_YTD,
COMM_EARNED_AMT_ITD,
ENDORSE_PREM_AMT_YTD,
ENDORSE_PREM_AMT_ITD,
AUDIT_PREM_AMT_YTD,
AUDIT_PREM_AMT_ITD,
CNCL_PREM_AMT_YTD,
CNCL_PREM_AMT_ITD,
REIN_PREM_AMT_YTD,
REIN_PREM_AMT_ITD,
TAXES_AMT_YTD,
TAXES_AMT_ITD,
FEES_AMT_YTD,
FEES_AMT_ITD
FROM FACT_POLICYCOVERAGE FP WITH (NOLOCK)
WHERE FP.MONTH_ID=${priorMonth_id}</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1094</xloc>
      <yloc>797</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Rename Fields</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>ACCT_DATE</name>
        <rename>ACCOUNTINGDATE</rename>
      </field>
      <field>
        <name>COVEFF_DATE</name>
        <rename>COVERAGEEFFECTIVEDATE</rename>
      </field>
      <field>
        <name>COVEXP_DATE</name>
        <rename>COVERAGEEXPIRATIONDATE</rename>
      </field>
      <field>
        <name>EFF_DATE</name>
        <rename>TRANSACTIONEFFECTIVEDATE</rename>
      </field>
      <field>
        <name>TERM_AMOUNT</name>
        <rename>TERM_PREM_AMT</rename>
      </field>
      <field>
        <name>POLICYTRANSACTIONTYPE_ID</name>
      </field>
      <field>
        <name>POLICY_UNIQUEID</name>
        <rename>POL_UNIQUEID</rename>
      </field>
      <field>
        <name>COVERAGE_UNIQUEID</name>
      </field>
      <field>
        <name>AMOUNT</name>
      </field>
      <field>
        <name>COMMISSION_AMOUNT</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>255</xloc>
      <yloc>15</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Renew Issued Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID, 1 as STATUS_COUNTER,  FP.POLICY_UNIQUEID
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP 
WHERE PTRANS_4SIGHTBICODE ='RB'
  AND ACCT_DATE >= ${sql_periodStartDate}
  AND ACCT_DATE &lt;= ${sql_periodEndDate}
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE  </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1094</xloc>
      <yloc>669</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Select values</name>
    <type>SelectValues</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <fields>
      <field>
        <name>POL_UNIQUEID</name>
      </field>
      <field>
        <name>COVERAGE_UNIQUEID</name>
      </field>
      <field>
        <name>month_id</name>
      </field>
      <field>
        <name>periodStartDate</name>
      </field>
      <field>
        <name>periodEndDate</name>
      </field>
      <field>
        <name>ORIG_COVERAGEEXPIRATIONDATE</name>
      </field>
      <field>
        <name>TERM_PREM_AMT</name>
      </field>
      <field>
        <name>unearnedPremium</name>
      </field>
      <field>
        <name>COMM_AMT</name>
      </field>
      <field>
        <name>WRTN_PREM_AMT</name>
      </field>
      <field>
        <name>GROSS_WRTN_PREM_AMT</name>
      </field>
      <field>
        <name>MAN_WRTN_PREM_AMT</name>
      </field>
      <field>
        <name>ORIG_WRTN_PREM_AMT</name>
      </field>
      <field>
        <name>EARNED_PREM_AMT</name>
      </field>
      <field>
        <name>GROSS_EARNED_PREM_AMT</name>
      </field>
      <field>
        <name>COMM_EARNED_AMT</name>
      </field>
      <field>
        <name>ENDORSE_PREM_AMT</name>
      </field>
      <field>
        <name>AUDIT_PREM_AMT</name>
      </field>
      <field>
        <name>CNCL_PREM_AMT</name>
      </field>
      <field>
        <name>REIN_PREM_AMT</name>
      </field>
      <field>
        <name>TAXES_AMT</name>
      </field>
      <field>
        <name>FEES_AMT</name>
      </field>
      <select_unspecified>N</select_unspecified>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>512</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Set Cancel &amp; Expire Status</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>var policyCancelledIssuedInd = 0;
var policyCancelledEffectiveInd = 0;
var policyExpiredEffectiveInd = 0;

// If cancellation effective date is between the period start and end dates 
// and not a reinstatement then set the policy cancelled effective indicator to 1
if (CAN_EFF_DATE != null &amp;&amp; !CAN_TRANS_CD.equals("RI"))
	if (CAN_EFF_DATE.getTime() >= periodStartDate.getTime() &amp;&amp; CAN_EFF_DATE.getTime() &lt;= processingDate.getTime())
		policyCancelledEffectiveInd = 1;

// If cancellation accounting date is between the period start and end dates
// and not a reinstatement then set the policy cancelled issued indicator to 1
if (CAN_ACCT_DATE != null &amp;&amp; !CAN_TRANS_CD.equals("RI"))
	if (CAN_ACCT_DATE.getTime() >= periodStartDate.getTime() &amp;&amp; CAN_ACCT_DATE.getTime() &lt;= processingDate.getTime())
	  policyCancelledIssuedInd = 1;

// If the policy expiration date is between the period start and end dates then
// set the policy expired effective indicator to 1
if (POLICYEXPIRATIONDATE.getTime() >= periodStartDate.getTime() &amp;&amp; POLICYEXPIRATIONDATE.getTime() &lt;= processingDate.getTime())
  policyExpiredEffectiveInd = 1;</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>policyCancelledIssuedInd</name>
        <rename>policyCancelledIssuedInd</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>policyCancelledEffectiveInd</name>
        <rename>policyCancelledEffectiveInd</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
      <field>
        <name>policyExpiredEffectiveInd</name>
        <rename>policyExpiredEffectiveInd</rename>
        <type>Integer</type>
        <length>-1</length>
        <precision>-1</precision>
        <replace>N</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>194</xloc>
      <yloc>385</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Status</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT FP.POLICY_ID, FP.PTRANS_4SIGHTBICODE,FP.POLICY_UNIQUEID
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP 
WHERE PTRANS_4SIGHTBICODE IN ('CM', 'CF', 'CS', 'RI', 'CR', 'NR', 'NRR','EXP')
AND ACCT_DATE &lt;= ${sql_periodEndDate}
AND EFF_DATE &lt;= ${sql_periodEndDate}
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE  </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>POLICY_ID</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Status</origin>
        <comments>POLICY_ID</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>String</type>
        <storagetype>normal</storagetype>
        <name>PTRANS_4SIGHTBICODE</name>
        <length>50</length>
        <precision>-1</precision>
        <origin>Status</origin>
        <comments>PTRANS_4SIGHTBICODE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>POLICY_UNIQUEID</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Status</origin>
        <comments>POLICY_UNIQUEID</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>ACCT_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Status</origin>
        <comments>ACCT_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>EFF_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Status</origin>
        <comments>EFF_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Integer</type>
        <storagetype>normal</storagetype>
        <name>TRANSACTIONSEQUENCE</name>
        <length>9</length>
        <precision>0</precision>
        <origin>Status</origin>
        <comments>TRANSACTIONSEQUENCE</comments>
        <conversion_Mask>####0;-####0</conversion_Mask>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
      <value-meta>
        <type>Date</type>
        <storagetype>normal</storagetype>
        <name>TRANS_DATE</name>
        <length>3</length>
        <precision>-1</precision>
        <origin>Status</origin>
        <comments>TRANS_DATE</comments>
        <conversion_Mask/>
        <decimal_symbol>.</decimal_symbol>
        <grouping_symbol>,</grouping_symbol>
        <currency_symbol/>
        <trim_type>none</trim_type>
        <case_insensitive>N</case_insensitive>
        <collator_disabled>Y</collator_disabled>
        <collator_strength>0</collator_strength>
        <sort_descending>N</sort_descending>
        <output_padding>N</output_padding>
        <date_format_lenient>N</date_format_lenient>
        <date_format_locale>en_US</date_format_locale>
        <date_format_timezone>America/Los_Angeles</date_format_timezone>
        <lenient_string_to_number>N</lenient_string_to_number>
      </value-meta>
    </row-meta>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>661</xloc>
      <yloc>386</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table Input (fact_policytransaction)</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT 
  FACT_POLICYTRANSACTION.POLICYTRANSACTIONTYPE_ID
, FACT_POLICYTRANSACTION.POLICY_UNIQUEID
, FACT_POLICYTRANSACTION.COVERAGE_UNIQUEID
, ACCT_DATE
, COV_EFFECTIVEDATE COVEFF_DATE
, COV_EXPIRATIONDATE COVEXP_DATE
, EFF_DATE
, AMOUNT
, COMMISSION_AMOUNT
, TERM_AMOUNT
FROM TMP_FACT_POLICYTRANSACTION FACT_POLICYTRANSACTION
ORDER BY
  FACT_POLICYTRANSACTION.POLICY_UNIQUEID
, FACT_POLICYTRANSACTION.COVERAGE_UNIQUEID</sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>75</xloc>
      <yloc>12</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input (DIM IDs)</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT
f.POLICY_UNIQUEID,
COVERAGE_UNIQUEID,
COVERAGE_ID,
CLASS_ID,
DEDUCTIBLE_ID,
LIMIT_ID,
f.POLICY_ID,
PRODUCT_ID,
COMPANY_ID,
PRODUCER_ID,
FIRSTINSURED_ID,
PRIMARYRISK_ID,
Building_Id,
Vehicle_Id,
Driver_Id,
PRIMARYRISKADDRESS_ID,
POLICYNEWORRENEWAL,
COV_EFFECTIVEDATE,
COV_EXPIRATIONDATE,
f.SystemId,
p.EFFECTIVEDATE POLICYEFFECTIVEDATE,
p.EXPIRATIONDATE POLICYEXPIRATIONDATE,
f.LKUP_RSK_DELETED_INDICATOR
FROM TMP_FACT_POLICYTRANSACTION f
join DIM_POLICY p
on p.systemid=f.systemid
ORDER BY COVERAGE_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>46</xloc>
      <yloc>101</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input (Orig Covg Expiration)</name>
    <type>TableInput</type>
    <description/>
    <distribute>N</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT  COVERAGE_UNIQUEID, COV_EXPIRATIONDATE COVEXP_DATE, ACCT_DATE , EFF_DATE , TRANSACTIONSEQUENCE , TRANS_DATE 
FROM TMP_FACT_POLICYTRANSACTION fp
ORDER BY COVERAGE_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>512</xloc>
      <yloc>32</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table input (cancel status)</name>
    <type>TableInput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <sql>SELECT DISTINCT 
    POLICY_UNIQUEID
  , PTRANS_4SIGHTBICODE
  , ACCT_DATE
  , EFF_DATE
  , TRANSACTIONSEQUENCE
  , TRANS_DATE
FROM TMP_FACT_POLICYTRANSACTION FP
WHERE FP.PTRANS_4SIGHTBICODE IN ('CM', 'CF', 'CS', 'CR', 'RI')
ORDER BY FP.POLICY_UNIQUEID, TRANS_DATE  ,  TRANSACTIONSEQUENCE  </sql>
    <limit>0</limit>
    <lookup/>
    <execute_each_row>N</execute_each_row>
    <variables_active>Y</variables_active>
    <lazy_conversion_active>N</lazy_conversion_active>
    <cached_row_meta_active>N</cached_row_meta_active>
    <row-meta/>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>32</xloc>
      <yloc>224</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Table output</name>
    <type>TableOutput</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>${FSBI_HIGH_PROC_COUNT}</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <connection>4SBI_DataWarehouse</connection>
    <schema/>
    <table>FACT_POLICYCOVERAGE</table>
    <commit>1000</commit>
    <truncate>N</truncate>
    <ignore_errors>N</ignore_errors>
    <use_batch>Y</use_batch>
    <specify_fields>Y</specify_fields>
    <partitioning_enabled>N</partitioning_enabled>
    <partitioning_field/>
    <partitioning_daily>N</partitioning_daily>
    <partitioning_monthly>Y</partitioning_monthly>
    <tablename_in_field>N</tablename_in_field>
    <tablename_field/>
    <tablename_in_table>Y</tablename_in_table>
    <return_keys>N</return_keys>
    <return_field/>
    <fields>
      <field>
        <column_name>AUDIT_ID</column_name>
        <stream_name>AUDIT_ID</stream_name>
      </field>
      <field>
        <column_name>AUDIT_PREM_AMT</column_name>
        <stream_name>AUDIT_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>AUDIT_PREM_AMT_ITD</column_name>
        <stream_name>AUDIT_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>AUDIT_PREM_AMT_YTD</column_name>
        <stream_name>AUDIT_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>Building_Id</column_name>
        <stream_name>Building_Id</stream_name>
      </field>
      <field>
        <column_name>CLASS_ID</column_name>
        <stream_name>CLASS_ID</stream_name>
      </field>
      <field>
        <column_name>CNCL_PREM_AMT</column_name>
        <stream_name>CNCL_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>CNCL_PREM_AMT_ITD</column_name>
        <stream_name>CNCL_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>CNCL_PREM_AMT_YTD</column_name>
        <stream_name>CNCL_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>COMM_AMT</column_name>
        <stream_name>COMM_AMT</stream_name>
      </field>
      <field>
        <column_name>COMM_AMT_ITD</column_name>
        <stream_name>COMM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>COMM_AMT_YTD</column_name>
        <stream_name>COMM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>COMM_EARNED_AMT</column_name>
        <stream_name>COMM_EARNED_AMT</stream_name>
      </field>
      <field>
        <column_name>COMM_EARNED_AMT_ITD</column_name>
        <stream_name>COMM_EARNED_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>COMM_EARNED_AMT_YTD</column_name>
        <stream_name>COMM_EARNED_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>COMPANY_ID</column_name>
        <stream_name>COMPANY_ID</stream_name>
      </field>
      <field>
        <column_name>COVERAGEEFFECTIVEDATE_ID</column_name>
        <stream_name>COVERAGEEFFECTIVEDATE_ID</stream_name>
      </field>
      <field>
        <column_name>COVERAGEEXPIRATIONDATE_ID</column_name>
        <stream_name>COVERAGEEXPIRATIONDATE_ID</stream_name>
      </field>
      <field>
        <column_name>COVERAGE_ID</column_name>
        <stream_name>COVERAGE_ID</stream_name>
      </field>
      <field>
        <column_name>COVERAGE_UNIQUEID</column_name>
        <stream_name>COVERAGE_UNIQUEID</stream_name>
      </field>
      <field>
        <column_name>DEDUCTIBLE_ID</column_name>
        <stream_name>DEDUCTIBLE_ID</stream_name>
      </field>
      <field>
        <column_name>Driver_Id</column_name>
        <stream_name>Driver_Id</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT</column_name>
        <stream_name>EARNED_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT_ITD</column_name>
        <stream_name>EARNED_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>EARNED_PREM_AMT_YTD</column_name>
        <stream_name>EARNED_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>ENDORSE_PREM_AMT</column_name>
        <stream_name>ENDORSE_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>ENDORSE_PREM_AMT_ITD</column_name>
        <stream_name>ENDORSE_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>ENDORSE_PREM_AMT_YTD</column_name>
        <stream_name>ENDORSE_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>FACTPOLICYCOVERAGE_ID</column_name>
        <stream_name>FACTPOLICYCOVERAGE_ID</stream_name>
      </field>
      <field>
        <column_name>FEES_AMT</column_name>
        <stream_name>FEES_AMT</stream_name>
      </field>
      <field>
        <column_name>FEES_AMT_ITD</column_name>
        <stream_name>FEES_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>FEES_AMT_YTD</column_name>
        <stream_name>FEES_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>FIRSTINSURED_ID</column_name>
        <stream_name>FIRSTINSURED_ID</stream_name>
      </field>
      <field>
        <column_name>GROSS_EARNED_PREM_AMT</column_name>
        <stream_name>GROSS_EARNED_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>GROSS_EARNED_PREM_AMT_ITD</column_name>
        <stream_name>GROSS_EARNED_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>GROSS_EARNED_PREM_AMT_YTD</column_name>
        <stream_name>GROSS_EARNED_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>GROSS_WRTN_PREM_AMT</column_name>
        <stream_name>GROSS_WRTN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>GROSS_WRTN_PREM_AMT_ITD</column_name>
        <stream_name>GROSS_WRTN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>GROSS_WRTN_PREM_AMT_YTD</column_name>
        <stream_name>GROSS_WRTN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>LIMIT_ID</column_name>
        <stream_name>LIMIT_ID</stream_name>
      </field>
      <field>
        <column_name>MAN_WRTN_PREM_AMT</column_name>
        <stream_name>MAN_WRTN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>MAN_WRTN_PREM_AMT_ITD</column_name>
        <stream_name>MAN_WRTN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>MAN_WRTN_PREM_AMT_YTD</column_name>
        <stream_name>MAN_WRTN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>ORIG_WRTN_PREM_AMT</column_name>
        <stream_name>ORIG_WRTN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>ORIG_WRTN_PREM_AMT_ITD</column_name>
        <stream_name>ORIG_WRTN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>ORIG_WRTN_PREM_AMT_YTD</column_name>
        <stream_name>ORIG_WRTN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>POLICYNEWORRENEWAL</column_name>
        <stream_name>POLICYNEWORRENEWAL</stream_name>
      </field>
      <field>
        <column_name>POLICYSTATUS_ID</column_name>
        <stream_name>POLICYSTATUS_ID</stream_name>
      </field>
      <field>
        <column_name>POLICY_ID</column_name>
        <stream_name>POLICY_ID</stream_name>
      </field>
      <field>
        <column_name>POLICY_UNIQUEID</column_name>
        <stream_name>POLICY_UNIQUEID</stream_name>
      </field>
      <field>
        <column_name>PRIMARYRISKADDRESS_ID</column_name>
        <stream_name>PRIMARYRISKADDRESS_ID</stream_name>
      </field>
      <field>
        <column_name>PRIMARYRISK_ID</column_name>
        <stream_name>PRIMARYRISK_ID</stream_name>
      </field>
      <field>
        <column_name>PRODUCER_ID</column_name>
        <stream_name>PRODUCER_ID</stream_name>
      </field>
      <field>
        <column_name>PRODUCT_ID</column_name>
        <stream_name>PRODUCT_ID</stream_name>
      </field>
      <field>
        <column_name>REIN_PREM_AMT</column_name>
        <stream_name>REIN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>REIN_PREM_AMT_ITD</column_name>
        <stream_name>REIN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>REIN_PREM_AMT_YTD</column_name>
        <stream_name>REIN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>RISK_DELETEDINDICATOR</column_name>
        <stream_name>RISK_DELETEDINDICATOR</stream_name>
      </field>
      <field>
        <column_name>SOURCE_SYSTEM</column_name>
        <stream_name>SOURCE_SYSTEM</stream_name>
      </field>
      <field>
        <column_name>SystemId</column_name>
        <stream_name>SystemId</stream_name>
      </field>
      <field>
        <column_name>TAXES_AMT</column_name>
        <stream_name>TAXES_AMT</stream_name>
      </field>
      <field>
        <column_name>TAXES_AMT_ITD</column_name>
        <stream_name>TAXES_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>TAXES_AMT_YTD</column_name>
        <stream_name>TAXES_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>TERM_PREM_AMT</column_name>
        <stream_name>TERM_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>TERM_PREM_AMT_ITD</column_name>
        <stream_name>TERM_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>TERM_PREM_AMT_YTD</column_name>
        <stream_name>TERM_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>Vehicle_Id</column_name>
        <stream_name>Vehicle_Id</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT</column_name>
        <stream_name>WRTN_PREM_AMT</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT_ITD</column_name>
        <stream_name>WRTN_PREM_AMT_ITD</stream_name>
      </field>
      <field>
        <column_name>WRTN_PREM_AMT_YTD</column_name>
        <stream_name>WRTN_PREM_AMT_YTD</stream_name>
      </field>
      <field>
        <column_name>loadDate</column_name>
        <stream_name>loadDate</stream_name>
      </field>
      <field>
        <column_name>month_id</column_name>
        <stream_name>month_id</stream_name>
      </field>
      <field>
        <column_name>UNEARNED_PREM</column_name>
        <stream_name>UNEARNEDPREMIUM</stream_name>
      </field>
      <field>
        <column_name>POLICYNEWISSUEDIND</column_name>
        <stream_name>POLICYNEWISSUEDIND</stream_name>
      </field>
      <field>
        <column_name>POLICYCANCELLEDISSUEDIND</column_name>
        <stream_name>POLICYCANCELLEDISSUEDIND</stream_name>
      </field>
      <field>
        <column_name>POLICYCANCELLEDEFFECTIVEIND</column_name>
        <stream_name>POLICYCANCELLEDEFFECTIVEIND</stream_name>
      </field>
      <field>
        <column_name>POLICYEXPIREDEFFECTIVEIND</column_name>
        <stream_name>POLICYEXPIREDEFFECTIVEIND</stream_name>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>1286</xloc>
      <yloc>977</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step>
    <name>Zero Out History Records</name>
    <type>ScriptValueMod</type>
    <description/>
    <distribute>Y</distribute>
    <custom_distribution/>
    <copies>1</copies>
    <partitioning>
      <method>none</method>
      <schema_name/>
    </partitioning>
    <compatible>N</compatible>
    <optimizationLevel>9</optimizationLevel>
    <jsScripts>
      <jsScript>
        <jsScript_type>0</jsScript_type>
        <jsScript_name>Script 1</jsScript_name>
        <jsScript_script>// If the accounting date is less than the period start date
// (meaning the transaction is from a prior period) set the
// amount to zero.  We used the amount to calculate the
// earned premium and no longer need it.

var NEW_AMOUNT = 0.00;
var NEW_COMMISSION = 0.00;
var NEW_TERM_PREM_AMT = 0.00;

// If the number of days between the two dates is greater
// than or equal to 0 we know it is during the accounting
// period

if (ACCOUNTINGDATE.getTime() &lt; periodStartDate.getTime()) {
	NEW_AMOUNT = 0.00;
	NEW_COMMISSION = 0.00;
    NEW_TERM_PREM_AMT = 0.00;
} else {
	NEW_AMOUNT = AMOUNT;
	NEW_COMMISSION = COMMISSION_AMOUNT;  
    NEW_TERM_PREM_AMT = TERM_PREM_AMT;
}</jsScript_script>
      </jsScript>
    </jsScripts>
    <fields>
      <field>
        <name>NEW_AMOUNT</name>
        <rename>AMOUNT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>NEW_COMMISSION</name>
        <rename>COMMISSION_AMOUNT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
      <field>
        <name>NEW_TERM_PREM_AMT</name>
        <rename>TERM_PREM_AMT</rename>
        <type>Number</type>
        <length>16</length>
        <precision>2</precision>
        <replace>Y</replace>
      </field>
    </fields>
    <attributes/>
    <cluster_schema/>
    <remotesteps>
      <input>
      </input>
      <output>
      </output>
    </remotesteps>
    <GUI>
      <xloc>928</xloc>
      <yloc>128</yloc>
      <draw>Y</draw>
    </GUI>
  </step>
  <step_error_handling>
  </step_error_handling>
  <slave-step-copy-partition-distribution>
  </slave-step-copy-partition-distribution>
  <slave_transformation>N</slave_transformation>
  <attributes>
    <group>
      <name>DataService</name>
    </group>
  </attributes>
</transformation>

<job>
  <name>JB_Custom_Dimension</name>
    <description/>
    <extended_description/>
    <job_version/>
    <job_status>0</job_status>
  <directory>&#x2f;Custom_ETL&#x2f;4SightBI</directory>
  <created_user>-</created_user>
  <created_date>2012&#x2f;08&#x2f;14 11&#x3a;34&#x3a;35.526</created_date>
  <modified_user>-</modified_user>
  <modified_date>2022&#x2f;03&#x2f;29 17&#x3a;00&#x3a;55.178</modified_date>
    <parameters>
    </parameters>
  <connection>
    <name>4SBI_DataWarehouse</name>
    <server>&#x24;&#x7b;FSBI_DB_DATAWAREHOUSE_HOSTNAME&#x7d;</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>&#x24;&#x7b;FSBI_DB_DATAWAREHOUSE_DATABASENAME&#x7d;</database>
    <port>-1</port>
    <username>&#x24;&#x7b;FSBI_DB_DATAWAREHOUSE_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_DATAWAREHOUSE_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code><attribute>3</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQLUseIntegratedSecurity</code><attribute>false</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>PREFERRED_SCHEMA_NAME</code><attribute>dbo</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SQL_CONNECT</code><attribute>set nocount on&#x3b;</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>4SBI_Redshift</name>
    <server>&#x24;&#x7b;FSBI_DB_REDSHIFT_HOSTNAME&#x7d;</server>
    <type>REDSHIFT</type>
    <access>Native</access>
    <database>pentaho</database>
    <port>5439</port>
    <username>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_REDSHIFT.tcpKeepAlive</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5439</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>4SBI_Staging</name>
    <server>&#x24;&#x7b;FSBI_DB_STAGING_HOSTNAME&#x7d;</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>&#x24;&#x7b;FSBI_DB_STAGING_DATABASENAME&#x7d;</database>
    <port>-1</port>
    <username>&#x24;&#x7b;FSBI_DB_STAGING_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_STAGING_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code><attribute>3</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQLUseIntegratedSecurity</code><attribute>false</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>PREFERRED_SCHEMA_NAME</code><attribute>dbo</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SQL_CONNECT</code><attribute>set nocount on&#x3b;</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>AgileBI</name>
    <server>localhost</server>
    <type>MONETDB</type>
    <access>Native</access>
    <database>pentaho-instaview</database>
    <port>50000</port>
    <username>monetdb</username>
    <password>Encrypted 2be98afc86aa7f2e4cb14a17edb86abd8</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <read_only>true</read_only>
    <attributes>
      <attribute><code>EXTRA_OPTION_INFOBRIGHT.characterEncoding</code><attribute>UTF-8</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.defaultFetchSize</code><attribute>500</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCursorFetch</code><attribute>true</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>50000</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>CSE_BI</name>
    <server>&#x24;&#x7b;FSBI_DB_STAGING_HOSTNAME&#x7d;</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>CSE_BI</database>
    <port>-1</port>
    <username>&#x24;&#x7b;FSBI_DB_STAGING_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_STAGING_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code><attribute>3</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQLUseIntegratedSecurity</code><attribute>false</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>PREFERRED_SCHEMA_NAME</code><attribute>dbo</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SQL_CONNECT</code><attribute>set nocount on&#x3b;</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>N</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Mkt01</name>
    <server>REMOVED</server>
    <type>MSSQLNATIVE</type>
    <access>Native</access>
    <database>prodCSE</database>
    <port>-1</port>
    <username>REMOVED</username>
    <password>REMOVED</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.prepareSQL</code><attribute>3</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MSSQLNATIVE.sendStringParametersAsUnicode</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MSSQLUseIntegratedSecurity</code><attribute>false</attribute></attribute>
      <attribute><code>MSSQL_DOUBLE_DECIMAL_SEPARATOR</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>-1</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SQL_CONNECT</code><attribute>set nocount on&#x3b;</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Prod_DB</name>
    <server>&#x24;&#x7b;FSBI_DB_SOURCE_HOSTNAME&#x7d;</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;FSBI_DB_SOURCE_DATABASENAME&#x7d;</database>
    <port>3306</port>
    <username>&#x24;&#x7b;FSBI_DB_SOURCE_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_SOURCE_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Redshift</name>
    <server>ec2-52-33-70-247.us-west-2.compute.amazonaws.com</server>
    <type>REDSHIFT</type>
    <access>Native</access>
    <database>pentaho</database>
    <port>5439</port>
    <username>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_REDSHIFT_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_REDSHIFT.tcpKeepAlive</code><attribute>true</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>5439</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>N</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Source_DB</name>
    <server>&#x24;&#x7b;FSBI_DB_SOURCE_HOSTNAME&#x7d;</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;FSBI_DB_SOURCE_DATABASENAME&#x7d;</database>
    <port>3306</port>
    <username>&#x24;&#x7b;FSBI_DB_SOURCE_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;FSBI_DB_SOURCE_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code><attribute>true</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCompression</code><attribute>true</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useServerPrepStmts</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>INITIAL_POOL_SIZE</code><attribute>1</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MAXIMUM_POOL_SIZE</code><attribute>2</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>Y</attribute></attribute>
    </attributes>
  </connection>
  <connection>
    <name>Source_DB_READ</name>
    <server>&#x24;&#x7b;SOURCE_DB_READ_HOSTNAME&#x7d;</server>
    <type>MYSQL</type>
    <access>Native</access>
    <database>&#x24;&#x7b;SOURCE_DB_READ_DATABASENAME&#x7d;</database>
    <port>3306</port>
    <username>&#x24;&#x7b;SOURCE_DB_READ_USERNAME&#x7d;</username>
    <password>&#x24;&#x7b;SOURCE_DB_READ_USERPASSWORD&#x7d;</password>
    <servername/>
    <data_tablespace/>
    <index_tablespace/>
    <attributes>
      <attribute><code>EXTRA_OPTION_MYSQL.rewriteBatchedStatements</code><attribute>true</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useCompression</code><attribute>true</attribute></attribute>
      <attribute><code>EXTRA_OPTION_MYSQL.useServerPrepStmts</code><attribute>false</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_LOWERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>FORCE_IDENTIFIERS_TO_UPPERCASE</code><attribute>N</attribute></attribute>
      <attribute><code>INITIAL_POOL_SIZE</code><attribute>1</attribute></attribute>
      <attribute><code>IS_CLUSTERED</code><attribute>N</attribute></attribute>
      <attribute><code>MAXIMUM_POOL_SIZE</code><attribute>2</attribute></attribute>
      <attribute><code>PORT_NUMBER</code><attribute>3306</attribute></attribute>
      <attribute><code>PRESERVE_RESERVED_WORD_CASE</code><attribute>N</attribute></attribute>
      <attribute><code>QUOTE_ALL_FIELDS</code><attribute>N</attribute></attribute>
      <attribute><code>STREAM_RESULTS</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_BOOLEAN_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>SUPPORTS_TIMESTAMP_DATA_TYPE</code><attribute>Y</attribute></attribute>
      <attribute><code>USE_POOLING</code><attribute>Y</attribute></attribute>
    </attributes>
  </connection>
    <slaveservers>
    </slaveservers>
<job-log-table><connection/>
<schema/>
<table/>
<size_limit_lines/>
<interval/>
<timeout_days/>
<field><id>ID_JOB</id><enabled>Y</enabled><name>ID_JOB</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>JOBNAME</id><enabled>Y</enabled><name>JOBNAME</name></field><field><id>STATUS</id><enabled>Y</enabled><name>STATUS</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>STARTDATE</id><enabled>Y</enabled><name>STARTDATE</name></field><field><id>ENDDATE</id><enabled>Y</enabled><name>ENDDATE</name></field><field><id>LOGDATE</id><enabled>Y</enabled><name>LOGDATE</name></field><field><id>DEPDATE</id><enabled>Y</enabled><name>DEPDATE</name></field><field><id>REPLAYDATE</id><enabled>Y</enabled><name>REPLAYDATE</name></field><field><id>LOG_FIELD</id><enabled>Y</enabled><name>LOG_FIELD</name></field><field><id>EXECUTING_SERVER</id><enabled>N</enabled><name>EXECUTING_SERVER</name></field><field><id>EXECUTING_USER</id><enabled>N</enabled><name>EXECUTING_USER</name></field><field><id>START_JOB_ENTRY</id><enabled>N</enabled><name>START_JOB_ENTRY</name></field><field><id>CLIENT</id><enabled>N</enabled><name>CLIENT</name></field></job-log-table>
<jobentry-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>JOBNAME</id><enabled>Y</enabled><name>TRANSNAME</name></field><field><id>JOBENTRYNAME</id><enabled>Y</enabled><name>STEPNAME</name></field><field><id>LINES_READ</id><enabled>Y</enabled><name>LINES_READ</name></field><field><id>LINES_WRITTEN</id><enabled>Y</enabled><name>LINES_WRITTEN</name></field><field><id>LINES_UPDATED</id><enabled>Y</enabled><name>LINES_UPDATED</name></field><field><id>LINES_INPUT</id><enabled>Y</enabled><name>LINES_INPUT</name></field><field><id>LINES_OUTPUT</id><enabled>Y</enabled><name>LINES_OUTPUT</name></field><field><id>LINES_REJECTED</id><enabled>Y</enabled><name>LINES_REJECTED</name></field><field><id>ERRORS</id><enabled>Y</enabled><name>ERRORS</name></field><field><id>RESULT</id><enabled>Y</enabled><name>RESULT</name></field><field><id>NR_RESULT_ROWS</id><enabled>Y</enabled><name>NR_RESULT_ROWS</name></field><field><id>NR_RESULT_FILES</id><enabled>Y</enabled><name>NR_RESULT_FILES</name></field><field><id>LOG_FIELD</id><enabled>N</enabled><name>LOG_FIELD</name></field><field><id>COPY_NR</id><enabled>N</enabled><name>COPY_NR</name></field></jobentry-log-table>
<channel-log-table><connection/>
<schema/>
<table/>
<timeout_days/>
<field><id>ID_BATCH</id><enabled>Y</enabled><name>ID_BATCH</name></field><field><id>CHANNEL_ID</id><enabled>Y</enabled><name>CHANNEL_ID</name></field><field><id>LOG_DATE</id><enabled>Y</enabled><name>LOG_DATE</name></field><field><id>LOGGING_OBJECT_TYPE</id><enabled>Y</enabled><name>LOGGING_OBJECT_TYPE</name></field><field><id>OBJECT_NAME</id><enabled>Y</enabled><name>OBJECT_NAME</name></field><field><id>OBJECT_COPY</id><enabled>Y</enabled><name>OBJECT_COPY</name></field><field><id>REPOSITORY_DIRECTORY</id><enabled>Y</enabled><name>REPOSITORY_DIRECTORY</name></field><field><id>FILENAME</id><enabled>Y</enabled><name>FILENAME</name></field><field><id>OBJECT_ID</id><enabled>Y</enabled><name>OBJECT_ID</name></field><field><id>OBJECT_REVISION</id><enabled>Y</enabled><name>OBJECT_REVISION</name></field><field><id>PARENT_CHANNEL_ID</id><enabled>Y</enabled><name>PARENT_CHANNEL_ID</name></field><field><id>ROOT_CHANNEL_ID</id><enabled>Y</enabled><name>ROOT_CHANNEL_ID</name></field></channel-log-table>
   <pass_batchid>N</pass_batchid>
   <shared_objects_file/>
  <entries>
    <entry>
      <name>START</name>
      <description/>
      <type>SPECIAL</type>
      <start>Y</start>
      <dummy>N</dummy>
      <repeat>N</repeat>
      <schedulerType>0</schedulerType>
      <intervalSeconds>0</intervalSeconds>
      <intervalMinutes>60</intervalMinutes>
      <hour>12</hour>
      <minutes>0</minutes>
      <weekDay>1</weekDay>
      <DayOfMonth>1</DayOfMonth>
      <parallel>Y</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>81</xloc>
      <yloc>304</yloc>
      </entry>
    <entry>
      <name>TR_DIM_DRIVER</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_DRIVER</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>355</xloc>
      <yloc>47</yloc>
      </entry>
    <entry>
      <name>TR_DIM_VEHICLE</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_VEHICLE</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>355</xloc>
      <yloc>151</yloc>
      </entry>
    <entry>
      <name>TR_DIM_BUILDING</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_BUILDING</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>355</xloc>
      <yloc>255</yloc>
      </entry>
    <entry>
      <name>TR_DIM_BUILDINGRISK</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_BUILDINGRISK</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>355</xloc>
      <yloc>359</yloc>
      </entry>
    <entry>
      <name>TR_DIM_LOCATION</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_LOCATION</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>355</xloc>
      <yloc>463</yloc>
      </entry>
    <entry>
      <name>TR_DIM_CATASTROPHE</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_CATASTROPHE</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>Y</set_logfile>
      <logfile>&#x24;&#x7b;FSBI_LOG_PATH&#x7d;Log</logfile>
      <logext>txt</logext>
      <add_date>Y</add_date>
      <add_time>Y</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>Y</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>Y</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>82</xloc>
      <yloc>56</yloc>
      </entry>
    <entry>
      <name>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_DRIVER</name>
      <description/>
      <type>SQL</type>
      <sql>--adjusting record_version&#xd;&#xa;with data as &#x28;select driver_id, row_number&#x28;&#x29; over&#x28;partition by driver_uniqueid order by valid_fromdate, valid_todate&#x29; rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_driver d&#xd;&#xa;where audit_id&#x3d;0&#x29;&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_driver&#xd;&#xa;set record_version&#x3d;data.rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_driver v&#xd;&#xa;join data on v.driver_id&#x3d;data.driver_id&#xd;&#xa;where v.audit_id&#x3d;0&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>624</xloc>
      <yloc>47</yloc>
      </entry>
    <entry>
      <name>SQL Adjusting Record_Version in Late Coming SCD Type 2 records  in DIM_VEHICLE</name>
      <description/>
      <type>SQL</type>
      <sql>with data as &#x28;select vehicle_id, row_number&#x28;&#x29; over&#x28;partition by vehicle_uniqueid order by valid_fromdate&#x29; rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_vehicle d&#xd;&#xa;where audit_id&#x3d;0&#x29;&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_vehicle&#xd;&#xa;set record_version&#x3d;data.rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_vehicle v&#xd;&#xa;join data on v.vehicle_id&#x3d;data.vehicle_id&#xd;&#xa;where v.audit_id&#x3d;0&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>658</xloc>
      <yloc>152</yloc>
      </entry>
    <entry>
      <name>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_BUILDING</name>
      <description/>
      <type>SQL</type>
      <sql>with data as &#x28;select building_id, row_number&#x28;&#x29; over&#x28;partition by building_uniqueid order by valid_fromdate&#x29; rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_building d&#xd;&#xa;where d.audit_id&#x3d;0&#x29;&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_building&#xd;&#xa;set record_version&#x3d;data.rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_building v&#xd;&#xa;join data on v.building_id&#x3d;data.building_id&#xd;&#xa;where v.audit_id&#x3d;0&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>656</xloc>
      <yloc>252</yloc>
      </entry>
    <entry>
      <name>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_LOCATION</name>
      <description/>
      <type>SQL</type>
      <sql>with data as &#x28;select location_id, row_number&#x28;&#x29; over&#x28;partition by location_uniqueid order by valid_fromdate&#x29; rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_location d&#xd;&#xa;where d.audit_id&#x3d;0&#x29;&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_location&#xd;&#xa;set record_version&#x3d;data.rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_location v&#xd;&#xa;join data on v.location_id&#x3d;data.location_id&#xd;&#xa;where v.audit_id&#x3d;0&#x3b;&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>976</xloc>
      <yloc>468</yloc>
      </entry>
    <entry>
      <name>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_BUILDINGRISK</name>
      <description/>
      <type>SQL</type>
      <sql>with data as &#x28;select buildingrisk_id, row_number&#x28;&#x29; over&#x28;partition by buildingrisk_uniqueid order by valid_fromdate&#x29; rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_buildingrisk d&#xd;&#xa;where d.audit_id&#x3d;0&#x29;&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_buildingrisk&#xd;&#xa;set record_version&#x3d;data.rn&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_buildingrisk v&#xd;&#xa;join data on v.buildingrisk_id&#x3d;data.buildingrisk_id&#xd;&#xa;where v.audit_id&#x3d;0&#x3b;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>F</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>981</xloc>
      <yloc>361</yloc>
      </entry>
    <entry>
      <name>TR_DIM_CARFAX</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_CARFAX</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>215</xloc>
      <yloc>62</yloc>
      </entry>
    <entry>
      <name>SQL After Historical Load Only - Adjusting DIM_BUILDINGRISK</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;	&#xd;&#xa;After initial load via SPOON	&#xd;&#xa;insert historical records	&#xd;&#xa;&#x2a;&#x2f;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_buildingrisk1&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;stg_buildingrisk1&#x3b;	&#xd;&#xa;	&#xd;&#xa;select 	&#xd;&#xa;&#x2a;,	&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by buildingrisk_uniqueid order by ChangeDate &#x29; rn1,	&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by buildingrisk_uniqueid order by BookDt &#x29; rn2	&#xd;&#xa;into &#x23;stg_buildingrisk1	&#xd;&#xa;from &#x28;select distinct &#x2a; from fsbi_stg_spinn.dbo.stg_buildingrisk&#x29; data&#x3b;	&#xd;&#xa;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_buildingrisk&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;stg_buildingrisk&#x3b;	&#xd;&#xa;	&#xd;&#xa;with mcd as &#x28;select buildingrisk_uniqueid, min&#x28;ChangeDate&#x29; ChangeDate	&#xd;&#xa;from &#x23;stg_buildingrisk1 data	&#xd;&#xa;where rn1&#x3c;&#x3e;rn2	&#xd;&#xa;group by buildingrisk_uniqueid&#x29; 	&#xd;&#xa;,mbd as &#x28;select distinct data.buildingrisk_uniqueid, data.BookDt	&#xd;&#xa;from &#x23;stg_buildingrisk1 data	&#xd;&#xa;join mcd	&#xd;&#xa;on  data.buildingrisk_uniqueid&#x3d;mcd.buildingrisk_uniqueid	&#xd;&#xa;and data.ChangeDate&#x3d;mcd.ChangeDate	&#xd;&#xa;where rn1&#x3c;&#x3e;rn2	&#xd;&#xa;&#x29;	&#xd;&#xa;select data.&#x2a;	&#xd;&#xa;,case when mbd.BookDt is null and data.rn1&#x3c;&#x3e;data.rn2 then &#x27;Y&#x27; else &#x27;N&#x27; end Hist_Flg	&#xd;&#xa;into &#x23;stg_buildingrisk	&#xd;&#xa;from &#x23;stg_buildingrisk1 data	&#xd;&#xa;left outer join mbd	&#xd;&#xa;on 	&#xd;&#xa;&#x28;data.buildingrisk_uniqueid&#x3d;mbd.buildingrisk_uniqueid	&#xd;&#xa;and data.BookDt&#x3e;&#x3d;mbd.BookDt&#x29;&#x3b; 	&#xd;&#xa;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;max_buildingrisk_id&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;max_buildingrisk_id&#x3b;	&#xd;&#xa;	&#xd;&#xa;select max&#x28;buildingrisk_id&#x29; m into &#x23;max_buildingrisk_id from fsbi_dw_spinn.dbo.dim_buildingrisk&#x3b;	&#xd;&#xa;	&#xd;&#xa;insert into fsbi_dw_spinn.dbo.dim_buildingrisk	&#xd;&#xa;&#x28;	&#xd;&#xa;BuildingRisk_ID,	&#xd;&#xa;VALID_FROMDATE,	&#xd;&#xa;VALID_TODATE,	&#xd;&#xa;RECORD_VERSION,	&#xd;&#xa;BuildingRisk_UniqueId,	&#xd;&#xa;SPINNBuildingRisk_Id,	&#xd;&#xa;Status,	&#xd;&#xa;BldgNumber,	&#xd;&#xa;ConstructionCd,	&#xd;&#xa;RoofCd,	&#xd;&#xa;YearBuilt,	&#xd;&#xa;BuildingLimit,	&#xd;&#xa;ContentsLimit,	&#xd;&#xa;InflationGuardPct,	&#xd;&#xa;OrdinanceOrLawInd,	&#xd;&#xa;PitchOfRoof,	&#xd;&#xa;TotalLivingSqFt,	&#xd;&#xa;MSBReconstructionEstimate,	&#xd;&#xa;SprinkleredBuildings,	&#xd;&#xa;UnitsPerBuilding,	&#xd;&#xa;NumStories,	&#xd;&#xa;ConstructionQuality,	&#xd;&#xa;AreasOfCoverage,	&#xd;&#xa;RPC125Pct,	&#xd;&#xa;IncreasedConstCost,	&#xd;&#xa;TIV	,&#xd;&#xa;TIV_SPINN	,&#xd;&#xa;TimeElement,	&#xd;&#xa;SubjectAmount,	&#xd;&#xa;FacultativeCededPremium,	&#xd;&#xa;CededPremiumFactor,	&#xd;&#xa;BuildingRiskNumber,	&#xd;&#xa;BuildingType,	&#xd;&#xa;SaunaRoom,	&#xd;&#xa;FitnessCenter,	&#xd;&#xa;AnnualRevenue,	&#xd;&#xa;LicensedBeds,	&#xd;&#xa;RiskGroupNumber	,&#xd;&#xa;RiskGroupType,	&#xd;&#xa;RiskGroupDescrtiption,	&#xd;&#xa;SourceSystem,	&#xd;&#xa;LoadDate,	&#xd;&#xa;audit_id,	&#xd;&#xa;original_valid_fromdate,	&#xd;&#xa;original_valid_todate,	&#xd;&#xa;original_record_version	&#xd;&#xa;&#x29;	&#xd;&#xa;select	&#xd;&#xa; -&#x23;max_BuildingRisk_id.m - row_number&#x28;&#x29; over &#x28;order by BuildingRisk_uniqueid,ChangeDate&#x29; BuildingRisk_ID, 	&#xd;&#xa;&#x27;1900-01-01&#x27; VALID_FROMDATE ,	&#xd;&#xa;&#x27;1900-01-01&#x27; VALID_TODATE ,	&#xd;&#xa;-1 RECORD_VERSION,	&#xd;&#xa;BuildingRisk_UniqueId,	&#xd;&#xa;SPINNBuildingRisk_Id,	&#xd;&#xa;Status,	&#xd;&#xa;BldgNumber,	&#xd;&#xa;ConstructionCd,	&#xd;&#xa;RoofCd,	&#xd;&#xa;YearBuilt,	&#xd;&#xa;BuildingLimit,	&#xd;&#xa;ContentsLimit,	&#xd;&#xa;InflationGuardPct,	&#xd;&#xa;OrdinanceOrLawInd,	&#xd;&#xa;PitchOfRoof,	&#xd;&#xa;TotalLivingSqFt,	&#xd;&#xa;MSBReconstructionEstimate,	&#xd;&#xa;SprinkleredBuildings,	&#xd;&#xa;UnitsPerBuilding,	&#xd;&#xa;NumStories,	&#xd;&#xa;ConstructionQuality,	&#xd;&#xa;AreasOfCoverage,	&#xd;&#xa;RPC125Pct,	&#xd;&#xa;IncreasedConstCost,	&#xd;&#xa;TIV	,&#xd;&#xa;TIV_SPINN	,&#xd;&#xa;TimeElement,	&#xd;&#xa;SubjectAmount,	&#xd;&#xa;FacultativeCededPremium,	&#xd;&#xa;CededPremiumFactor,	&#xd;&#xa;BuildingRiskNumber,	&#xd;&#xa;BuildingType,	&#xd;&#xa;SaunaRoom,	&#xd;&#xa;FitnessCenter,	&#xd;&#xa;AnnualRevenue,	&#xd;&#xa;LicensedBeds,	&#xd;&#xa;RiskGroupNumber	,&#xd;&#xa;RiskGroupType,	&#xd;&#xa;RiskGroupDescrtiption,	&#xd;&#xa;SourceSystem,	&#xd;&#xa;&#x27;01-01-1900&#x27;  LoadDate,	&#xd;&#xa;112 audit_id 	,&#xd;&#xa;ChangeDate original_valid_fromdate,	&#xd;&#xa;ChangeDate original_valid_todate,	&#xd;&#xa;0	&#xd;&#xa;from &#x23;stg_buildingrisk stg	&#xd;&#xa;	  join fsbi_dw_spinn.dbo.dim_policy p&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid	&#xd;&#xa;join &#x23;max_buildingrisk_id on 1&#x3d;1	&#xd;&#xa;where Hist_Flg&#x3d;&#x27;Y&#x27;&#x3b;	&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;with temp&#x28;rank1,buildingrisk_uniqueid,original_valid_fromdate &#x29;	&#xd;&#xa;as &#x28;	&#xd;&#xa;   select row_number&#x28;&#x29; over &#x28; partition by buildingrisk_uniqueid,original_valid_fromdate order by buildingrisk_uniqueid,original_valid_fromdate &#x29; rank1,	&#xd;&#xa;   buildingrisk_uniqueid,	&#xd;&#xa;   original_valid_fromdate 	&#xd;&#xa;   from DIM_buildingrisk	&#xd;&#xa;   where audit_id&#x3d;112	&#xd;&#xa;&#x29;	&#xd;&#xa;delete from temp where rank1 &#x3e; 1&#x3b;	&#xd;&#xa;	&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_buildingrisk	&#xd;&#xa;set audit_id&#x3d;114	&#xd;&#xa;where  buildingrisk_id in &#x28;select d2.buildingrisk_id 	&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_buildingrisk d	&#xd;&#xa;join fsbi_dw_spinn.dbo.DIM_buildingrisk d2	&#xd;&#xa;on d.buildingrisk_uniqueid&#x3d;d2.buildingrisk_uniqueid	&#xd;&#xa;and d.valid_fromdate&#x3d;d2.valid_fromdate	&#xd;&#xa;and d2.valid_fromdate&#x3c;&#x3e;d2.valid_todate	&#xd;&#xa;where d.valid_fromdate&#x3d;d.valid_todate	&#xd;&#xa;and d.audit_id in &#x28;0,113&#x29;	&#xd;&#xa;and d2.audit_id in &#x28;0,113&#x29;&#x29;&#x3b;	&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_buildingrisk	&#xd;&#xa;where valid_fromdate&#x3d;valid_todate	&#xd;&#xa;and audit_id in &#x28;0,113&#x29;&#x3b;	&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>106</xloc>
      <yloc>725</yloc>
      </entry>
    <entry>
      <name>SQL After Historical Load Only - Adjusting DIM_LOCATION</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a;	&#xd;&#xa;After initial load via SPOON	&#xd;&#xa;insert historical records	&#xd;&#xa;&#x2a;&#x2f;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_location1&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;stg_location1&#x3b;	&#xd;&#xa;	&#xd;&#xa;select 	&#xd;&#xa;&#x2a;,	&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by location_uniqueid order by ChangeDate &#x29; rn1,	&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by location_uniqueid order by BookDt &#x29; rn2	&#xd;&#xa;into &#x23;stg_location1	&#xd;&#xa;from &#x28;select distinct &#x2a; from fsbi_stg_spinn.dbo.stg_location&#x29; data&#x3b;	&#xd;&#xa;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_location&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;stg_location&#x3b;	&#xd;&#xa;	&#xd;&#xa;with mcd as &#x28;select location_uniqueid, min&#x28;ChangeDate&#x29; ChangeDate	&#xd;&#xa;from &#x23;stg_location1 data	&#xd;&#xa;where rn1&#x3c;&#x3e;rn2	&#xd;&#xa;group by location_uniqueid&#x29; 	&#xd;&#xa;,mbd as &#x28;select distinct data.location_uniqueid, data.BookDt	&#xd;&#xa;from &#x23;stg_location1 data	&#xd;&#xa;join mcd	&#xd;&#xa;on  data.location_uniqueid&#x3d;mcd.location_uniqueid	&#xd;&#xa;and data.ChangeDate&#x3d;mcd.ChangeDate	&#xd;&#xa;where rn1&#x3c;&#x3e;rn2	&#xd;&#xa;&#x29;	&#xd;&#xa;select data.&#x2a;	&#xd;&#xa;,case when mbd.BookDt is null and data.rn1&#x3c;&#x3e;data.rn2 then &#x27;Y&#x27; else &#x27;N&#x27; end Hist_Flg	&#xd;&#xa;into &#x23;stg_location	&#xd;&#xa;from &#x23;stg_location1 data	&#xd;&#xa;left outer join mbd	&#xd;&#xa;on 	&#xd;&#xa;&#x28;data.location_uniqueid&#x3d;mbd.location_uniqueid	&#xd;&#xa;and data.BookDt&#x3e;&#x3d;mbd.BookDt&#x29;&#x3b; 	&#xd;&#xa;	&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;max_location_id&#x27;&#x29; IS NOT NULL	&#xd;&#xa;drop table &#x23;max_location_id&#x3b;	&#xd;&#xa;	&#xd;&#xa;select max&#x28;location_id&#x29; m into &#x23;max_location_id from fsbi_dw_spinn.dbo.dim_location&#x3b;	&#xd;&#xa;	&#xd;&#xa;insert into fsbi_dw_spinn.dbo.dim_location	&#xd;&#xa;&#x28;	&#xd;&#xa;&#x5b;Location_ID&#x5d;	&#xd;&#xa;      ,&#x5b;RECORD_VERSION&#x5d;	&#xd;&#xa;      ,&#x5b;VALID_FROMDATE&#x5d;	&#xd;&#xa;      ,&#x5b;VALID_TODATE&#x5d;	&#xd;&#xa;      ,&#x5b;LOCATION_UniqueId&#x5d;	&#xd;&#xa;      ,&#x5b;policy_uniqueid&#x5d;	&#xd;&#xa;      ,&#x5b;policy_id&#x5d;	&#xd;&#xa;      ,&#x5b;spinnlocation_id&#x5d;	&#xd;&#xa;      ,&#x5b;Status&#x5d;	&#xd;&#xa;      ,&#x5b;Location_NaturalKey&#x5d;	&#xd;&#xa;      ,&#x5b;LocationTypeCd&#x5d;	&#xd;&#xa;      ,&#x5b;LocationNumber&#x5d;	&#xd;&#xa;      ,&#x5b;LocationDesc&#x5d;	&#xd;&#xa;      ,&#x5b;ClassCode&#x5d;	&#xd;&#xa;      ,&#x5b;ProtectionClass&#x5d;	&#xd;&#xa;      ,&#x5b;TerritoryCd&#x5d;	&#xd;&#xa;      ,&#x5b;DistFireHydrant&#x5d;	&#xd;&#xa;      ,&#x5b;NumBuildings&#x5d;	&#xd;&#xa;      ,&#x5b;Units&#x5d;	&#xd;&#xa;      ,&#x5b;BuildingDistance&#x5d;	&#xd;&#xa;      ,&#x5b;SoilType&#x5d;	&#xd;&#xa;      ,&#x5b;DistBrushArea&#x5d;	&#xd;&#xa;      ,&#x5b;DistShoreline&#x5d;	&#xd;&#xa;      ,&#x5b;ManufacturedModularTrailer&#x5d;	&#xd;&#xa;      ,&#x5b;HillsideSlope&#x5d;	&#xd;&#xa;      ,&#x5b;LocationUnmodifiedLiabPremium&#x5d;	&#xd;&#xa;      ,&#x5b;AcceptableCompRate&#x5d;	&#xd;&#xa;      ,&#x5b;DiscountAdjusted&#x5d;	&#xd;&#xa;      ,&#x5b;WildFire&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessYears&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseIssueDt&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseExpireDt&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseStateCd&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseSuspendInd&#x5d;	&#xd;&#xa;      ,&#x5b;AccreditCareHome&#x5d;	&#xd;&#xa;      ,&#x5b;FirstYear&#x5d;	&#xd;&#xa;      ,&#x5b;ReinsuranceGroup&#x5d;	&#xd;&#xa;      ,&#x5b;BuildingGroup&#x5d;	&#xd;&#xa;      ,&#x5b;IncomeGroup&#x5d;	&#xd;&#xa;      ,&#x5b;ContentsGroup&#x5d;	&#xd;&#xa;      ,&#x5b;SourceSystem&#x5d;	&#xd;&#xa;      ,&#x5b;LoadDate&#x5d;	&#xd;&#xa;      ,&#x5b;audit_id&#x5d;	&#xd;&#xa;      ,&#x5b;original_valid_fromdate&#x5d;	&#xd;&#xa;      ,&#x5b;original_valid_todate&#x5d;	&#xd;&#xa;      ,&#x5b;original_record_version&#x5d;	&#xd;&#xa;      ,&#x5b;tiv_allbuildings&#x5d;	&#xd;&#xa;	  ,&#x5b;tiv_location_total&#x5d;&#xd;&#xa;&#x29;	&#xd;&#xa;select	&#xd;&#xa; -&#x23;max_location_id.m - row_number&#x28;&#x29; over &#x28;order by location_uniqueid,ChangeDate&#x29; location_ID 	&#xd;&#xa; ,-1 RECORD_VERSION	&#xd;&#xa; ,&#x27;1900-01-01&#x27; VALID_FROMDATE 	&#xd;&#xa; ,&#x27;1900-01-01&#x27; VALID_TODATE 	&#xd;&#xa;      ,&#x5b;LOCATION_UniqueId&#x5d;	&#xd;&#xa;      ,p.pol_uniqueid &#x5b;policy_uniqueid&#x5d;	&#xd;&#xa;      ,&#x5b;policy_id&#x5d;	&#xd;&#xa;      ,&#x5b;spinnlocation_id&#x5d;	&#xd;&#xa;      ,&#x5b;Status&#x5d;	&#xd;&#xa;      ,&#x5b;Location_NaturalKey&#x5d;	&#xd;&#xa;      ,&#x5b;LocationTypeCd&#x5d;	&#xd;&#xa;      ,&#x5b;LocationNumber&#x5d;	&#xd;&#xa;      ,&#x5b;LocationDesc&#x5d;	&#xd;&#xa;      ,&#x5b;ClassCode&#x5d;	&#xd;&#xa;      ,&#x5b;ProtectionClass&#x5d;	&#xd;&#xa;      ,&#x5b;TerritoryCd&#x5d;	&#xd;&#xa;      ,&#x5b;DistFireHydrant&#x5d;	&#xd;&#xa;      ,&#x5b;NumBuildings&#x5d;	&#xd;&#xa;      ,&#x5b;Units&#x5d;	&#xd;&#xa;      ,&#x5b;BuildingDistance&#x5d;	&#xd;&#xa;      ,&#x5b;SoilType&#x5d;	&#xd;&#xa;      ,&#x5b;DistBrushArea&#x5d;	&#xd;&#xa;      ,&#x5b;DistShoreline&#x5d;	&#xd;&#xa;      ,&#x5b;ManufacturedModularTrailer&#x5d;	&#xd;&#xa;      ,&#x5b;HillsideSlope&#x5d;	&#xd;&#xa;      ,&#x5b;LocationUnmodifiedLiabPremium&#x5d;	&#xd;&#xa;      ,&#x5b;AcceptableCompRate&#x5d;	&#xd;&#xa;      ,&#x5b;DiscountAdjusted&#x5d;	&#xd;&#xa;      ,&#x5b;WildFire&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessYears&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseIssueDt&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseExpireDt&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseStateCd&#x5d;	&#xd;&#xa;      ,&#x5b;BusinessLicenseSuspendInd&#x5d;	&#xd;&#xa;      ,&#x5b;AccreditCareHome&#x5d;	&#xd;&#xa;      ,&#x5b;FirstYear&#x5d;	&#xd;&#xa;      ,&#x5b;ReinsuranceGroup&#x5d;	&#xd;&#xa;      ,&#x5b;BuildingGroup&#x5d;	&#xd;&#xa;      ,&#x5b;IncomeGroup&#x5d;	&#xd;&#xa;      ,&#x5b;ContentsGroup&#x5d;	&#xd;&#xa;      ,&#x5b;SourceSystem&#x5d;	&#xd;&#xa;      ,cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate	&#xd;&#xa;      ,112 audit_id 	&#xd;&#xa;      ,ChangeDate original_valid_fromdate	&#xd;&#xa;      ,ChangeDate original_valid_todate	&#xd;&#xa;	  ,0&#xd;&#xa;      ,&#x5b;tiv_allbuildings&#x5d;	&#xd;&#xa;	  ,&#x5b;tiv_location_total&#x5d;&#xd;&#xa;	  from &#x23;stg_location stg&#xd;&#xa;	  join fsbi_dw_spinn.dbo.dim_policy p&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid	&#xd;&#xa;join &#x23;max_location_id on 1&#x3d;1	&#xd;&#xa;where Hist_Flg&#x3d;&#x27;Y&#x27;&#x3b;	&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;with temp&#x28;rank1,location_uniqueid,original_valid_fromdate &#x29;	&#xd;&#xa;as &#x28;	&#xd;&#xa;   select row_number&#x28;&#x29; over &#x28; partition by location_uniqueid,original_valid_fromdate order by location_uniqueid,original_valid_fromdate &#x29; rank1,	&#xd;&#xa;   location_uniqueid,	&#xd;&#xa;   original_valid_fromdate 	&#xd;&#xa;   from DIM_location	&#xd;&#xa;   where audit_id&#x3d;112	&#xd;&#xa;&#x29;	&#xd;&#xa;delete from temp where rank1 &#x3e; 1&#x3b;	&#xd;&#xa;	&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_LOCATION	&#xd;&#xa;set audit_id&#x3d;114	&#xd;&#xa;where  LOCATION_id in &#x28;select d2.LOCATION_id 	&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_LOCATION d	&#xd;&#xa;join fsbi_dw_spinn.dbo.DIM_LOCATION d2	&#xd;&#xa;on d.LOCATION_uniqueid&#x3d;d2.LOCATION_uniqueid	&#xd;&#xa;and d.valid_fromdate&#x3d;d2.valid_fromdate	&#xd;&#xa;and d2.valid_fromdate&#x3c;&#x3e;d2.valid_todate	&#xd;&#xa;where d.valid_fromdate&#x3d;d.valid_todate	&#xd;&#xa;and d.audit_id in &#x28;0,113&#x29;	&#xd;&#xa;and d2.audit_id in &#x28;0,113&#x29;&#x29;&#x3b;	&#xd;&#xa;	&#xd;&#xa;	&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_LOCATION	&#xd;&#xa;where valid_fromdate&#x3d;valid_todate	&#xd;&#xa;and audit_id in &#x28;0,113&#x29;&#x3b;	&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection/>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>451</xloc>
      <yloc>726</yloc>
      </entry>
    <entry>
      <name>SQL DIM_VEHICLE Historical Load</name>
      <description/>
      <type>SQL</type>
      <sql>  --adjusting stg_vehicle				&#xd;&#xa;  				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_vehicle1&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;stg_vehicle1&#x3b;				&#xd;&#xa;				&#xd;&#xa;select 				&#xd;&#xa;&#x2a;,				&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by vehicle_uniqueid order by ChangeDate &#x29; rn1,				&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by vehicle_uniqueid order by BookDt &#x29; rn2				&#xd;&#xa;into &#x23;stg_vehicle1				&#xd;&#xa;from &#x28;select distinct &#x2a; from fsbi_stg_spinn.dbo.stg_vehicle&#x29; data&#x3b;				&#xd;&#xa;				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_vehicle&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;stg_vehicle&#x3b;				&#xd;&#xa;				&#xd;&#xa;with mcd as &#x28;select vehicle_uniqueid, min&#x28;ChangeDate&#x29; ChangeDate				&#xd;&#xa;from &#x23;stg_vehicle1 data				&#xd;&#xa;where rn1&#x3c;&#x3e;rn2				&#xd;&#xa;group by vehicle_uniqueid&#x29; 				&#xd;&#xa;,mbd as &#x28;select distinct data.vehicle_uniqueid, data.BookDt				&#xd;&#xa;from &#x23;stg_vehicle1 data				&#xd;&#xa;join mcd				&#xd;&#xa;on  data.vehicle_uniqueid&#x3d;mcd.vehicle_uniqueid				&#xd;&#xa;and data.ChangeDate&#x3d;mcd.ChangeDate				&#xd;&#xa;where rn1&#x3c;&#x3e;rn2				&#xd;&#xa;&#x29;				&#xd;&#xa;select data.&#x2a;				&#xd;&#xa;,case when mbd.BookDt is null and data.rn1&#x3c;&#x3e;data.rn2 then &#x27;Y&#x27; else &#x27;N&#x27; end Hist_Flg				&#xd;&#xa;into &#x23;stg_vehicle				&#xd;&#xa;from &#x23;stg_vehicle1 data				&#xd;&#xa;left outer join mbd				&#xd;&#xa;on 				&#xd;&#xa;&#x28;data.vehicle_uniqueid&#x3d;mbd.vehicle_uniqueid				&#xd;&#xa;and data.BookDt&#x3e;&#x3d;mbd.BookDt&#x29;&#x3b; 				&#xd;&#xa;				&#xd;&#xa;  				&#xd;&#xa;  				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;tmp_stg_vehicle&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;tmp_stg_vehicle&#x3b;				&#xd;&#xa;				&#xd;&#xa;SELECT   vehicle_uniqueid				&#xd;&#xa;       , cast&#x28;stg.PolicyRef as varchar&#x29; Policy_Uniqueid				&#xd;&#xa;       , p.Policy_Id				&#xd;&#xa;       , SPInnVehicle_Id				&#xd;&#xa;       , Status				&#xd;&#xa;       , stateprovcd				&#xd;&#xa;       , county				&#xd;&#xa;       , postalcode				&#xd;&#xa;       , city				&#xd;&#xa;       , addr1				&#xd;&#xa;       , addr2				&#xd;&#xa;	   , GaragAddrFlg			&#xd;&#xa;       , manufacturer				&#xd;&#xa;       , model				&#xd;&#xa;       , modelyr				&#xd;&#xa;       , vehidentificationnumber				&#xd;&#xa;       , validvinind				&#xd;&#xa;       , vehlicensenumber				&#xd;&#xa;       , registrationstateprovcd				&#xd;&#xa;       , vehbodytypecd				&#xd;&#xa;       , performancecd				&#xd;&#xa;       , restraintcd				&#xd;&#xa;       , antibrakingsystemcd				&#xd;&#xa;       , antitheftcd				&#xd;&#xa;       , enginesize				&#xd;&#xa;       , enginecylinders				&#xd;&#xa;       , enginehorsepower				&#xd;&#xa;       , enginetype				&#xd;&#xa;       , vehusecd				&#xd;&#xa;       , garageterritory				&#xd;&#xa;       , collisionded				&#xd;&#xa;       , comprehensiveded				&#xd;&#xa;       , statedamt				&#xd;&#xa;       , classcd				&#xd;&#xa;       , ratingvalue				&#xd;&#xa;       , costnewamt				&#xd;&#xa;       , estimatedannualdistance				&#xd;&#xa;       , estimatedworkdistance				&#xd;&#xa;       , leasedvehind				&#xd;&#xa;       , purchasedt				&#xd;&#xa;       , statedamtind				&#xd;&#xa;       , neworusedind				&#xd;&#xa;       , carpoolind				&#xd;&#xa;       , odometerreading				&#xd;&#xa;       , weekspermonthdriven				&#xd;&#xa;       , daylightrunninglightsind				&#xd;&#xa;       , passiveseatbeltind				&#xd;&#xa;       , daysperweekdriven				&#xd;&#xa;       , umpdlimit				&#xd;&#xa;       , towingandlaborind				&#xd;&#xa;       , rentalreimbursementind				&#xd;&#xa;       , liabilitywaiveind				&#xd;&#xa;       , ratefeesind				&#xd;&#xa;       , optionalequipmentvalue				&#xd;&#xa;       , customizingequipmentind				&#xd;&#xa;       , customizingequipmentdesc				&#xd;&#xa;       , invalidvinacknowledgementind				&#xd;&#xa;       , ignoreumpdwcdind				&#xd;&#xa;       , recalculateratingsymbolind				&#xd;&#xa;       , programtypecd				&#xd;&#xa;       , cmpratingvalue				&#xd;&#xa;       , colratingvalue				&#xd;&#xa;       , liabilityratingvalue				&#xd;&#xa;       , medpayratingvalue				&#xd;&#xa;       , racmpratingvalue				&#xd;&#xa;       , racolratingvalue				&#xd;&#xa;       , rabiratingsymbol				&#xd;&#xa;       , rapdratingsymbol				&#xd;&#xa;       , ramedpayratingsymbol				&#xd;&#xa;       , estimatedannualdistanceoverride				&#xd;&#xa;       , originalestimatedannualmiles				&#xd;&#xa;       , reportedmileagenonsave				&#xd;&#xa;       , mileage				&#xd;&#xa;       , estimatednoncommutemiles				&#xd;&#xa;       , titlehistoryissue				&#xd;&#xa;       , odometerproblems				&#xd;&#xa;       , bundle				&#xd;&#xa;       , loanleasegap				&#xd;&#xa;       , equivalentreplacementcost				&#xd;&#xa;       , originalequipmentmanufacturer				&#xd;&#xa;       , optionalrideshare				&#xd;&#xa;       , medicalpartsaccessibility				&#xd;&#xa;       , vehnumber				&#xd;&#xa;       , odometerreadingprior				&#xd;&#xa;       , reportedmileagenonsavedtprior				&#xd;&#xa;       , fullglasscovind				       &#xd;&#xa;       , stg.changedate				&#xd;&#xa;	   into &#x23;tmp_stg_vehicle			&#xd;&#xa; FROM  &#x28;select distinct &#x2a; from &#x23;stg_vehicle where Hist_Flg&#x3d;&#x27;N&#x27;&#x29;  stg 				&#xd;&#xa; join fsbi_dw_spinn.dbo.dim_policy p				&#xd;&#xa; on cast&#x28;stg.policyref as varchar&#x29;&#x3d;p.pol_uniqueid&#x3b;				&#xd;&#xa;				&#xd;&#xa;   --creating temp dim_vehicle with extra rows				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;tmp_DIM_VEHICLE&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;tmp_DIM_VEHICLE&#x3b;				&#xd;&#xa; 				&#xd;&#xa;				&#xd;&#xa;SELECT 				&#xd;&#xa;    row_number&#x28;&#x29; over&#x28;ORDER BY  Vehicle_UniqueId,  changeDate&#x29; vehicle_id,				&#xd;&#xa;    case 				&#xd;&#xa;     when row_number&#x28;&#x29; OVER &#x28; PARTITION BY Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#x3d;1 then				&#xd;&#xa;      cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;				&#xd;&#xa;     else				&#xd;&#xa;      changeDate 				&#xd;&#xa;     end VALID_FROMDATE,				&#xd;&#xa;        isnull&#x28;lead&#x28;changeDate&#x29; OVER &#x28; PARTITION BY Vehicle_UniqueId  ORDER BY  changeDate&#x29;,cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;&#x29; VALID_TODATE ,				&#xd;&#xa;	   CASE			&#xd;&#xa;	   --if nothing change - delete the row for SCD			&#xd;&#xa;	   WHEN 			&#xd;&#xa;	    Status	 &#x3d;lag&#x28;	Status	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	StateProvCd	 &#x3d;lag&#x28;	StateProvCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	County	 &#x3d;lag&#x28;	County	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	PostalCode	 &#x3d;lag&#x28;	PostalCode	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	City	 &#x3d;lag&#x28;	City	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	Addr1	 &#x3d;lag&#x28;	Addr1	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	Addr2	 &#x3d;lag&#x28;	Addr2	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND    	Manufacturer	 &#x3d;lag&#x28;	Manufacturer	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	Model	 &#x3d;lag&#x28;	Model	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ModelYr	 &#x3d;lag&#x28;	ModelYr	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	VehIdentificationNumber	 &#x3d;lag&#x28;	VehIdentificationNumber	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ValidVinInd	 &#x3d;lag&#x28;	ValidVinInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	VehLicenseNumber	 &#x3d;lag&#x28;	VehLicenseNumber	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RegistrationStateProvCd	 &#x3d;lag&#x28;	RegistrationStateProvCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	VehBodyTypeCd	 &#x3d;lag&#x28;	VehBodyTypeCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	PerformanceCd	 &#x3d;lag&#x28;	PerformanceCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RestraintCd	 &#x3d;lag&#x28;	RestraintCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	AntiBrakingSystemCd	 &#x3d;lag&#x28;	AntiBrakingSystemCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	AntiTheftCd	 &#x3d;lag&#x28;	AntiTheftCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EngineSize	 &#x3d;lag&#x28;	EngineSize	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EngineCylinders	 &#x3d;lag&#x28;	EngineCylinders	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EngineHorsePower	 &#x3d;lag&#x28;	EngineHorsePower	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EngineType	 &#x3d;lag&#x28;	EngineType	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	VehUseCd	 &#x3d;lag&#x28;	VehUseCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	GarageTerritory	 &#x3d;lag&#x28;	GarageTerritory	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CollisionDed	 &#x3d;lag&#x28;	CollisionDed	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ComprehensiveDed	 &#x3d;lag&#x28;	ComprehensiveDed	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	StatedAmt	 &#x3d;lag&#x28;	StatedAmt	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ClassCd	 &#x3d;lag&#x28;	ClassCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RatingValue	 &#x3d;lag&#x28;	RatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CostNewAmt	 &#x3d;lag&#x28;	CostNewAmt	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EstimatedAnnualDistance	 &#x3d;lag&#x28;	EstimatedAnnualDistance	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EstimatedWorkDistance	 &#x3d;lag&#x28;	EstimatedWorkDistance	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	LeasedVehInd	 &#x3d;lag&#x28;	LeasedVehInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	PurchaseDt	 &#x3d;lag&#x28;	PurchaseDt	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	StatedAmtInd	 &#x3d;lag&#x28;	StatedAmtInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	NewOrUsedInd	 &#x3d;lag&#x28;	NewOrUsedInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CarPoolInd	 &#x3d;lag&#x28;	CarPoolInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OdometerReading	 &#x3d;lag&#x28;	OdometerReading	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	WeeksPerMonthDriven	 &#x3d;lag&#x28;	WeeksPerMonthDriven	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	DaylightRunningLightsInd	 &#x3d;lag&#x28;	DaylightRunningLightsInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	PassiveSeatBeltInd	 &#x3d;lag&#x28;	PassiveSeatBeltInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	DaysPerWeekDriven	 &#x3d;lag&#x28;	DaysPerWeekDriven	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	UMPDLimit	 &#x3d;lag&#x28;	UMPDLimit	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	TowingAndLaborInd	 &#x3d;lag&#x28;	TowingAndLaborInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RentalReimbursementInd	 &#x3d;lag&#x28;	RentalReimbursementInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	LiabilityWaiveInd	 &#x3d;lag&#x28;	LiabilityWaiveInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RateFeesInd	 &#x3d;lag&#x28;	RateFeesInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OptionalEquipmentValue	 &#x3d;lag&#x28;	OptionalEquipmentValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CustomizingEquipmentInd	 &#x3d;lag&#x28;	CustomizingEquipmentInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CustomizingEquipmentDesc	 &#x3d;lag&#x28;	CustomizingEquipmentDesc	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	InvalidVinAcknowledgementInd	 &#x3d;lag&#x28;	InvalidVinAcknowledgementInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	IgnoreUMPDWCDInd	 &#x3d;lag&#x28;	IgnoreUMPDWCDInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RecalculateRatingSymbolInd	 &#x3d;lag&#x28;	RecalculateRatingSymbolInd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ProgramTypeCd	 &#x3d;lag&#x28;	ProgramTypeCd	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	CMPRatingValue	 &#x3d;lag&#x28;	CMPRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	COLRatingValue	 &#x3d;lag&#x28;	COLRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	LiabilityRatingValue	 &#x3d;lag&#x28;	LiabilityRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	MedPayRatingValue	 &#x3d;lag&#x28;	MedPayRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RACMPRatingValue	 &#x3d;lag&#x28;	RACMPRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RACOLRatingValue	 &#x3d;lag&#x28;	RACOLRatingValue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RABIRatingSymbol	 &#x3d;lag&#x28;	RABIRatingSymbol	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RAPDRatingSymbol	 &#x3d;lag&#x28;	RAPDRatingSymbol	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	RAMedPayRatingSymbol	 &#x3d;lag&#x28;	RAMedPayRatingSymbol	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EstimatedAnnualDistanceOverride	 &#x3d;lag&#x28;	EstimatedAnnualDistanceOverride	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OriginalEstimatedAnnualMiles	 &#x3d;lag&#x28;	OriginalEstimatedAnnualMiles	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	ReportedMileageNonSave	 &#x3d;lag&#x28;	ReportedMileageNonSave	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	Mileage	 &#x3d;lag&#x28;	Mileage	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EstimatedNonCommuteMiles	 &#x3d;lag&#x28;	EstimatedNonCommuteMiles	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	TitleHistoryIssue	 &#x3d;lag&#x28;	TitleHistoryIssue	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OdometerProblems	 &#x3d;lag&#x28;	OdometerProblems	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	Bundle	 &#x3d;lag&#x28;	Bundle	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	LoanLeaseGap	 &#x3d;lag&#x28;	LoanLeaseGap	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	EquivalentReplacementCost	 &#x3d;lag&#x28;	EquivalentReplacementCost	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OriginalEquipmentManufacturer	 &#x3d;lag&#x28;	OriginalEquipmentManufacturer	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OptionalRideshare	 &#x3d;lag&#x28;	OptionalRideshare	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	MedicalPartsAccessibility	 &#x3d;lag&#x28;	MedicalPartsAccessibility	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	VehNumber	 &#x3d;lag&#x28;	VehNumber	&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;&#xd;&#xa;AND 	OdometerReadingPrior&#x3d;lag&#x28;	OdometerReadingPrior&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;		&#xd;&#xa;AND 	ReportedMileageNonSaveDtPrior&#x3d;lag&#x28;	ReportedMileageNonSaveDtPrior&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;		&#xd;&#xa;AND 	FullGlassCovInd&#x3d;lag&#x28;	FullGlassCovInd&#x29; OVER &#x28; PARTITION BY  Vehicle_UniqueId  ORDER BY  changeDate &#x29;		&#xd;&#xa;	   THEN			&#xd;&#xa;	0			&#xd;&#xa;	   ELSE			&#xd;&#xa;	    row_number&#x28;&#x29; OVER &#x28; PARTITION BY Vehicle_UniqueId  ORDER BY  changeDate &#x29; 			&#xd;&#xa;	   END Record_Version 			&#xd;&#xa;      ,Vehicle_UniqueId				&#xd;&#xa;      ,Policy_Uniqueid				&#xd;&#xa;      ,Policy_Id 				&#xd;&#xa;      ,SPInnVehicle_Id 				&#xd;&#xa;      ,Status 				&#xd;&#xa;      ,StateProvCd 				&#xd;&#xa;      ,County 				&#xd;&#xa;      ,PostalCode 				&#xd;&#xa;      ,City 				&#xd;&#xa;      ,Addr1 				&#xd;&#xa;      ,Addr2    				&#xd;&#xa;	  ,GaragAddrFlg			&#xd;&#xa;      ,Manufacturer				&#xd;&#xa;      ,Model				&#xd;&#xa;      ,ModelYr				&#xd;&#xa;      ,VehIdentificationNumber				&#xd;&#xa;      ,ValidVinInd				&#xd;&#xa;      ,VehLicenseNumber				&#xd;&#xa;      ,RegistrationStateProvCd				&#xd;&#xa;      ,VehBodyTypeCd				&#xd;&#xa;      ,PerformanceCd				&#xd;&#xa;      ,RestraintCd				&#xd;&#xa;      ,AntiBrakingSystemCd				&#xd;&#xa;      ,AntiTheftCd				&#xd;&#xa;      ,EngineSize				&#xd;&#xa;      ,EngineCylinders				&#xd;&#xa;      ,EngineHorsePower				&#xd;&#xa;      ,EngineType				&#xd;&#xa;      ,VehUseCd				&#xd;&#xa;      ,GarageTerritory				&#xd;&#xa;      ,CollisionDed				&#xd;&#xa;      ,ComprehensiveDed				&#xd;&#xa;      ,StatedAmt				&#xd;&#xa;      ,ClassCd				&#xd;&#xa;      ,RatingValue				&#xd;&#xa;      ,CostNewAmt				&#xd;&#xa;      ,EstimatedAnnualDistance				&#xd;&#xa;      ,EstimatedWorkDistance				&#xd;&#xa;      ,LeasedVehInd				&#xd;&#xa;      ,PurchaseDt				&#xd;&#xa;      ,StatedAmtInd				&#xd;&#xa;      ,NewOrUsedInd				&#xd;&#xa;      ,CarPoolInd				&#xd;&#xa;      ,OdometerReading				&#xd;&#xa;      ,WeeksPerMonthDriven				&#xd;&#xa;      ,DaylightRunningLightsInd				&#xd;&#xa;      ,PassiveSeatBeltInd				&#xd;&#xa;      ,DaysPerWeekDriven				&#xd;&#xa;      ,UMPDLimit				&#xd;&#xa;      ,TowingAndLaborInd				&#xd;&#xa;      ,RentalReimbursementInd				&#xd;&#xa;      ,LiabilityWaiveInd				&#xd;&#xa;      ,RateFeesInd				&#xd;&#xa;      ,OptionalEquipmentValue				&#xd;&#xa;      ,CustomizingEquipmentInd				&#xd;&#xa;      ,CustomizingEquipmentDesc				&#xd;&#xa;      ,InvalidVinAcknowledgementInd				&#xd;&#xa;      ,IgnoreUMPDWCDInd				&#xd;&#xa;      ,RecalculateRatingSymbolInd				&#xd;&#xa;      ,ProgramTypeCd				&#xd;&#xa;      ,CMPRatingValue				&#xd;&#xa;      ,COLRatingValue				&#xd;&#xa;      ,LiabilityRatingValue				&#xd;&#xa;      ,MedPayRatingValue				&#xd;&#xa;      ,RACMPRatingValue				&#xd;&#xa;      ,RACOLRatingValue				&#xd;&#xa;      ,RABIRatingSymbol				&#xd;&#xa;      ,RAPDRatingSymbol				&#xd;&#xa;      ,RAMedPayRatingSymbol				&#xd;&#xa;      ,EstimatedAnnualDistanceOverride				&#xd;&#xa;      ,OriginalEstimatedAnnualMiles				&#xd;&#xa;      ,ReportedMileageNonSave				&#xd;&#xa;      ,Mileage				&#xd;&#xa;      ,EstimatedNonCommuteMiles				&#xd;&#xa;      ,TitleHistoryIssue				&#xd;&#xa;      ,OdometerProblems				&#xd;&#xa;      ,Bundle				&#xd;&#xa;      ,LoanLeaseGap				&#xd;&#xa;      ,EquivalentReplacementCost				&#xd;&#xa;      ,OriginalEquipmentManufacturer				&#xd;&#xa;      ,OptionalRideshare				&#xd;&#xa;      ,MedicalPartsAccessibility				&#xd;&#xa;	  ,VehNumber			&#xd;&#xa;	  ,OdometerReadingPrior			&#xd;&#xa;      ,ReportedMileageNonSaveDtPrior				&#xd;&#xa;      ,FullGlassCovInd				&#xd;&#xa;	   into &#x23;tmp_DIM_VEHICLE			&#xd;&#xa;  FROM &#x23;tmp_stg_vehicle				&#xd;&#xa;  ORDER BY cast&#x28;Policy_Uniqueid as int&#x29;,Vehicle_UniqueId, changeDate&#x3b;				&#xd;&#xa;  				&#xd;&#xa;    --&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;&#x3d;				&#xd;&#xa;DELETE FROM fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;WHERE VEHICLE_ID&#x3c;&#x3e;0&#x3b;				&#xd;&#xa;				&#xd;&#xa;INSERT INTO fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;&#x28;VEHICLE_ID ,				&#xd;&#xa; VALID_FROMDATE ,				&#xd;&#xa; VALID_TODATE ,				&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Vehicle_UniqueId ,				&#xd;&#xa;Policy_Uniqueid ,				&#xd;&#xa;Policy_Id ,				&#xd;&#xa;SPInnVehicle_Id ,				&#xd;&#xa;Status ,				&#xd;&#xa;StateProvCd ,				&#xd;&#xa;County ,				&#xd;&#xa;PostalCode ,				&#xd;&#xa;City ,				&#xd;&#xa;Addr1 ,				&#xd;&#xa;Addr2 ,   				&#xd;&#xa;GaragAddrFlg ,				&#xd;&#xa;Manufacturer	,			&#xd;&#xa;Model	,			&#xd;&#xa;ModelYr	,			&#xd;&#xa;VehIdentificationNumber	,			&#xd;&#xa;ValidVinInd	,			&#xd;&#xa;VehLicenseNumber	,			&#xd;&#xa;RegistrationStateProvCd	,			&#xd;&#xa;VehBodyTypeCd	,			&#xd;&#xa;PerformanceCd	,			&#xd;&#xa;RestraintCd	,			&#xd;&#xa;AntiBrakingSystemCd	,			&#xd;&#xa;AntiTheftCd	,			&#xd;&#xa;EngineSize	,			&#xd;&#xa;EngineCylinders	,			&#xd;&#xa;EngineHorsePower	,			&#xd;&#xa;EngineType	,			&#xd;&#xa;VehUseCd	,			&#xd;&#xa;GarageTerritory	,			&#xd;&#xa;CollisionDed	,			&#xd;&#xa;ComprehensiveDed	,			&#xd;&#xa;StatedAmt	,			&#xd;&#xa;ClassCd	,			&#xd;&#xa;RatingValue	,			&#xd;&#xa;CostNewAmt	,			&#xd;&#xa;EstimatedAnnualDistance	,			&#xd;&#xa;EstimatedWorkDistance	,			&#xd;&#xa;LeasedVehInd	,			&#xd;&#xa;PurchaseDt	,			&#xd;&#xa;StatedAmtInd	,			&#xd;&#xa;NewOrUsedInd	,			&#xd;&#xa;CarPoolInd	,			&#xd;&#xa;OdometerReading	,			&#xd;&#xa;WeeksPerMonthDriven	,			&#xd;&#xa;DaylightRunningLightsInd	,			&#xd;&#xa;PassiveSeatBeltInd	,			&#xd;&#xa;DaysPerWeekDriven	,			&#xd;&#xa;UMPDLimit	,			&#xd;&#xa;TowingAndLaborInd	,			&#xd;&#xa;RentalReimbursementInd	,			&#xd;&#xa;LiabilityWaiveInd	,			&#xd;&#xa;RateFeesInd	,			&#xd;&#xa;OptionalEquipmentValue	,			&#xd;&#xa;CustomizingEquipmentInd	,			&#xd;&#xa;CustomizingEquipmentDesc	,			&#xd;&#xa;InvalidVinAcknowledgementInd	,			&#xd;&#xa;IgnoreUMPDWCDInd	,			&#xd;&#xa;RecalculateRatingSymbolInd	,			&#xd;&#xa;ProgramTypeCd	,			&#xd;&#xa;CMPRatingValue	,			&#xd;&#xa;COLRatingValue	,			&#xd;&#xa;LiabilityRatingValue	,			&#xd;&#xa;MedPayRatingValue	,			&#xd;&#xa;RACMPRatingValue	,			&#xd;&#xa;RACOLRatingValue	,			&#xd;&#xa;RABIRatingSymbol	,			&#xd;&#xa;RAPDRatingSymbol	,			&#xd;&#xa;RAMedPayRatingSymbol	,			&#xd;&#xa;EstimatedAnnualDistanceOverride	,			&#xd;&#xa;OriginalEstimatedAnnualMiles	,			&#xd;&#xa;ReportedMileageNonSave	,			&#xd;&#xa;Mileage	,			&#xd;&#xa;EstimatedNonCommuteMiles	,			&#xd;&#xa;TitleHistoryIssue	,			&#xd;&#xa;OdometerProblems	,			&#xd;&#xa;Bundle	,			&#xd;&#xa;LoanLeaseGap	,			&#xd;&#xa;EquivalentReplacementCost	,			&#xd;&#xa;OriginalEquipmentManufacturer	,			&#xd;&#xa;OptionalRideshare	,			&#xd;&#xa;MedicalPartsAccessibility	,			&#xd;&#xa;VehNumber,				&#xd;&#xa;OdometerReadingPrior,				&#xd;&#xa;ReportedMileageNonSaveDtPrior,				&#xd;&#xa;FullGlassCovInd	,			&#xd;&#xa;LoadDate				&#xd;&#xa;&#x29;				&#xd;&#xa;select				&#xd;&#xa; VEHICLE_ID ,				&#xd;&#xa; VALID_FROMDATE ,				&#xd;&#xa; isnull&#x28;lead&#x28;VALID_FROMDATE&#x29; OVER &#x28; PARTITION BY Vehicle_UniqueId  ORDER BY record_version &#x29;,&#x27;3000-01-01&#x27;&#x29;   VALID_TODATE ,				&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Vehicle_UniqueId ,				&#xd;&#xa;Policy_Uniqueid ,				&#xd;&#xa;Policy_Id ,				&#xd;&#xa;SPInnVehicle_Id ,				&#xd;&#xa;Status ,				&#xd;&#xa;StateProvCd ,				&#xd;&#xa;County ,				&#xd;&#xa;PostalCode ,				&#xd;&#xa;City ,				&#xd;&#xa;Addr1 ,				&#xd;&#xa;Addr2 ,   				&#xd;&#xa;GaragAddrFlg ,				&#xd;&#xa;Manufacturer	,			&#xd;&#xa;Model	,			&#xd;&#xa;ModelYr	,			&#xd;&#xa;VehIdentificationNumber	,			&#xd;&#xa;ValidVinInd	,			&#xd;&#xa;VehLicenseNumber	,			&#xd;&#xa;RegistrationStateProvCd	,			&#xd;&#xa;VehBodyTypeCd	,			&#xd;&#xa;PerformanceCd	,			&#xd;&#xa;RestraintCd	,			&#xd;&#xa;AntiBrakingSystemCd	,			&#xd;&#xa;AntiTheftCd	,			&#xd;&#xa;EngineSize	,			&#xd;&#xa;EngineCylinders	,			&#xd;&#xa;EngineHorsePower	,			&#xd;&#xa;EngineType	,			&#xd;&#xa;VehUseCd	,			&#xd;&#xa;GarageTerritory	,			&#xd;&#xa;CollisionDed	,			&#xd;&#xa;ComprehensiveDed	,			&#xd;&#xa;StatedAmt	,			&#xd;&#xa;ClassCd	,			&#xd;&#xa;RatingValue	,			&#xd;&#xa;CostNewAmt	,			&#xd;&#xa;EstimatedAnnualDistance	,			&#xd;&#xa;EstimatedWorkDistance	,			&#xd;&#xa;LeasedVehInd	,			&#xd;&#xa;PurchaseDt	,			&#xd;&#xa;StatedAmtInd	,			&#xd;&#xa;NewOrUsedInd	,			&#xd;&#xa;CarPoolInd	,			&#xd;&#xa;OdometerReading	,			&#xd;&#xa;WeeksPerMonthDriven	,			&#xd;&#xa;DaylightRunningLightsInd	,			&#xd;&#xa;PassiveSeatBeltInd	,			&#xd;&#xa;DaysPerWeekDriven	,			&#xd;&#xa;UMPDLimit	,			&#xd;&#xa;TowingAndLaborInd	,			&#xd;&#xa;RentalReimbursementInd	,			&#xd;&#xa;LiabilityWaiveInd	,			&#xd;&#xa;RateFeesInd	,			&#xd;&#xa;OptionalEquipmentValue	,			&#xd;&#xa;CustomizingEquipmentInd	,			&#xd;&#xa;CustomizingEquipmentDesc	,			&#xd;&#xa;InvalidVinAcknowledgementInd	,			&#xd;&#xa;IgnoreUMPDWCDInd	,			&#xd;&#xa;RecalculateRatingSymbolInd	,			&#xd;&#xa;ProgramTypeCd	,			&#xd;&#xa;CMPRatingValue	,			&#xd;&#xa;COLRatingValue	,			&#xd;&#xa;LiabilityRatingValue	,			&#xd;&#xa;MedPayRatingValue	,			&#xd;&#xa;RACMPRatingValue	,			&#xd;&#xa;RACOLRatingValue	,			&#xd;&#xa;RABIRatingSymbol	,			&#xd;&#xa;RAPDRatingSymbol	,			&#xd;&#xa;RAMedPayRatingSymbol	,			&#xd;&#xa;EstimatedAnnualDistanceOverride	,			&#xd;&#xa;OriginalEstimatedAnnualMiles	,			&#xd;&#xa;ReportedMileageNonSave	,			&#xd;&#xa;Mileage	,			&#xd;&#xa;EstimatedNonCommuteMiles	,			&#xd;&#xa;TitleHistoryIssue	,			&#xd;&#xa;OdometerProblems	,			&#xd;&#xa;Bundle	,			&#xd;&#xa;LoanLeaseGap	,			&#xd;&#xa;EquivalentReplacementCost	,			&#xd;&#xa;OriginalEquipmentManufacturer	,			&#xd;&#xa;OptionalRideshare	,			&#xd;&#xa;MedicalPartsAccessibility	,			&#xd;&#xa;VehNumber,				&#xd;&#xa;OdometerReadingPrior,				&#xd;&#xa;ReportedMileageNonSaveDtPrior,				&#xd;&#xa;FullGlassCovInd	,			&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate				&#xd;&#xa;from &#x23;tmp_DIM_VEHICLE				&#xd;&#xa;where record_version&#x3c;&#x3e;0				&#xd;&#xa;ORDER BY Vehicle_UniqueId, record_version&#x3b;				&#xd;&#xa;				&#xd;&#xa; --adjusting Valid From for 1st vehicle records  				&#xd;&#xa;update				&#xd;&#xa;    FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;set				&#xd;&#xa;    DIM_VEHICLE.VALID_FROMDATE &#x3d; cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;				&#xd;&#xa;from				&#xd;&#xa;    &#x28;				&#xd;&#xa;select VEHICLE_UniqueID				&#xd;&#xa;,min&#x28;Record_Version&#x29; r				&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;group by VEHICLE_UniqueID				&#xd;&#xa;&#x29; d				&#xd;&#xa;join				&#xd;&#xa;FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;on  DIM_VEHICLE.VEHICLE_UniqueID&#x3d;d.VEHICLE_UniqueID				&#xd;&#xa;and DIM_VEHICLE.RECORD_VERSION&#x3d;d.r&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --adjusting ValidTo for the last vehicle record				&#xd;&#xa;update				&#xd;&#xa;    FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;set				&#xd;&#xa;    DIM_VEHICLE.VALID_TODATE &#x3d; cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;				&#xd;&#xa;from				&#xd;&#xa;    &#x28;				&#xd;&#xa;select VEHICLE_UniqueID				&#xd;&#xa;,max&#x28;Record_Version&#x29; r				&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;group by VEHICLE_UniqueID				&#xd;&#xa;&#x29; d				&#xd;&#xa;join				&#xd;&#xa;FSBI_DW_SPINN.dbo.DIM_VEHICLE				&#xd;&#xa;on  DIM_VEHICLE.VEHICLE_UniqueID&#x3d;d.VEHICLE_UniqueID				&#xd;&#xa;and DIM_VEHICLE.RECORD_VERSION&#x3d;d.r				&#xd;&#xa;and DIM_VEHICLE.VALID_TODATE&#x3c;cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --adjusting ValidFrom for the first driver record				&#xd;&#xa;update				&#xd;&#xa;    fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;set				&#xd;&#xa;    DIM_VEHICLE.VALID_FROMDATE &#x3d; cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;				&#xd;&#xa;from				&#xd;&#xa;    &#x28;				&#xd;&#xa;select VEHICLE_UniqueID				&#xd;&#xa;,min&#x28;Record_Version&#x29; r				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;group by VEHICLE_UniqueID				&#xd;&#xa;&#x29; d				&#xd;&#xa;join				&#xd;&#xa;fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;on  DIM_VEHICLE.VEHICLE_UniqueID&#x3d;d.VEHICLE_UniqueID				&#xd;&#xa;and DIM_VEHICLE.RECORD_VERSION&#x3d;d.r				&#xd;&#xa;and DIM_VEHICLE.VALID_TODATE&#x3e;cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --adjusting record_version				&#xd;&#xa;with data as &#x28;select vehicle_id, row_number&#x28;&#x29; over&#x28;partition by vehicle_uniqueid order by valid_fromdate, valid_todate&#x29; rn				&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_vehicle d				&#xd;&#xa;where audit_id&#x3d;0&#x29;				&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_vehicle				&#xd;&#xa;set record_version&#x3d;data.rn				&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_vehicle v				&#xd;&#xa;join data on v.vehicle_id&#x3d;data.vehicle_id				&#xd;&#xa;where audit_id&#x3d;0&#x3b;				&#xd;&#xa;				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;max_vehicle_id&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;max_vehicle_id&#x3b;				&#xd;&#xa;				&#xd;&#xa;select max&#x28;vehicle_id&#x29; m into &#x23;max_vehicle_id from fsbi_dw_spinn.dbo.dim_vehicle&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --Historical records				&#xd;&#xa;INSERT INTO fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;&#x28;VEHICLE_ID ,				&#xd;&#xa; VALID_FROMDATE ,				&#xd;&#xa; VALID_TODATE ,				&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Vehicle_UniqueId ,				&#xd;&#xa;Policy_Uniqueid ,				&#xd;&#xa;Policy_Id ,				&#xd;&#xa;SPInnVehicle_Id ,				&#xd;&#xa;Status ,				&#xd;&#xa;StateProvCd ,				&#xd;&#xa;County ,				&#xd;&#xa;PostalCode ,				&#xd;&#xa;City ,				&#xd;&#xa;Addr1 ,				&#xd;&#xa;Addr2 ,   				&#xd;&#xa;GaragAddrFlg ,				&#xd;&#xa;Manufacturer	,			&#xd;&#xa;Model	,			&#xd;&#xa;ModelYr	,			&#xd;&#xa;VehIdentificationNumber	,			&#xd;&#xa;ValidVinInd	,			&#xd;&#xa;VehLicenseNumber	,			&#xd;&#xa;RegistrationStateProvCd	,			&#xd;&#xa;VehBodyTypeCd	,			&#xd;&#xa;PerformanceCd	,			&#xd;&#xa;RestraintCd	,			&#xd;&#xa;AntiBrakingSystemCd	,			&#xd;&#xa;AntiTheftCd	,			&#xd;&#xa;EngineSize	,			&#xd;&#xa;EngineCylinders	,			&#xd;&#xa;EngineHorsePower	,			&#xd;&#xa;EngineType	,			&#xd;&#xa;VehUseCd	,			&#xd;&#xa;GarageTerritory	,			&#xd;&#xa;CollisionDed	,			&#xd;&#xa;ComprehensiveDed	,			&#xd;&#xa;StatedAmt	,			&#xd;&#xa;ClassCd	,			&#xd;&#xa;RatingValue	,			&#xd;&#xa;CostNewAmt	,			&#xd;&#xa;EstimatedAnnualDistance	,			&#xd;&#xa;EstimatedWorkDistance	,			&#xd;&#xa;LeasedVehInd	,			&#xd;&#xa;PurchaseDt	,			&#xd;&#xa;StatedAmtInd	,			&#xd;&#xa;NewOrUsedInd	,			&#xd;&#xa;CarPoolInd	,			&#xd;&#xa;OdometerReading	,			&#xd;&#xa;WeeksPerMonthDriven	,			&#xd;&#xa;DaylightRunningLightsInd	,			&#xd;&#xa;PassiveSeatBeltInd	,			&#xd;&#xa;DaysPerWeekDriven	,			&#xd;&#xa;UMPDLimit	,			&#xd;&#xa;TowingAndLaborInd	,			&#xd;&#xa;RentalReimbursementInd	,			&#xd;&#xa;LiabilityWaiveInd	,			&#xd;&#xa;RateFeesInd	,			&#xd;&#xa;OptionalEquipmentValue	,			&#xd;&#xa;CustomizingEquipmentInd	,			&#xd;&#xa;CustomizingEquipmentDesc	,			&#xd;&#xa;InvalidVinAcknowledgementInd	,			&#xd;&#xa;IgnoreUMPDWCDInd	,			&#xd;&#xa;RecalculateRatingSymbolInd	,			&#xd;&#xa;ProgramTypeCd	,			&#xd;&#xa;CMPRatingValue	,			&#xd;&#xa;COLRatingValue	,			&#xd;&#xa;LiabilityRatingValue	,			&#xd;&#xa;MedPayRatingValue	,			&#xd;&#xa;RACMPRatingValue	,			&#xd;&#xa;RACOLRatingValue	,			&#xd;&#xa;RABIRatingSymbol	,			&#xd;&#xa;RAPDRatingSymbol	,			&#xd;&#xa;RAMedPayRatingSymbol	,			&#xd;&#xa;EstimatedAnnualDistanceOverride	,			&#xd;&#xa;OriginalEstimatedAnnualMiles	,			&#xd;&#xa;ReportedMileageNonSave	,			&#xd;&#xa;Mileage	,			&#xd;&#xa;EstimatedNonCommuteMiles	,			&#xd;&#xa;TitleHistoryIssue	,			&#xd;&#xa;OdometerProblems	,			&#xd;&#xa;Bundle	,			&#xd;&#xa;LoanLeaseGap	,			&#xd;&#xa;EquivalentReplacementCost	,			&#xd;&#xa;OriginalEquipmentManufacturer	,			&#xd;&#xa;OptionalRideshare	,			&#xd;&#xa;MedicalPartsAccessibility	,			&#xd;&#xa;VehNumber,				&#xd;&#xa;OdometerReadingPrior,				&#xd;&#xa;ReportedMileageNonSaveDtPrior,				&#xd;&#xa;FullGlassCovInd	,			&#xd;&#xa;LoadDate ,				&#xd;&#xa;audit_id ,				&#xd;&#xa;original_valid_fromdate,				&#xd;&#xa;original_valid_todate				&#xd;&#xa;&#x29;				&#xd;&#xa;select				&#xd;&#xa;-&#x23;max_vehicle_id.m - row_number&#x28;&#x29; over &#x28;order by vehicle_uniqueid,ChangeDate&#x29; vehicle_ID ,				&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_FROMDATE ,				&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_TODATE ,				&#xd;&#xa;-1 RECORD_VERSION	, 			&#xd;&#xa;Vehicle_UniqueId ,				&#xd;&#xa;p.pol_uniqueid Policy_Uniqueid ,				&#xd;&#xa;Policy_Id ,				&#xd;&#xa;SPInnVehicle_Id ,				&#xd;&#xa;Status ,				&#xd;&#xa;StateProvCd ,				&#xd;&#xa;County ,				&#xd;&#xa;PostalCode ,				&#xd;&#xa;City ,				&#xd;&#xa;Addr1 ,				&#xd;&#xa;Addr2 ,   				&#xd;&#xa;GaragAddrFlg ,				&#xd;&#xa;Manufacturer	,			&#xd;&#xa;Model	,			&#xd;&#xa;ModelYr	,			&#xd;&#xa;VehIdentificationNumber	,			&#xd;&#xa;ValidVinInd	,			&#xd;&#xa;VehLicenseNumber	,			&#xd;&#xa;RegistrationStateProvCd	,			&#xd;&#xa;VehBodyTypeCd	,			&#xd;&#xa;PerformanceCd	,			&#xd;&#xa;RestraintCd	,			&#xd;&#xa;AntiBrakingSystemCd	,			&#xd;&#xa;AntiTheftCd	,			&#xd;&#xa;EngineSize	,			&#xd;&#xa;EngineCylinders	,			&#xd;&#xa;EngineHorsePower	,			&#xd;&#xa;EngineType	,			&#xd;&#xa;VehUseCd	,			&#xd;&#xa;GarageTerritory	,			&#xd;&#xa;CollisionDed	,			&#xd;&#xa;ComprehensiveDed	,			&#xd;&#xa;StatedAmt	,			&#xd;&#xa;ClassCd	,			&#xd;&#xa;RatingValue	,			&#xd;&#xa;CostNewAmt	,			&#xd;&#xa;EstimatedAnnualDistance	,			&#xd;&#xa;EstimatedWorkDistance	,			&#xd;&#xa;LeasedVehInd	,			&#xd;&#xa;PurchaseDt	,			&#xd;&#xa;StatedAmtInd	,			&#xd;&#xa;NewOrUsedInd	,			&#xd;&#xa;CarPoolInd	,			&#xd;&#xa;OdometerReading	,			&#xd;&#xa;WeeksPerMonthDriven	,			&#xd;&#xa;DaylightRunningLightsInd	,			&#xd;&#xa;PassiveSeatBeltInd	,			&#xd;&#xa;DaysPerWeekDriven	,			&#xd;&#xa;UMPDLimit	,			&#xd;&#xa;TowingAndLaborInd	,			&#xd;&#xa;RentalReimbursementInd	,			&#xd;&#xa;LiabilityWaiveInd	,			&#xd;&#xa;RateFeesInd	,			&#xd;&#xa;OptionalEquipmentValue	,			&#xd;&#xa;CustomizingEquipmentInd	,			&#xd;&#xa;CustomizingEquipmentDesc	,			&#xd;&#xa;InvalidVinAcknowledgementInd	,			&#xd;&#xa;IgnoreUMPDWCDInd	,			&#xd;&#xa;RecalculateRatingSymbolInd	,			&#xd;&#xa;ProgramTypeCd	,			&#xd;&#xa;CMPRatingValue	,			&#xd;&#xa;COLRatingValue	,			&#xd;&#xa;LiabilityRatingValue	,			&#xd;&#xa;MedPayRatingValue	,			&#xd;&#xa;RACMPRatingValue	,			&#xd;&#xa;RACOLRatingValue	,			&#xd;&#xa;RABIRatingSymbol	,			&#xd;&#xa;RAPDRatingSymbol	,			&#xd;&#xa;RAMedPayRatingSymbol	,			&#xd;&#xa;EstimatedAnnualDistanceOverride	,			&#xd;&#xa;OriginalEstimatedAnnualMiles	,			&#xd;&#xa;ReportedMileageNonSave	,			&#xd;&#xa;Mileage	,			&#xd;&#xa;EstimatedNonCommuteMiles	,			&#xd;&#xa;TitleHistoryIssue	,			&#xd;&#xa;OdometerProblems	,			&#xd;&#xa;Bundle	,			&#xd;&#xa;LoanLeaseGap	,			&#xd;&#xa;EquivalentReplacementCost	,			&#xd;&#xa;OriginalEquipmentManufacturer	,			&#xd;&#xa;OptionalRideshare	,			&#xd;&#xa;MedicalPartsAccessibility	,			&#xd;&#xa;VehNumber,				&#xd;&#xa;OdometerReadingPrior,				&#xd;&#xa;ReportedMileageNonSaveDtPrior,				&#xd;&#xa;FullGlassCovInd	,			&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate	,			&#xd;&#xa;112 audit_id ,				&#xd;&#xa;ChangeDate original_valid_fromdate,				&#xd;&#xa;ChangeDate original_valid_todate				&#xd;&#xa;from  &#x23;stg_vehicle  stg 				&#xd;&#xa;join fsbi_dw_spinn.dbo.dim_policy p				&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid				&#xd;&#xa;join &#x23;max_vehicle_id on 1&#x3d;1				&#xd;&#xa;where Hist_Flg&#x3d;&#x27;Y&#x27;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;		&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;&#x2f;&#x2a;repeated intervals found for 2 vehicles 				&#xd;&#xa;156839_Vehicle-CAA0919915-WBABF4314NEK03290_WBABF4314NEK03290				&#xd;&#xa;814385_Vehicle-1486079097-1296568669_Unknown				&#xd;&#xa; due to duplicates in Vehicle and other tables - the same SystemId, cmmContainer, different values &#x2a;&#x2f;				&#xd;&#xa;&#x2f;&#x2a;run several times till 0 deleted and run adjusting record_version at the end&#x2a;&#x2f;				&#xd;&#xa;				&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;set audit_id&#x3d;113				&#xd;&#xa;where VEHICLE_id in &#x28;				&#xd;&#xa;select v.VEHICLE_id from fsbi_dw_spinn.dbo.DIM_VEHICLE v				&#xd;&#xa;join 				&#xd;&#xa;&#x28;select				&#xd;&#xa; VEHICLE_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;,min&#x28;record_version&#x29; record_version				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;where audit_id&#x3d;0				&#xd;&#xa;group by 				&#xd;&#xa;VEHICLE_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;having count&#x28;VEHICLE_id&#x29;&#x3e;1&#x29; d				&#xd;&#xa;on v.VEHICLE_uniqueid&#x3d;d.VEHICLE_uniqueid				&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate				&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate				&#xd;&#xa;and v.record_version&#x3d;d.record_version&#x29;				&#xd;&#xa;and audit_id&#x3d;0	&#x3b;			&#xd;&#xa;				&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;where VEHICLE_id in &#x28;				&#xd;&#xa;select v.VEHICLE_id from fsbi_dw_spinn.dbo.DIM_VEHICLE v				&#xd;&#xa;join 				&#xd;&#xa;&#x28;select				&#xd;&#xa; VEHICLE_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;,min&#x28;record_version&#x29; record_version				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;where audit_id&#x3d;0				&#xd;&#xa;group by 				&#xd;&#xa;VEHICLE_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;having count&#x28;VEHICLE_id&#x29;&#x3e;1&#x29; d				&#xd;&#xa;on v.VEHICLE_uniqueid&#x3d;d.VEHICLE_uniqueid				&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate				&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate				&#xd;&#xa;and v.record_version&#x3d;d.record_version&#x29;				&#xd;&#xa;and audit_id&#x3d;0	&#x3b;			&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;set audit_id&#x3d;114				&#xd;&#xa;where  vehicle_id in &#x28;select d2.vehicle_id 				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_VEHICLE d				&#xd;&#xa;join fsbi_dw_spinn.dbo.DIM_VEHICLE d2				&#xd;&#xa;on d.vehicle_uniqueid&#x3d;d2.vehicle_uniqueid				&#xd;&#xa;and d.valid_fromdate&#x3d;d2.valid_fromdate				&#xd;&#xa;and d2.valid_fromdate&#x3c;&#x3e;d2.valid_todate				&#xd;&#xa;where d.valid_fromdate&#x3d;d.valid_todate				&#xd;&#xa;and d.audit_id in &#x28;0,113&#x29;				&#xd;&#xa;and d2.audit_id in &#x28;0,113&#x29;&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_VEHICLE				&#xd;&#xa;where valid_fromdate&#x3d;valid_todate				&#xd;&#xa;and audit_id in &#x28;0,113&#x29;&#x3b;				</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>29</xloc>
      <yloc>540</yloc>
      </entry>
    <entry>
      <name>SQL DIM_DRIVER Historical Load</name>
      <description/>
      <type>SQL</type>
      <sql>&#x2f;&#x2a; Driver_Uniqueid 437917_PartyInfo-Driver-AZA0879373-B11111111_B11111111 				&#xd;&#xa; is a garbage record				&#xd;&#xa; prepearing stg_driver				&#xd;&#xa; &#x2a;&#x2f;				&#xd;&#xa;				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_driver1&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;stg_driver1&#x3b;				&#xd;&#xa;				&#xd;&#xa;select 				&#xd;&#xa;&#x2a;,				&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by driver_uniqueid order by ChangeDate &#x29; rn1,				&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by driver_uniqueid order by BookDt &#x29; rn2				&#xd;&#xa;into &#x23;stg_driver1				&#xd;&#xa;from &#x28;select distinct &#x2a; from fsbi_stg_spinn.dbo.stg_driver&#x29; data&#x3b;				&#xd;&#xa;				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_driver&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;stg_driver&#x3b;				&#xd;&#xa;				&#xd;&#xa;with mcd as &#x28;select driver_uniqueid, min&#x28;ChangeDate&#x29; ChangeDate				&#xd;&#xa;from &#x23;stg_driver1 data				&#xd;&#xa;where rn1&#x3c;&#x3e;rn2				&#xd;&#xa;group by driver_uniqueid&#x29; 				&#xd;&#xa;,mbd as &#x28;select distinct data.driver_uniqueid, data.BookDt				&#xd;&#xa;from &#x23;stg_driver1 data				&#xd;&#xa;join mcd				&#xd;&#xa;on  data.driver_uniqueid&#x3d;mcd.driver_uniqueid				&#xd;&#xa;and data.ChangeDate&#x3d;mcd.ChangeDate				&#xd;&#xa;where rn1&#x3c;&#x3e;rn2				&#xd;&#xa;&#x29;				&#xd;&#xa;select data.&#x2a;				&#xd;&#xa;,case when mbd.BookDt is null and data.rn1&#x3c;&#x3e;data.rn2 then &#x27;Y&#x27; else &#x27;N&#x27; end Hist_Flg				&#xd;&#xa;into &#x23;stg_driver				&#xd;&#xa;from &#x23;stg_driver1 data				&#xd;&#xa;left outer join mbd				&#xd;&#xa;on 				&#xd;&#xa;&#x28;data.driver_uniqueid&#x3d;mbd.driver_uniqueid				&#xd;&#xa;and data.BookDt&#x3e;&#x3d;mbd.BookDt&#x29;&#x3b; 				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa; 				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;tmp_stg_driver&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;tmp_stg_driver&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;SELECT   stg.driver_uniqueid				&#xd;&#xa;       , cast&#x28;stg.PolicyRef as varchar&#x29; Policy_Uniqueid				&#xd;&#xa;       , p.Policy_Id				&#xd;&#xa;       , SPInnDriver_Id SPInnDriver_ParentId				&#xd;&#xa;       , Status				&#xd;&#xa;       , driverinfocd				&#xd;&#xa;       , drivernumber				&#xd;&#xa;       , drivertypecd				&#xd;&#xa;       , driverstatuscd				&#xd;&#xa;       , licensenumber				&#xd;&#xa;       , licensedt				&#xd;&#xa;       , licensedstateprovcd				&#xd;&#xa;       , relationshiptoinsuredcd				&#xd;&#xa;       , scholasticdiscountind				&#xd;&#xa;       , mvrrequestind				&#xd;&#xa;	   , mvrstatusdt			&#xd;&#xa;       , mvrstatus				&#xd;&#xa;       , maturedriverind				&#xd;&#xa;       , drivertrainingind				&#xd;&#xa;       , gooddriverind				&#xd;&#xa;       , AccidentPreventionCourseCompletionDt				&#xd;&#xa;       , DriverTrainingCompletionDt				&#xd;&#xa;       , accidentpreventioncourseind				&#xd;&#xa;       , ScholasticCertificationDt				&#xd;&#xa;       , activemilitaryind 				&#xd;&#xa;       , permanentlicenseind				&#xd;&#xa;       , newtostateind				&#xd;&#xa;       , persontypecd				&#xd;&#xa;       , gendercd				&#xd;&#xa;       , birthdt				&#xd;&#xa;       , maritalstatuscd				&#xd;&#xa;       , occupationclasscd				&#xd;&#xa;       , positiontitle				&#xd;&#xa;       , currentresidencecd				&#xd;&#xa;       , civilservantind				&#xd;&#xa;       , retiredind 				&#xd;&#xa;       , newteenexpirationdt				&#xd;&#xa;       , AttachedVehicleRef				&#xd;&#xa;       , viol_pointschargedterm				&#xd;&#xa;       , acci_pointschargedterm				&#xd;&#xa;       , susp_pointschargedterm				&#xd;&#xa;       , other_pointschargedterm				&#xd;&#xa;       , changedate				&#xd;&#xa; into &#x23;tmp_stg_driver	   			&#xd;&#xa; FROM  &#x28;select distinct &#x2a; from &#x23;stg_driver where Hist_Flg&#x3d;&#x27;N&#x27;&#x29; stg join				&#xd;&#xa; fsbi_dw_spinn.dbo.dim_policy p				&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid&#x3b;				&#xd;&#xa;				&#xd;&#xa; --building DIM_DRIVER 				&#xd;&#xa; 				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;tmp_DIM_DRIVER&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;tmp_DIM_DRIVER&#x3b;				&#xd;&#xa;				&#xd;&#xa; 				&#xd;&#xa;select 				&#xd;&#xa;row_number&#x28;&#x29; over&#x28;ORDER BY  Driver_UniqueId,  changeDate&#x29; driver_id,				&#xd;&#xa;case 				&#xd;&#xa; when row_number&#x28;&#x29; OVER &#x28; PARTITION BY Driver_UniqueId  ORDER BY  changeDate &#x29;&#x3d;1 then				&#xd;&#xa;   cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;				&#xd;&#xa; else				&#xd;&#xa;  changeDate 				&#xd;&#xa;end VALID_FROMDATE,				&#xd;&#xa;isnull&#x28;lag&#x28;changeDate&#x29; OVER &#x28; PARTITION BY Driver_UniqueId  ORDER BY  changeDate&#x29;,cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;&#x29; VALID_TODATE ,				&#xd;&#xa;case				&#xd;&#xa;when 				&#xd;&#xa;        Status	 &#x3d;lag&#x28;	Status	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;	&#xd;&#xa;AND  	DriverInfoCd	 &#x3d;lag&#x28;	DriverInfoCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	DriverNumber	 &#x3d;lag&#x28;	DriverNumber	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	DriverTypeCd	 &#x3d;lag&#x28;	DriverTypeCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	DriverStatusCd	 &#x3d;lag&#x28;	DriverStatusCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	LicenseNumber	 &#x3d;lag&#x28;	LicenseNumber	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	LicenseDt	 &#x3d;lag&#x28;	LicenseDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	LicensedStateProvCd	 &#x3d;lag&#x28;	LicensedStateProvCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	RelationshipToInsuredCd	 &#x3d;lag&#x28;	RelationshipToInsuredCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	ScholasticDiscountInd	 &#x3d;lag&#x28;	ScholasticDiscountInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	MVRRequestInd	 &#x3d;lag&#x28;	MVRRequestInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	MVRStatusDt	 &#x3d;lag&#x28;	MVRStatusDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	MVRStatus	 &#x3d;lag&#x28;	MVRStatus	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	MatureDriverInd	 &#x3d;lag&#x28;	MatureDriverInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	DriverTrainingInd	 &#x3d;lag&#x28;	DriverTrainingInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	GoodDriverInd	 &#x3d;lag&#x28;	GoodDriverInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	AccidentPreventionCourseCompletionDt	 &#x3d;lag&#x28;	AccidentPreventionCourseCompletionDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	DriverTrainingCompletionDt	 &#x3d;lag&#x28;	DriverTrainingCompletionDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	AccidentPreventionCourseInd	 &#x3d;lag&#x28;	AccidentPreventionCourseInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	ScholasticCertificationDt	 &#x3d;lag&#x28;	ScholasticCertificationDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	ActiveMilitaryInd	 &#x3d;lag&#x28;	ActiveMilitaryInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	PermanentLicenseInd	 &#x3d;lag&#x28;	PermanentLicenseInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	NewToStateInd	 &#x3d;lag&#x28;	NewToStateInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	PersonTypeCd	 &#x3d;lag&#x28;	PersonTypeCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	GenderCd	 &#x3d;lag&#x28;	GenderCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	BirthDt	 &#x3d;lag&#x28;	BirthDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	MaritalStatusCd	 &#x3d;lag&#x28;	MaritalStatusCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	OccupationClassCd	 &#x3d;lag&#x28;	OccupationClassCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	PositionTitle	 &#x3d;lag&#x28;	PositionTitle	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	CurrentResidenceCd	 &#x3d;lag&#x28;	CurrentResidenceCd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	CivilServantInd	 &#x3d;lag&#x28;	CivilServantInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	RetiredInd	 &#x3d;lag&#x28;	RetiredInd	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND 	NewTeenExpirationDt&#x3d;lag&#x28;	NewTeenExpirationDt	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;	&#xd;&#xa;AND 	AttachedVehicleRef&#x3d;lag&#x28;	 AttachedVehicleRef	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;	&#xd;&#xa;--				&#xd;&#xa;AND  	VIOL_PointsChargedTerm	 &#x3d;lag&#x28; 	VIOL_PointsChargedTerm	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND  	ACCI_PointsChargedTerm	 &#x3d;lag&#x28; 	ACCI_PointsChargedTerm	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND  	SUSP_PointsChargedTerm	 &#x3d;lag&#x28; 	SUSP_PointsChargedTerm	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;AND  	Other_PointsChargedTerm	 &#x3d;lag&#x28; 	Other_PointsChargedTerm	&#x29; OVER &#x28; PARTITION BY  Driver_UniqueId  ORDER BY  changeDate&#x29;&#xd;&#xa;--				&#xd;&#xa;then				&#xd;&#xa;0				&#xd;&#xa;else				&#xd;&#xa;row_number&#x28;&#x29; OVER &#x28; PARTITION BY Driver_UniqueId  ORDER BY  changeDate&#x29; 				&#xd;&#xa;end RECORD_VERSION,				&#xd;&#xa;Driver_UniqueId	,			&#xd;&#xa;Policy_Uniqueid	,			&#xd;&#xa;Policy_Id 		,		&#xd;&#xa;SPInnDriver_ParentId ,				&#xd;&#xa;Status,				&#xd;&#xa;DriverInfoCd,				&#xd;&#xa;DriverNumber,				&#xd;&#xa;DriverTypeCd,				&#xd;&#xa;DriverStatusCd,				&#xd;&#xa;LicenseNumber,				&#xd;&#xa;LicenseDt,				&#xd;&#xa;LicensedStateProvCd,				&#xd;&#xa;RelationshipToInsuredCd,				&#xd;&#xa;ScholasticDiscountInd,				&#xd;&#xa;MVRRequestInd,				&#xd;&#xa;mvrstatusdt,				&#xd;&#xa;MVRStatus,				&#xd;&#xa;MatureDriverInd,				&#xd;&#xa;DriverTrainingInd,				&#xd;&#xa;GoodDriverInd,				&#xd;&#xa;AccidentPreventionCourseCompletionDt,				&#xd;&#xa;DriverTrainingCompletionDt,				&#xd;&#xa;AccidentPreventionCourseInd,				&#xd;&#xa;ScholasticCertificationDt,				&#xd;&#xa;ActiveMilitaryInd,				&#xd;&#xa;PermanentLicenseInd,				&#xd;&#xa;NewToStateInd,				&#xd;&#xa;PersonTypeCd,				&#xd;&#xa;GenderCd,				&#xd;&#xa;BirthDt,				&#xd;&#xa;MaritalStatusCd,				&#xd;&#xa;OccupationClassCd,				&#xd;&#xa;PositionTitle,				&#xd;&#xa;CurrentResidenceCd,				&#xd;&#xa;CivilServantInd,				&#xd;&#xa;RetiredInd,				&#xd;&#xa;NewTeenExpirationDt,				&#xd;&#xa;AttachedVehicleRef,				&#xd;&#xa;VIOL_PointsChargedTerm	,			&#xd;&#xa;ACCI_PointsChargedTerm	,			&#xd;&#xa;SUSP_PointsChargedTerm	,			&#xd;&#xa;Other_PointsChargedTerm				&#xd;&#xa;into &#x23;tmp_DIM_DRIVER				&#xd;&#xa;from &#x23;tmp_stg_driver				&#xd;&#xa;order by  Driver_UniqueId, changeDate&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;DELETE FROM fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;WHERE DRIVER_ID&#x3c;&#x3e;0&#x3b;				&#xd;&#xa;				&#xd;&#xa;INSERT INTO fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;&#x28;				&#xd;&#xa;DRIVER_ID	,			&#xd;&#xa;VALID_FROMDATE	,			&#xd;&#xa;VALID_TODATE	,			&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Driver_UniqueId	,			&#xd;&#xa;Policy_Uniqueid	,			&#xd;&#xa;Policy_Id	,			&#xd;&#xa;SPInnDriver_ParentId	,			&#xd;&#xa;Status	,			&#xd;&#xa;DriverInfoCd	,			&#xd;&#xa;DriverNumber	,			&#xd;&#xa;DriverTypeCd	,			&#xd;&#xa;DriverStatusCd	,			&#xd;&#xa;LicenseNumber	,			&#xd;&#xa;LicenseDt	,			&#xd;&#xa;LicensedStateProvCd	,			&#xd;&#xa;RelationshipToInsuredCd	,			&#xd;&#xa;ScholasticDiscountInd	,			&#xd;&#xa;MVRRequestInd	,			&#xd;&#xa;mvrstatusdt	,			&#xd;&#xa;MVRStatus	,			&#xd;&#xa;MatureDriverInd	,			&#xd;&#xa;DriverTrainingInd	,			&#xd;&#xa;GoodDriverInd	,			&#xd;&#xa;AccidentPreventionCourseCompletionDt	,			&#xd;&#xa;DriverTrainingCompletionDt	,			&#xd;&#xa;AccidentPreventionCourseInd	,			&#xd;&#xa;ScholasticCertificationDt	,			&#xd;&#xa;ActiveMilitaryInd	,			&#xd;&#xa;PermanentLicenseInd	,			&#xd;&#xa;NewToStateInd	,			&#xd;&#xa;PersonTypeCd	,			&#xd;&#xa;GenderCd	,			&#xd;&#xa;BirthDt	,			&#xd;&#xa;MaritalStatusCd	,			&#xd;&#xa;OccupationClassCd	,			&#xd;&#xa;PositionTitle	,			&#xd;&#xa;CurrentResidenceCd	,			&#xd;&#xa;CivilServantInd	,			&#xd;&#xa;RetiredInd	,			&#xd;&#xa;NewTeenExpirationDt	,			&#xd;&#xa;AttachedVehicleRef	,			&#xd;&#xa;VIOL_PointsChargedTerm	,			&#xd;&#xa;ACCI_PointsChargedTerm	,			&#xd;&#xa;SUSP_PointsChargedTerm	,			&#xd;&#xa;Other_PointsChargedTerm	,			&#xd;&#xa;LoadDate				&#xd;&#xa;&#x29;				&#xd;&#xa;select				&#xd;&#xa; DRIVER_ID ,				&#xd;&#xa; VALID_FROMDATE ,				&#xd;&#xa; isnull&#x28;lead&#x28;VALID_FROMDATE&#x29; OVER &#x28; PARTITION BY Driver_UniqueId  ORDER BY record_version &#x29;,&#x27;3000-01-01&#x27;&#x29;   VALID_TODATE ,				&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Driver_UniqueId	,			&#xd;&#xa;Policy_Uniqueid	,			&#xd;&#xa;Policy_Id 		,		&#xd;&#xa;SPInnDriver_ParentId ,				&#xd;&#xa;Status,				&#xd;&#xa;DriverInfoCd,				&#xd;&#xa;DriverNumber,				&#xd;&#xa;DriverTypeCd,				&#xd;&#xa;DriverStatusCd,				&#xd;&#xa;LicenseNumber,				&#xd;&#xa;LicenseDt,				&#xd;&#xa;LicensedStateProvCd,				&#xd;&#xa;RelationshipToInsuredCd,				&#xd;&#xa;ScholasticDiscountInd,				&#xd;&#xa;MVRRequestInd,				&#xd;&#xa;mvrstatusdt,				&#xd;&#xa;MVRStatus,				&#xd;&#xa;MatureDriverInd,				&#xd;&#xa;DriverTrainingInd,				&#xd;&#xa;GoodDriverInd,				&#xd;&#xa;AccidentPreventionCourseCompletionDt,				&#xd;&#xa;DriverTrainingCompletionDt,				&#xd;&#xa;AccidentPreventionCourseInd,				&#xd;&#xa;ScholasticCertificationDt,				&#xd;&#xa;ActiveMilitaryInd,				&#xd;&#xa;PermanentLicenseInd,				&#xd;&#xa;NewToStateInd,				&#xd;&#xa;PersonTypeCd,				&#xd;&#xa;GenderCd,				&#xd;&#xa;BirthDt,				&#xd;&#xa;MaritalStatusCd,				&#xd;&#xa;OccupationClassCd,				&#xd;&#xa;PositionTitle,				&#xd;&#xa;CurrentResidenceCd,				&#xd;&#xa;CivilServantInd,				&#xd;&#xa;RetiredInd,				&#xd;&#xa;NewTeenExpirationDt,				&#xd;&#xa;AttachedVehicleRef,				&#xd;&#xa;VIOL_PointsChargedTerm	,			&#xd;&#xa;ACCI_PointsChargedTerm	,			&#xd;&#xa;SUSP_PointsChargedTerm	,			&#xd;&#xa;Other_PointsChargedTerm	,			&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate				&#xd;&#xa;from &#x23;tmp_DIM_DRIVER				&#xd;&#xa;where record_version&#x3c;&#x3e;0				&#xd;&#xa;and driver_uniqueid not like &#x27;&#x25;B11111111_B11111111&#x25;&#x27;				&#xd;&#xa;ORDER BY Driver_UniqueId, record_version&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa; --adjusting ValidTo for the last driver record				&#xd;&#xa;update				&#xd;&#xa;    fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;set				&#xd;&#xa;    DIM_DRIVER.VALID_TODATE &#x3d; cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;				&#xd;&#xa;from				&#xd;&#xa;    &#x28;				&#xd;&#xa;select DRIVER_UniqueID				&#xd;&#xa;,max&#x28;Record_Version&#x29; r				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;group by DRIVER_UniqueID				&#xd;&#xa;&#x29; d				&#xd;&#xa;join				&#xd;&#xa;fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;on  DIM_DRIVER.DRIVER_UniqueID&#x3d;d.DRIVER_UniqueID				&#xd;&#xa;and DIM_DRIVER.RECORD_VERSION&#x3d;d.r				&#xd;&#xa;and DIM_DRIVER.VALID_TODATE&#x3c;cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa; --adjusting ValidFrom for the first driver record				&#xd;&#xa;update				&#xd;&#xa;    fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;set				&#xd;&#xa;    DIM_DRIVER.VALID_FROMDATE &#x3d; cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;				&#xd;&#xa;from				&#xd;&#xa;    &#x28;				&#xd;&#xa;select DRIVER_UniqueID				&#xd;&#xa;,min&#x28;Record_Version&#x29; r				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;group by DRIVER_UniqueID				&#xd;&#xa;&#x29; d				&#xd;&#xa;join				&#xd;&#xa;fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;on  DIM_DRIVER.DRIVER_UniqueID&#x3d;d.DRIVER_UniqueID				&#xd;&#xa;and DIM_DRIVER.RECORD_VERSION&#x3d;d.r				&#xd;&#xa;and DIM_DRIVER.VALID_TODATE&#x3e;cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --adjusting record_version				&#xd;&#xa;with data as &#x28;select driver_id, row_number&#x28;&#x29; over&#x28;partition by driver_uniqueid order by valid_fromdate, valid_todate&#x29; rn				&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_driver d				&#xd;&#xa;where audit_id&#x3d;0&#x29;				&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_driver				&#xd;&#xa;set record_version&#x3d;data.rn				&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_driver v				&#xd;&#xa;join data on v.driver_id&#x3d;data.driver_id				&#xd;&#xa;where audit_id&#x3d;0&#x3b;				&#xd;&#xa;				&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;max_driver_id&#x27;&#x29; IS NOT NULL				&#xd;&#xa;drop table &#x23;max_driver_id&#x3b;				&#xd;&#xa;				&#xd;&#xa;select max&#x28;driver_id&#x29; m into &#x23;max_driver_id from fsbi_dw_spinn.dbo.dim_driver&#x3b;				&#xd;&#xa;				&#xd;&#xa;  --Historical records				&#xd;&#xa;INSERT INTO fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;&#x28;				&#xd;&#xa;DRIVER_ID	,			&#xd;&#xa;VALID_FROMDATE	,			&#xd;&#xa;VALID_TODATE	,			&#xd;&#xa;RECORD_VERSION	,			&#xd;&#xa;Driver_UniqueId	,			&#xd;&#xa;Policy_Uniqueid	,			&#xd;&#xa;Policy_Id	,			&#xd;&#xa;SPInnDriver_ParentId	,			&#xd;&#xa;Status	,			&#xd;&#xa;DriverInfoCd	,			&#xd;&#xa;DriverNumber	,			&#xd;&#xa;DriverTypeCd	,			&#xd;&#xa;DriverStatusCd	,			&#xd;&#xa;LicenseNumber	,			&#xd;&#xa;LicenseDt	,			&#xd;&#xa;LicensedStateProvCd	,			&#xd;&#xa;RelationshipToInsuredCd	,			&#xd;&#xa;ScholasticDiscountInd	,			&#xd;&#xa;MVRRequestInd	,			&#xd;&#xa;mvrstatusdt	,			&#xd;&#xa;MVRStatus	,			&#xd;&#xa;MatureDriverInd	,			&#xd;&#xa;DriverTrainingInd	,			&#xd;&#xa;GoodDriverInd	,			&#xd;&#xa;AccidentPreventionCourseCompletionDt	,			&#xd;&#xa;DriverTrainingCompletionDt	,			&#xd;&#xa;AccidentPreventionCourseInd	,			&#xd;&#xa;ScholasticCertificationDt	,			&#xd;&#xa;ActiveMilitaryInd	,			&#xd;&#xa;PermanentLicenseInd	,			&#xd;&#xa;NewToStateInd	,			&#xd;&#xa;PersonTypeCd	,			&#xd;&#xa;GenderCd	,			&#xd;&#xa;BirthDt	,			&#xd;&#xa;MaritalStatusCd	,			&#xd;&#xa;OccupationClassCd	,			&#xd;&#xa;PositionTitle	,			&#xd;&#xa;CurrentResidenceCd	,			&#xd;&#xa;CivilServantInd	,			&#xd;&#xa;RetiredInd	,			&#xd;&#xa;NewTeenExpirationDt	,			&#xd;&#xa;AttachedVehicleRef	,			&#xd;&#xa;VIOL_PointsChargedTerm	,			&#xd;&#xa;ACCI_PointsChargedTerm	,			&#xd;&#xa;SUSP_PointsChargedTerm	,			&#xd;&#xa;Other_PointsChargedTerm	,			&#xd;&#xa;LoadDate		,		&#xd;&#xa;audit_id ,				&#xd;&#xa;original_valid_fromdate,				&#xd;&#xa;original_valid_todate				&#xd;&#xa;&#x29;				&#xd;&#xa;select				&#xd;&#xa; -&#x23;max_driver_id.m - row_number&#x28;&#x29; over &#x28;order by driver_uniqueid,ChangeDate&#x29; DRIVER_ID ,				&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_FROMDATE ,				&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_TODATE ,				&#xd;&#xa;-1 RECORD_VERSION	, 			&#xd;&#xa;Driver_UniqueId	,			&#xd;&#xa;pol_uniqueid Policy_Uniqueid	,			&#xd;&#xa;Policy_Id 		,		&#xd;&#xa;SPInnDriver_Id SPInnDriver_ParentId ,				&#xd;&#xa;Status,				&#xd;&#xa;DriverInfoCd,				&#xd;&#xa;DriverNumber,				&#xd;&#xa;DriverTypeCd,				&#xd;&#xa;DriverStatusCd,				&#xd;&#xa;LicenseNumber,				&#xd;&#xa;LicenseDt,				&#xd;&#xa;LicensedStateProvCd,				&#xd;&#xa;RelationshipToInsuredCd,				&#xd;&#xa;ScholasticDiscountInd,				&#xd;&#xa;MVRRequestInd,				&#xd;&#xa;mvrstatusdt,				&#xd;&#xa;MVRStatus,				&#xd;&#xa;MatureDriverInd,				&#xd;&#xa;DriverTrainingInd,				&#xd;&#xa;GoodDriverInd,				&#xd;&#xa;AccidentPreventionCourseCompletionDt,				&#xd;&#xa;DriverTrainingCompletionDt,				&#xd;&#xa;AccidentPreventionCourseInd,				&#xd;&#xa;ScholasticCertificationDt,				&#xd;&#xa;ActiveMilitaryInd,				&#xd;&#xa;PermanentLicenseInd,				&#xd;&#xa;NewToStateInd,				&#xd;&#xa;PersonTypeCd,				&#xd;&#xa;GenderCd,				&#xd;&#xa;BirthDt,				&#xd;&#xa;MaritalStatusCd,				&#xd;&#xa;OccupationClassCd,				&#xd;&#xa;PositionTitle,				&#xd;&#xa;CurrentResidenceCd,				&#xd;&#xa;CivilServantInd,				&#xd;&#xa;RetiredInd,				&#xd;&#xa;NewTeenExpirationDt,				&#xd;&#xa;AttachedVehicleRef,				&#xd;&#xa;VIOL_PointsChargedTerm	,			&#xd;&#xa;ACCI_PointsChargedTerm	,			&#xd;&#xa;SUSP_PointsChargedTerm	,			&#xd;&#xa;Other_PointsChargedTerm	,			&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate	,			&#xd;&#xa;112 audit_id ,				&#xd;&#xa;ChangeDate original_valid_fromdate,				&#xd;&#xa;ChangeDate original_valid_todate				&#xd;&#xa;from  &#x23;stg_driver  stg 				&#xd;&#xa;join fsbi_dw_spinn.dbo.dim_policy p				&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid				&#xd;&#xa;join &#x23;max_driver_id on 1&#x3d;1				&#xd;&#xa;where Hist_Flg&#x3d;&#x27;Y&#x27;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;							&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;&#x2f;&#x2a;repeated intervals found for EXCLUDED drivers				&#xd;&#xa;looks like Driver Parent Id is not unique for EXCLUDED &#x2a;&#x2f;				&#xd;&#xa;&#x2f;&#x2a;mix of different drivers for 375357_PartyInfo-Driver-AZA0804262-T194182_T194182 &#x2a;&#x2f;				&#xd;&#xa;&#x2f;&#x2a;mess in DriverInfo records for 845435_DTOPartyInfo-1244166227-653506350_A1426347 &#x2a;&#x2f;				&#xd;&#xa;&#x2f;&#x2a;run several times till 0 deleted and run adjusting record_version at the end&#x2a;&#x2f;				&#xd;&#xa;				&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;set audit_id&#x3d;113				&#xd;&#xa;where DRIVER_id in &#x28;				&#xd;&#xa;select v.DRIVER_id from fsbi_dw_spinn.dbo.DIM_DRIVER v				&#xd;&#xa;join 				&#xd;&#xa;&#x28;select				&#xd;&#xa; driver_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;,min&#x28;record_version&#x29; record_version				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;where audit_id&#x3d;0				&#xd;&#xa;group by 				&#xd;&#xa;driver_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;having count&#x28;DRIVER_id&#x29;&#x3e;1&#x29; d				&#xd;&#xa;on v.driver_uniqueid&#x3d;d.driver_uniqueid				&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate				&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate				&#xd;&#xa;and v.record_version&#x3d;d.record_version&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;where DRIVER_id in &#x28;				&#xd;&#xa;select v.DRIVER_id from fsbi_dw_spinn.dbo.DIM_DRIVER v				&#xd;&#xa;join 				&#xd;&#xa;&#x28;select				&#xd;&#xa; driver_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;,min&#x28;record_version&#x29; record_version				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;where audit_id&#x3d;0				&#xd;&#xa;group by 				&#xd;&#xa;driver_uniqueid				&#xd;&#xa;,valid_fromdate				&#xd;&#xa;,valid_todate				&#xd;&#xa;having count&#x28;DRIVER_id&#x29;&#x3e;1&#x29; d				&#xd;&#xa;on v.driver_uniqueid&#x3d;d.driver_uniqueid				&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate				&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate				&#xd;&#xa;and v.record_version&#x3d;d.record_version&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;with temp&#x28;rank1,driver_uniqueid,original_valid_fromdate &#x29;				&#xd;&#xa;as &#x28;				&#xd;&#xa;   select row_number&#x28;&#x29; over &#x28; partition by driver_uniqueid,original_valid_fromdate order by driver_uniqueid,original_valid_fromdate &#x29; rank1,				&#xd;&#xa;   driver_uniqueid,				&#xd;&#xa;   original_valid_fromdate 				&#xd;&#xa;   from fsbi_dw_spinn.dbo.DIM_driver				&#xd;&#xa;   where audit_id&#x3d;112				&#xd;&#xa;&#x29;				&#xd;&#xa;delete from temp where rank1 &#x3e; 1&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;set audit_id&#x3d;114				&#xd;&#xa;where  DRIVER_id in &#x28;select d2.DRIVER_id 				&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_DRIVER d				&#xd;&#xa;join fsbi_dw_spinn.dbo.DIM_DRIVER d2				&#xd;&#xa;on d.DRIVER_uniqueid&#x3d;d2.DRIVER_uniqueid				&#xd;&#xa;and d.valid_fromdate&#x3d;d2.valid_fromdate				&#xd;&#xa;and d2.valid_fromdate&#x3c;&#x3e;d2.valid_todate				&#xd;&#xa;where d.valid_fromdate&#x3d;d.valid_todate				&#xd;&#xa;and d.audit_id in &#x28;0,113&#x29;				&#xd;&#xa;and d2.audit_id in &#x28;0,113&#x29;&#x29;&#x3b;				&#xd;&#xa;				&#xd;&#xa;				&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_DRIVER				&#xd;&#xa;where valid_fromdate&#x3d;valid_todate				&#xd;&#xa;and audit_id in &#x28;0,113&#x29;&#x3b;				&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>187</xloc>
      <yloc>581</yloc>
      </entry>
    <entry>
      <name>SQL DIM_BUILDING Historical Load</name>
      <description/>
      <type>SQL</type>
      <sql>  --adjusting stg_building		&#xd;&#xa;  		&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_building1&#x27;&#x29; IS NOT NULL		&#xd;&#xa;drop table &#x23;stg_building1&#x3b;		&#xd;&#xa;		&#xd;&#xa;select 		&#xd;&#xa;&#x2a;,		&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by building_uniqueid order by ChangeDate &#x29; rn1,		&#xd;&#xa;row_number&#x28;&#x29; over&#x28;partition by building_uniqueid order by BookDt &#x29; rn2		&#xd;&#xa;into &#x23;stg_building1		&#xd;&#xa;from &#x28;select distinct &#x2a; from fsbi_stg_spinn.dbo.stg_building&#x29; data&#x3b;		&#xd;&#xa;		&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;stg_building&#x27;&#x29; IS NOT NULL		&#xd;&#xa;drop table &#x23;stg_building&#x3b;		&#xd;&#xa;		&#xd;&#xa;with mcd as &#x28;select building_uniqueid, min&#x28;ChangeDate&#x29; ChangeDate		&#xd;&#xa;from &#x23;stg_building1 data		&#xd;&#xa;where rn1&#x3c;&#x3e;rn2		&#xd;&#xa;group by building_uniqueid&#x29; 		&#xd;&#xa;,mbd as &#x28;select distinct data.building_uniqueid, data.BookDt		&#xd;&#xa;from &#x23;stg_building1 data		&#xd;&#xa;join mcd		&#xd;&#xa;on  data.building_uniqueid&#x3d;mcd.building_uniqueid		&#xd;&#xa;and data.ChangeDate&#x3d;mcd.ChangeDate		&#xd;&#xa;where rn1&#x3c;&#x3e;rn2		&#xd;&#xa;&#x29;		&#xd;&#xa;select data.&#x2a;		&#xd;&#xa;,case when mbd.BookDt is null and data.rn1&#x3c;&#x3e;data.rn2 then &#x27;Y&#x27; else &#x27;N&#x27; end Hist_Flg		&#xd;&#xa;into &#x23;stg_building		&#xd;&#xa;from &#x23;stg_building1 data		&#xd;&#xa;left outer join mbd		&#xd;&#xa;on 		&#xd;&#xa;&#x28;data.building_uniqueid&#x3d;mbd.building_uniqueid		&#xd;&#xa;and data.BookDt&#x3e;&#x3d;mbd.BookDt&#x29;&#x3b; 		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;DIM_BUILDING&#x27;&#x29; IS NOT NULL		&#xd;&#xa;drop table &#x23;DIM_BUILDING&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;SELECT 		&#xd;&#xa;    row_number&#x28;&#x29; over&#x28;ORDER BY  Building_UniqueId, changeDate&#x29; Building_id,		&#xd;&#xa;    case 		&#xd;&#xa;     when row_number&#x28;&#x29; OVER &#x28; PARTITION BY Building_UniqueId  ORDER BY  changeDate &#x29;&#x3d;1 then		&#xd;&#xa;      cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;		&#xd;&#xa;     else		&#xd;&#xa;      changeDate 		&#xd;&#xa;     end VALID_FROMDATE,		&#xd;&#xa;       isnull&#x28;lead&#x28;changeDate&#x29; OVER &#x28; PARTITION BY Building_UniqueId  ORDER BY  changeDate &#x29;,cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;&#x29; VALID_TODATE ,		&#xd;&#xa;	   CASE	&#xd;&#xa;	   --if nothing change - delete the row for SCD	&#xd;&#xa;	   WHEN 	&#xd;&#xa;    SPInnBuilding_Id &#x3d; lag&#x28; SPInnBuilding_Id &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Status &#x3d; lag&#x28; Status &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Building_NaturalKey &#x3d; lag&#x28; Building_NaturalKey &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BldgNumber &#x3d; lag&#x28; BldgNumber &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BusinessCategory &#x3d; lag&#x28; BusinessCategory &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BusinessClass &#x3d; lag&#x28; BusinessClass &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ConstructionCd &#x3d; lag&#x28; ConstructionCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RoofCd &#x3d; lag&#x28; RoofCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND YearBuilt &#x3d; lag&#x28; YearBuilt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SqFt &#x3d; lag&#x28; SqFt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Stories &#x3d; lag&#x28; Stories &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Units &#x3d; lag&#x28; Units &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OccupancyCd &#x3d; lag&#x28; OccupancyCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ProtectionClass &#x3d; lag&#x28; ProtectionClass &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TerritoryCd &#x3d; lag&#x28; TerritoryCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BuildingLimit &#x3d; lag&#x28; BuildingLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ContentsLimit &#x3d; lag&#x28; ContentsLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ValuationMethod &#x3d; lag&#x28; ValuationMethod &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND InflationGuardPct &#x3d; lag&#x28; InflationGuardPct &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OrdinanceOrLawInd &#x3d; lag&#x28; OrdinanceOrLawInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ScheduledPremiumMod &#x3d; lag&#x28; ScheduledPremiumMod &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WindHailExclusion &#x3d; lag&#x28; WindHailExclusion &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovALimit &#x3d; lag&#x28; CovALimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovBLimit &#x3d; lag&#x28; CovBLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovCLimit &#x3d; lag&#x28; CovCLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovDLimit &#x3d; lag&#x28; CovDLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovELimit &#x3d; lag&#x28; CovELimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovFLimit &#x3d; lag&#x28; CovFLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AllPerilDed &#x3d; lag&#x28; AllPerilDed &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BurglaryAlarmType &#x3d; lag&#x28; BurglaryAlarmType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FireAlarmType &#x3d; lag&#x28; FireAlarmType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovBLimitIncluded &#x3d; lag&#x28; CovBLimitIncluded &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovBLimitIncrease &#x3d; lag&#x28; CovBLimitIncrease &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovCLimitIncluded &#x3d; lag&#x28; CovCLimitIncluded &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovCLimitIncrease &#x3d; lag&#x28; CovCLimitIncrease &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovDLimitIncluded &#x3d; lag&#x28; CovDLimitIncluded &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovDLimitIncrease &#x3d; lag&#x28; CovDLimitIncrease &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OrdinanceOrLawPct &#x3d; lag&#x28; OrdinanceOrLawPct &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NeighborhoodCrimeWatchInd &#x3d; lag&#x28; NeighborhoodCrimeWatchInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EmployeeCreditInd &#x3d; lag&#x28; EmployeeCreditInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MultiPolicyInd &#x3d; lag&#x28; MultiPolicyInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HomeWarrantyCreditInd &#x3d; lag&#x28; HomeWarrantyCreditInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND YearOccupied &#x3d; lag&#x28; YearOccupied &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND YearPurchased &#x3d; lag&#x28; YearPurchased &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TypeOfStructure &#x3d; lag&#x28; TypeOfStructure &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FeetToFireHydrant &#x3d; lag&#x28; FeetToFireHydrant &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NumberOfFamilies &#x3d; lag&#x28; NumberOfFamilies &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MilesFromFireStation &#x3d; lag&#x28; MilesFromFireStation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Rooms &#x3d; lag&#x28; Rooms &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RoofPitch &#x3d; lag&#x28; RoofPitch &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FireDistrict &#x3d; lag&#x28; FireDistrict &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SprinklerSystem &#x3d; lag&#x28; SprinklerSystem &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FireExtinguisherInd &#x3d; lag&#x28; FireExtinguisherInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND KitchenFireExtinguisherInd &#x3d; lag&#x28; KitchenFireExtinguisherInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND DeadboltInd &#x3d; lag&#x28; DeadboltInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND GatedCommunityInd &#x3d; lag&#x28; GatedCommunityInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CentralHeatingInd &#x3d; lag&#x28; CentralHeatingInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Foundation &#x3d; lag&#x28; Foundation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WiringRenovation &#x3d; lag&#x28; WiringRenovation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WiringRenovationCompleteYear &#x3d; lag&#x28; WiringRenovationCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PlumbingRenovation &#x3d; lag&#x28; PlumbingRenovation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HeatingRenovation &#x3d; lag&#x28; HeatingRenovation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PlumbingRenovationCompleteYear &#x3d; lag&#x28; PlumbingRenovationCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ExteriorPaintRenovation &#x3d; lag&#x28; ExteriorPaintRenovation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HeatingRenovationCompleteYear &#x3d; lag&#x28; HeatingRenovationCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CircuitBreakersInd &#x3d; lag&#x28; CircuitBreakersInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CopperWiringInd &#x3d; lag&#x28; CopperWiringInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ExteriorPaintRenovationCompleteYear &#x3d; lag&#x28; ExteriorPaintRenovationCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CopperPipesInd &#x3d; lag&#x28; CopperPipesInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EarthquakeRetrofitInd &#x3d; lag&#x28; EarthquakeRetrofitInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PrimaryFuelSource &#x3d; lag&#x28; PrimaryFuelSource &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SecondaryFuelSource &#x3d; lag&#x28; SecondaryFuelSource &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND UsageType &#x3d; lag&#x28; UsageType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HomegardCreditInd &#x3d; lag&#x28; HomegardCreditInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MultiPolicyNumber &#x3d; lag&#x28; MultiPolicyNumber &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LocalFireAlarmInd &#x3d; lag&#x28; LocalFireAlarmInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NumLosses &#x3d; lag&#x28; NumLosses &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovALimitIncrease &#x3d; lag&#x28; CovALimitIncrease &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovALimitIncluded &#x3d; lag&#x28; CovALimitIncluded &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MonthsRentedOut &#x3d; lag&#x28; MonthsRentedOut &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RoofReplacement &#x3d; lag&#x28; RoofReplacement &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SafeguardPlusInd &#x3d; lag&#x28; SafeguardPlusInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovELimitIncluded &#x3d; lag&#x28; CovELimitIncluded &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RoofReplacementCompleteYear &#x3d; lag&#x28; RoofReplacementCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CovELimitIncrease &#x3d; lag&#x28; CovELimitIncrease &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OwnerOccupiedUnits &#x3d; lag&#x28; OwnerOccupiedUnits &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TenantOccupiedUnits &#x3d; lag&#x28; TenantOccupiedUnits &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReplacementCostDwellingInd &#x3d; lag&#x28; ReplacementCostDwellingInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FeetToPropertyLine &#x3d; lag&#x28; FeetToPropertyLine &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND GalvanizedPipeInd &#x3d; lag&#x28; GalvanizedPipeInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WorkersCompInservant &#x3d; lag&#x28; WorkersCompInservant &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WorkersCompOutservant &#x3d; lag&#x28; WorkersCompOutservant &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LiabilityTerritoryCd &#x3d; lag&#x28; LiabilityTerritoryCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PremisesLiabilityMedPayInd &#x3d; lag&#x28; PremisesLiabilityMedPayInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RelatedPrivateStructureExclusion &#x3d; lag&#x28; RelatedPrivateStructureExclusion &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND VandalismExclusion &#x3d; lag&#x28; VandalismExclusion &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND VandalismInd &#x3d; lag&#x28; VandalismInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RoofExclusion &#x3d; lag&#x28; RoofExclusion &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ExpandedReplacementCostInd &#x3d; lag&#x28; ExpandedReplacementCostInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReplacementValueInd &#x3d; lag&#x28; ReplacementValueInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherPolicyNumber1 &#x3d; lag&#x28; OtherPolicyNumber1 &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherPolicyNumber2 &#x3d; lag&#x28; OtherPolicyNumber2 &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherPolicyNumber3 &#x3d; lag&#x28; OtherPolicyNumber3 &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PrimaryPolicyNumber &#x3d; lag&#x28; PrimaryPolicyNumber &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherPolicyNumbers &#x3d; lag&#x28; OtherPolicyNumbers &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReportedFireHazardScore &#x3d; lag&#x28; ReportedFireHazardScore &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FireHazardScore &#x3d; lag&#x28; FireHazardScore &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReportedSteepSlopeInd &#x3d; lag&#x28; ReportedSteepSlopeInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SteepSlopeInd &#x3d; lag&#x28; SteepSlopeInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReportedHomeReplacementCost &#x3d; lag&#x28; ReportedHomeReplacementCost &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReportedProtectionClass &#x3d; lag&#x28; ReportedProtectionClass &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EarthquakeZone &#x3d; lag&#x28; EarthquakeZone &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MMIScore &#x3d; lag&#x28; MMIScore &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HomeInspectionDiscountInd &#x3d; lag&#x28; HomeInspectionDiscountInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RatingTier &#x3d; lag&#x28; RatingTier &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SoilTypeCd &#x3d; lag&#x28; SoilTypeCd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ReportedFireLineAssessment &#x3d; lag&#x28; ReportedFireLineAssessment &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AAISFireProtectionClass &#x3d; lag&#x28; AAISFireProtectionClass &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND InspectionScore &#x3d; lag&#x28; InspectionScore &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AnnualRents &#x3d; lag&#x28; AnnualRents &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PitchOfRoof &#x3d; lag&#x28; PitchOfRoof &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TotalLivingSqFt &#x3d; lag&#x28; TotalLivingSqFt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ParkingSqFt &#x3d; lag&#x28; ParkingSqFt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ParkingType &#x3d; lag&#x28; ParkingType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RetrofitCompleted &#x3d; lag&#x28; RetrofitCompleted &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NumPools &#x3d; lag&#x28; NumPools &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FullyFenced &#x3d; lag&#x28; FullyFenced &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND DivingBoard &#x3d; lag&#x28; DivingBoard &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND Gym &#x3d; lag&#x28; Gym &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FreeWeights &#x3d; lag&#x28; FreeWeights &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WireFencing &#x3d; lag&#x28; WireFencing &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherRecreational &#x3d; lag&#x28; OtherRecreational &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherRecreationalDesc &#x3d; lag&#x28; OtherRecreationalDesc &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HealthInspection &#x3d; lag&#x28; HealthInspection &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HealthInspectionDt &#x3d; lag&#x28; HealthInspectionDt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HealthInspectionCited &#x3d; lag&#x28; HealthInspectionCited &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PriorDefectRepairs &#x3d; lag&#x28; PriorDefectRepairs &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MSBReconstructionEstimate &#x3d; lag&#x28; MSBReconstructionEstimate &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BIIndemnityPeriod &#x3d; lag&#x28; BIIndemnityPeriod &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EquipmentBreakdown &#x3d; lag&#x28; EquipmentBreakdown &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MoneySecurityOnPremises &#x3d; lag&#x28; MoneySecurityOnPremises &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MoneySecurityOffPremises &#x3d; lag&#x28; MoneySecurityOffPremises &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WaterBackupSump &#x3d; lag&#x28; WaterBackupSump &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SprinkleredBuildings &#x3d; lag&#x28; SprinkleredBuildings &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SurveillanceCams &#x3d; lag&#x28; SurveillanceCams &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND GatedComplexKeyAccess &#x3d; lag&#x28; GatedComplexKeyAccess &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EQRetrofit &#x3d; lag&#x28; EQRetrofit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND UnitsPerBuilding &#x3d; lag&#x28; UnitsPerBuilding &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NumStories &#x3d; lag&#x28; NumStories &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ConstructionQuality &#x3d; lag&#x28; ConstructionQuality &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BurglaryRobbery &#x3d; lag&#x28; BurglaryRobbery &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NFPAClassification &#x3d; lag&#x28; NFPAClassification &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AreasOfCoverage &#x3d; lag&#x28; AreasOfCoverage &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CODetector &#x3d; lag&#x28; CODetector &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SmokeDetector &#x3d; lag&#x28; SmokeDetector &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SmokeDetectorInspectInd &#x3d; lag&#x28; SmokeDetectorInspectInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WaterHeaterSecured &#x3d; lag&#x28; WaterHeaterSecured &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BoltedOrSecured &#x3d; lag&#x28; BoltedOrSecured &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SoftStoryCripple &#x3d; lag&#x28; SoftStoryCripple &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SeniorHousingPct &#x3d; lag&#x28; SeniorHousingPct &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND DesignatedSeniorHousing &#x3d; lag&#x28; DesignatedSeniorHousing &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND StudentHousingPct &#x3d; lag&#x28; StudentHousingPct &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND DesignatedStudentHousing &#x3d; lag&#x28; DesignatedStudentHousing &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PriorLosses &#x3d; lag&#x28; PriorLosses &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TenantEvictions &#x3d; lag&#x28; TenantEvictions &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND VacancyRateExceed &#x3d; lag&#x28; VacancyRateExceed &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SeasonalRentals &#x3d; lag&#x28; SeasonalRentals &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CondoInsuingAgmt &#x3d; lag&#x28; CondoInsuingAgmt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND GasValve &#x3d; lag&#x28; GasValve &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OwnerOccupiedPct &#x3d; lag&#x28; OwnerOccupiedPct &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RestaurantName &#x3d; lag&#x28; RestaurantName &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HoursOfOperation &#x3d; lag&#x28; HoursOfOperation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RestaurantSqFt &#x3d; lag&#x28; RestaurantSqFt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SeatingCapacity &#x3d; lag&#x28; SeatingCapacity &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AnnualGrossSales &#x3d; lag&#x28; AnnualGrossSales &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SeasonalOrClosed &#x3d; lag&#x28; SeasonalOrClosed &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BarCocktailLounge &#x3d; lag&#x28; BarCocktailLounge &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LiveEntertainment &#x3d; lag&#x28; LiveEntertainment &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BeerWineGrossSales &#x3d; lag&#x28; BeerWineGrossSales &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND DistilledSpiritsServed &#x3d; lag&#x28; DistilledSpiritsServed &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND KitchenDeepFryer &#x3d; lag&#x28; KitchenDeepFryer &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SolidFuelCooking &#x3d; lag&#x28; SolidFuelCooking &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ANSULSystem &#x3d; lag&#x28; ANSULSystem &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ANSULAnnualInspection &#x3d; lag&#x28; ANSULAnnualInspection &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TenantNamesList &#x3d; lag&#x28; TenantNamesList &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TenantBusinessType &#x3d; lag&#x28; TenantBusinessType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TenantGLLiability &#x3d; lag&#x28; TenantGLLiability &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND InsuredOccupiedPortion &#x3d; lag&#x28; InsuredOccupiedPortion &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ValetParking &#x3d; lag&#x28; ValetParking &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LessorSqFt &#x3d; lag&#x28; LessorSqFt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BuildingRiskNumber &#x3d; lag&#x28; BuildingRiskNumber &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MultiPolicyIndUmbrella &#x3d; lag&#x28; MultiPolicyIndUmbrella &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PoolInd &#x3d; lag&#x28; PoolInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND StudsUpRenovation &#x3d; lag&#x28; StudsUpRenovation &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND StudsUpRenovationCompleteYear &#x3d; lag&#x28; StudsUpRenovationCompleteYear &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MultiPolicyNumberUmbrella &#x3d; lag&#x28; MultiPolicyNumberUmbrella &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RCTMSBAmt &#x3d; lag&#x28; RCTMSBAmt &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RCTMSBHomeStyle &#x3d; lag&#x28; RCTMSBHomeStyle &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WINSOverrideNonSmokerDiscount &#x3d; lag&#x28; WINSOverrideNonSmokerDiscount &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WINSOverrideSeniorDiscount &#x3d; lag&#x28; WINSOverrideSeniorDiscount &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ITV &#x3d; lag&#x28; ITV &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ITVDate &#x3d; lag&#x28; ITVDate &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MSBReportType &#x3d; lag&#x28; MSBReportType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND VandalismDesiredInd &#x3d; lag&#x28; VandalismDesiredInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WoodShakeSiding &#x3d; lag&#x28; WoodShakeSiding &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND CSEAgent &#x3d; lag&#x28; CSEAgent &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PropertyManager &#x3d; lag&#x28; PropertyManager &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RentersInsurance &#x3d; lag&#x28; RentersInsurance &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WaterDetectionDevice &#x3d; lag&#x28; WaterDetectionDevice &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AutoHomeInd &#x3d; lag&#x28; AutoHomeInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EarthquakeUmbrellaInd &#x3d; lag&#x28; EarthquakeUmbrellaInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LandlordInd &#x3d; lag&#x28; LandlordInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LossAssessment &#x3d; lag&#x28; LossAssessment &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND GasShutOffInd &#x3d; lag&#x28; GasShutOffInd &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND WaterDed &#x3d; lag&#x28; WaterDed &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ServiceLine &#x3d; lag&#x28; ServiceLine &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FunctionalReplacementCost &#x3d; lag&#x28; FunctionalReplacementCost &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MilesOfStreet &#x3d; lag&#x28; MilesOfStreet &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND HOAExteriorStructure &#x3d; lag&#x28; HOAExteriorStructure &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND RetailPortionDevelopment &#x3d; lag&#x28; RetailPortionDevelopment &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LightIndustrialType &#x3d; lag&#x28; LightIndustrialType &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LightIndustrialDescription &#x3d; lag&#x28; LightIndustrialDescription &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PoolCoverageLimit &#x3d; lag&#x28; PoolCoverageLimit &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND MultifamilyResidentialBuildings &#x3d; lag&#x28; MultifamilyResidentialBuildings &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SinglefamilyDwellings &#x3d; lag&#x28; SinglefamilyDwellings &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AnnualPayroll &#x3d; lag&#x28; AnnualPayroll &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND AnnualRevenue &#x3d; lag&#x28; AnnualRevenue &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND BedsOccupied &#x3d; lag&#x28; BedsOccupied &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND EmergencyLighting &#x3d; lag&#x28; EmergencyLighting &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND ExitSignsPosted &#x3d; lag&#x28; ExitSignsPosted &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND FullTimeStaff &#x3d; lag&#x28; FullTimeStaff &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND LicensedBeds &#x3d; lag&#x28; LicensedBeds &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND NumberofFireExtinguishers &#x3d; lag&#x28; NumberofFireExtinguishers &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OtherFireExtinguishers &#x3d; lag&#x28; OtherFireExtinguishers &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND OxygenTanks &#x3d; lag&#x28; OxygenTanks &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND PartTimeStaff &#x3d; lag&#x28; PartTimeStaff &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND SmokingPermitted &#x3d; lag&#x28; SmokingPermitted &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND StaffOnDuty &#x3d; lag&#x28; StaffOnDuty &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;AND TypeofFireExtinguishers &#x3d; lag&#x28; TypeofFireExtinguishers &#x29; OVER &#x28; PARTITION BY  Building_UniqueId  ORDER BY  changeDate, PolicyRef &#x29;		&#xd;&#xa;	   	   THEN&#xd;&#xa;	0	&#xd;&#xa;	   ELSE	&#xd;&#xa;	    row_number&#x28;&#x29; OVER &#x28; PARTITION BY Building_UniqueId  ORDER BY  changeDate &#x29; 	&#xd;&#xa;	   END Record_Version , 	&#xd;&#xa;Building_UniqueId,		&#xd;&#xa;cast&#x28;PolicyRef as varchar&#x29; Policy_Uniqueid,		&#xd;&#xa;p.policy_id,		&#xd;&#xa;spinnbuilding_id,		&#xd;&#xa;Status,		&#xd;&#xa;Building_NaturalKey,		&#xd;&#xa;StateProvCd,		&#xd;&#xa;County,		&#xd;&#xa;PostalCode,		&#xd;&#xa;City,		&#xd;&#xa;Addr1,		&#xd;&#xa;Addr2,		&#xd;&#xa;BldgNumber	,	&#xd;&#xa;BusinessCategory	,	&#xd;&#xa;BusinessClass	,	&#xd;&#xa;ConstructionCd	,	&#xd;&#xa;RoofCd	,	&#xd;&#xa;YearBuilt	,	&#xd;&#xa;SqFt	,	&#xd;&#xa;Stories	,	&#xd;&#xa;Units	,	&#xd;&#xa;OccupancyCd	,	&#xd;&#xa;ProtectionClass	,	&#xd;&#xa;TerritoryCd	,	&#xd;&#xa;BuildingLimit	,	&#xd;&#xa;ContentsLimit	,	&#xd;&#xa;ValuationMethod	,	&#xd;&#xa;InflationGuardPct	,	&#xd;&#xa;OrdinanceOrLawInd	,	&#xd;&#xa;ScheduledPremiumMod	,	&#xd;&#xa;WindHailExclusion	,	&#xd;&#xa;CovALimit	,	&#xd;&#xa;CovBLimit	,	&#xd;&#xa;CovCLimit	,	&#xd;&#xa;CovDLimit	,	&#xd;&#xa;CovELimit	,	&#xd;&#xa;CovFLimit	,	&#xd;&#xa;AllPerilDed	,	&#xd;&#xa;BurglaryAlarmType	,	&#xd;&#xa;FireAlarmType	,	&#xd;&#xa;CovBLimitIncluded	,	&#xd;&#xa;CovBLimitIncrease	,	&#xd;&#xa;CovCLimitIncluded	,	&#xd;&#xa;CovCLimitIncrease	,	&#xd;&#xa;CovDLimitIncluded	,	&#xd;&#xa;CovDLimitIncrease	,	&#xd;&#xa;OrdinanceOrLawPct	,	&#xd;&#xa;NeighborhoodCrimeWatchInd	,	&#xd;&#xa;EmployeeCreditInd	,	&#xd;&#xa;MultiPolicyInd	,	&#xd;&#xa;HomeWarrantyCreditInd	,	&#xd;&#xa;YearOccupied	,	&#xd;&#xa;YearPurchased	,	&#xd;&#xa;TypeOfStructure	,	&#xd;&#xa;FeetToFireHydrant	,	&#xd;&#xa;NumberOfFamilies	,	&#xd;&#xa;MilesFromFireStation	,	&#xd;&#xa;Rooms	,	&#xd;&#xa;RoofPitch	,	&#xd;&#xa;FireDistrict	,	&#xd;&#xa;SprinklerSystem	,	&#xd;&#xa;FireExtinguisherInd	,	&#xd;&#xa;KitchenFireExtinguisherInd	,	&#xd;&#xa;DeadboltInd	,	&#xd;&#xa;GatedCommunityInd	,	&#xd;&#xa;CentralHeatingInd	,	&#xd;&#xa;Foundation	,	&#xd;&#xa;WiringRenovation	,	&#xd;&#xa;WiringRenovationCompleteYear	,	&#xd;&#xa;PlumbingRenovation	,	&#xd;&#xa;HeatingRenovation	,	&#xd;&#xa;PlumbingRenovationCompleteYear	,	&#xd;&#xa;ExteriorPaintRenovation	,	&#xd;&#xa;HeatingRenovationCompleteYear	,	&#xd;&#xa;CircuitBreakersInd	,	&#xd;&#xa;CopperWiringInd	,	&#xd;&#xa;ExteriorPaintRenovationCompleteYear	,	&#xd;&#xa;CopperPipesInd	,	&#xd;&#xa;EarthquakeRetrofitInd	,	&#xd;&#xa;PrimaryFuelSource	,	&#xd;&#xa;SecondaryFuelSource	,	&#xd;&#xa;UsageType	,	&#xd;&#xa;HomegardCreditInd	,	&#xd;&#xa;MultiPolicyNumber	,	&#xd;&#xa;LocalFireAlarmInd	,	&#xd;&#xa;NumLosses	,	&#xd;&#xa;CovALimitIncrease	,	&#xd;&#xa;CovALimitIncluded	,	&#xd;&#xa;MonthsRentedOut	,	&#xd;&#xa;RoofReplacement	,	&#xd;&#xa;SafeguardPlusInd	,	&#xd;&#xa;CovELimitIncluded	,	&#xd;&#xa;RoofReplacementCompleteYear	,	&#xd;&#xa;CovELimitIncrease	,	&#xd;&#xa;OwnerOccupiedUnits	,	&#xd;&#xa;TenantOccupiedUnits	,	&#xd;&#xa;ReplacementCostDwellingInd	,	&#xd;&#xa;FeetToPropertyLine	,	&#xd;&#xa;GalvanizedPipeInd	,	&#xd;&#xa;WorkersCompInservant	,	&#xd;&#xa;WorkersCompOutservant	,	&#xd;&#xa;LiabilityTerritoryCd	,	&#xd;&#xa;PremisesLiabilityMedPayInd	,	&#xd;&#xa;RelatedPrivateStructureExclusion	,	&#xd;&#xa;VandalismExclusion	,	&#xd;&#xa;VandalismInd	,	&#xd;&#xa;RoofExclusion	,	&#xd;&#xa;ExpandedReplacementCostInd	,	&#xd;&#xa;ReplacementValueInd	,	&#xd;&#xa;OtherPolicyNumber1	,	&#xd;&#xa;OtherPolicyNumber2	,	&#xd;&#xa;OtherPolicyNumber3	,	&#xd;&#xa;PrimaryPolicyNumber	,	&#xd;&#xa;OtherPolicyNumbers	,	&#xd;&#xa;ReportedFireHazardScore	,	&#xd;&#xa;FireHazardScore	,	&#xd;&#xa;ReportedSteepSlopeInd	,	&#xd;&#xa;SteepSlopeInd	,	&#xd;&#xa;ReportedHomeReplacementCost	,	&#xd;&#xa;ReportedProtectionClass	,	&#xd;&#xa;EarthquakeZone	,	&#xd;&#xa;MMIScore	,	&#xd;&#xa;HomeInspectionDiscountInd	,	&#xd;&#xa;RatingTier	,	&#xd;&#xa;SoilTypeCd	,	&#xd;&#xa;ReportedFireLineAssessment	,	&#xd;&#xa;AAISFireProtectionClass	,	&#xd;&#xa;InspectionScore	,	&#xd;&#xa;AnnualRents	,	&#xd;&#xa;PitchOfRoof	,	&#xd;&#xa;TotalLivingSqFt	,	&#xd;&#xa;ParkingSqFt	,	&#xd;&#xa;ParkingType	,	&#xd;&#xa;RetrofitCompleted	,	&#xd;&#xa;NumPools	,	&#xd;&#xa;FullyFenced	,	&#xd;&#xa;DivingBoard	,	&#xd;&#xa;Gym	,	&#xd;&#xa;FreeWeights	,	&#xd;&#xa;WireFencing	,	&#xd;&#xa;OtherRecreational	,	&#xd;&#xa;OtherRecreationalDesc	,	&#xd;&#xa;HealthInspection	,	&#xd;&#xa;HealthInspectionDt	,	&#xd;&#xa;HealthInspectionCited	,	&#xd;&#xa;PriorDefectRepairs	,	&#xd;&#xa;MSBReconstructionEstimate	,	&#xd;&#xa;BIIndemnityPeriod	,	&#xd;&#xa;EquipmentBreakdown	,	&#xd;&#xa;MoneySecurityOnPremises	,	&#xd;&#xa;MoneySecurityOffPremises	,	&#xd;&#xa;WaterBackupSump	,	&#xd;&#xa;SprinkleredBuildings	,	&#xd;&#xa;SurveillanceCams	,	&#xd;&#xa;GatedComplexKeyAccess	,	&#xd;&#xa;EQRetrofit	,	&#xd;&#xa;UnitsPerBuilding	,	&#xd;&#xa;NumStories	,	&#xd;&#xa;ConstructionQuality	,	&#xd;&#xa;BurglaryRobbery	,	&#xd;&#xa;NFPAClassification	,	&#xd;&#xa;AreasOfCoverage	,	&#xd;&#xa;CODetector	,	&#xd;&#xa;SmokeDetector	,	&#xd;&#xa;SmokeDetectorInspectInd	,	&#xd;&#xa;WaterHeaterSecured	,	&#xd;&#xa;BoltedOrSecured	,	&#xd;&#xa;SoftStoryCripple	,	&#xd;&#xa;SeniorHousingPct	,	&#xd;&#xa;DesignatedSeniorHousing	,	&#xd;&#xa;StudentHousingPct	,	&#xd;&#xa;DesignatedStudentHousing	,	&#xd;&#xa;PriorLosses	,	&#xd;&#xa;TenantEvictions	,	&#xd;&#xa;VacancyRateExceed	,	&#xd;&#xa;SeasonalRentals	,	&#xd;&#xa;CondoInsuingAgmt	,	&#xd;&#xa;GasValve	,	&#xd;&#xa;OwnerOccupiedPct	,	&#xd;&#xa;RestaurantName	,	&#xd;&#xa;HoursOfOperation	,	&#xd;&#xa;RestaurantSqFt	,	&#xd;&#xa;SeatingCapacity	,	&#xd;&#xa;AnnualGrossSales	,	&#xd;&#xa;SeasonalOrClosed	,	&#xd;&#xa;BarCocktailLounge	,	&#xd;&#xa;LiveEntertainment	,	&#xd;&#xa;BeerWineGrossSales	,	&#xd;&#xa;DistilledSpiritsServed	,	&#xd;&#xa;KitchenDeepFryer	,	&#xd;&#xa;SolidFuelCooking	,	&#xd;&#xa;ANSULSystem	,	&#xd;&#xa;ANSULAnnualInspection	,	&#xd;&#xa;TenantNamesList	,	&#xd;&#xa;TenantBusinessType	,	&#xd;&#xa;TenantGLLiability	,	&#xd;&#xa;InsuredOccupiedPortion	,	&#xd;&#xa;ValetParking	,	&#xd;&#xa;LessorSqFt	,	&#xd;&#xa;BuildingRiskNumber	,	&#xd;&#xa;MultiPolicyIndUmbrella	,	&#xd;&#xa;PoolInd	,	&#xd;&#xa;StudsUpRenovation	,	&#xd;&#xa;StudsUpRenovationCompleteYear	,	&#xd;&#xa;MultiPolicyNumberUmbrella	,	&#xd;&#xa;RCTMSBAmt	,	&#xd;&#xa;RCTMSBHomeStyle	,	&#xd;&#xa;WINSOverrideNonSmokerDiscount	,	&#xd;&#xa;WINSOverrideSeniorDiscount	,	&#xd;&#xa;ITV	,	&#xd;&#xa;ITVDate	,	&#xd;&#xa;MSBReportType	,	&#xd;&#xa;VandalismDesiredInd	,	&#xd;&#xa;WoodShakeSiding	,	&#xd;&#xa;CSEAgent	,	&#xd;&#xa;PropertyManager	,	&#xd;&#xa;RentersInsurance	,	&#xd;&#xa;WaterDetectionDevice	,	&#xd;&#xa;AutoHomeInd	,	&#xd;&#xa;EarthquakeUmbrellaInd	,	&#xd;&#xa;LandlordInd	,	&#xd;&#xa;LossAssessment	,	&#xd;&#xa;GasShutOffInd	,	&#xd;&#xa;WaterDed	,	&#xd;&#xa;ServiceLine	,	&#xd;&#xa;FunctionalReplacementCost	,	&#xd;&#xa;MilesOfStreet	,	&#xd;&#xa;HOAExteriorStructure	,	&#xd;&#xa;RetailPortionDevelopment	,	&#xd;&#xa;LightIndustrialType	,	&#xd;&#xa;LightIndustrialDescription	,	&#xd;&#xa;PoolCoverageLimit	,	&#xd;&#xa;MultifamilyResidentialBuildings	,	&#xd;&#xa;SinglefamilyDwellings	,	&#xd;&#xa;AnnualPayroll	,	&#xd;&#xa;AnnualRevenue	,	&#xd;&#xa;BedsOccupied	,	&#xd;&#xa;EmergencyLighting	,	&#xd;&#xa;ExitSignsPosted	,	&#xd;&#xa;FullTimeStaff	,	&#xd;&#xa;LicensedBeds	,	&#xd;&#xa;NumberofFireExtinguishers	,	&#xd;&#xa;OtherFireExtinguishers	,	&#xd;&#xa;OxygenTanks	,	&#xd;&#xa;PartTimeStaff	,	&#xd;&#xa;SmokingPermitted	,	&#xd;&#xa;StaffOnDuty	,	&#xd;&#xa;TypeofFireExtinguishers	,	&#xd;&#xa;SourceSystem		&#xd;&#xa;	   	  INTO &#x23;DIM_BUILDING&#xd;&#xa;  FROM &#x28;select distinct &#x2a; from &#x23;stg_building where Hist_Flg&#x3d;&#x27;N&#x27;&#x29; stg		&#xd;&#xa;  join fsbi_dw_spinn.dbo.dim_policy p		&#xd;&#xa;  on cast&#x28;PolicyRef as varchar&#x29;&#x3d;p.pol_uniqueid		&#xd;&#xa;  ORDER BY Building_UniqueId, changeDate, PolicyRef&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;  --clean up the dimension table		&#xd;&#xa;  DELETE FROM FSBI_DW_SPINN.dbo.DIM_BUILDING WHERE BUILDING_ID&#x3c;&#x3e;0&#x3b;		&#xd;&#xa;		&#xd;&#xa;  INSERT INTO FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;&#x28;		&#xd;&#xa;BUILDING_ID,		&#xd;&#xa;VALID_FROMDATE,		&#xd;&#xa;VALID_TODATE ,		&#xd;&#xa;RECORD_VERSION,		&#xd;&#xa;Building_UniqueId,		&#xd;&#xa;Policy_Uniqueid,		&#xd;&#xa;Policy_Id,		&#xd;&#xa;spinnbuilding_id,		&#xd;&#xa;Status,		&#xd;&#xa;Building_NaturalKey,		&#xd;&#xa;StateProvCd,		&#xd;&#xa;County,		&#xd;&#xa;PostalCode,		&#xd;&#xa;City,		&#xd;&#xa;Addr1,		&#xd;&#xa;Addr2,		&#xd;&#xa;BldgNumber	,	&#xd;&#xa;BusinessCategory	,	&#xd;&#xa;BusinessClass	,	&#xd;&#xa;ConstructionCd	,	&#xd;&#xa;RoofCd	,	&#xd;&#xa;YearBuilt	,	&#xd;&#xa;SqFt	,	&#xd;&#xa;Stories	,	&#xd;&#xa;Units	,	&#xd;&#xa;OccupancyCd	,	&#xd;&#xa;ProtectionClass	,	&#xd;&#xa;TerritoryCd	,	&#xd;&#xa;BuildingLimit	,	&#xd;&#xa;ContentsLimit	,	&#xd;&#xa;ValuationMethod	,	&#xd;&#xa;InflationGuardPct	,	&#xd;&#xa;OrdinanceOrLawInd	,	&#xd;&#xa;ScheduledPremiumMod	,	&#xd;&#xa;WindHailExclusion	,	&#xd;&#xa;CovALimit	,	&#xd;&#xa;CovBLimit	,	&#xd;&#xa;CovCLimit	,	&#xd;&#xa;CovDLimit	,	&#xd;&#xa;CovELimit	,	&#xd;&#xa;CovFLimit	,	&#xd;&#xa;AllPerilDed	,	&#xd;&#xa;BurglaryAlarmType	,	&#xd;&#xa;FireAlarmType	,	&#xd;&#xa;CovBLimitIncluded	,	&#xd;&#xa;CovBLimitIncrease	,	&#xd;&#xa;CovCLimitIncluded	,	&#xd;&#xa;CovCLimitIncrease	,	&#xd;&#xa;CovDLimitIncluded	,	&#xd;&#xa;CovDLimitIncrease	,	&#xd;&#xa;OrdinanceOrLawPct	,	&#xd;&#xa;NeighborhoodCrimeWatchInd	,	&#xd;&#xa;EmployeeCreditInd	,	&#xd;&#xa;MultiPolicyInd	,	&#xd;&#xa;HomeWarrantyCreditInd	,	&#xd;&#xa;YearOccupied	,	&#xd;&#xa;YearPurchased	,	&#xd;&#xa;TypeOfStructure	,	&#xd;&#xa;FeetToFireHydrant	,	&#xd;&#xa;NumberOfFamilies	,	&#xd;&#xa;MilesFromFireStation	,	&#xd;&#xa;Rooms	,	&#xd;&#xa;RoofPitch	,	&#xd;&#xa;FireDistrict	,	&#xd;&#xa;SprinklerSystem	,	&#xd;&#xa;FireExtinguisherInd	,	&#xd;&#xa;KitchenFireExtinguisherInd	,	&#xd;&#xa;DeadboltInd	,	&#xd;&#xa;GatedCommunityInd	,	&#xd;&#xa;CentralHeatingInd	,	&#xd;&#xa;Foundation	,	&#xd;&#xa;WiringRenovation	,	&#xd;&#xa;WiringRenovationCompleteYear	,	&#xd;&#xa;PlumbingRenovation	,	&#xd;&#xa;HeatingRenovation	,	&#xd;&#xa;PlumbingRenovationCompleteYear	,	&#xd;&#xa;ExteriorPaintRenovation	,	&#xd;&#xa;HeatingRenovationCompleteYear	,	&#xd;&#xa;CircuitBreakersInd	,	&#xd;&#xa;CopperWiringInd	,	&#xd;&#xa;ExteriorPaintRenovationCompleteYear	,	&#xd;&#xa;CopperPipesInd	,	&#xd;&#xa;EarthquakeRetrofitInd	,	&#xd;&#xa;PrimaryFuelSource	,	&#xd;&#xa;SecondaryFuelSource	,	&#xd;&#xa;UsageType	,	&#xd;&#xa;HomegardCreditInd	,	&#xd;&#xa;MultiPolicyNumber	,	&#xd;&#xa;LocalFireAlarmInd	,	&#xd;&#xa;NumLosses	,	&#xd;&#xa;CovALimitIncrease	,	&#xd;&#xa;CovALimitIncluded	,	&#xd;&#xa;MonthsRentedOut	,	&#xd;&#xa;RoofReplacement	,	&#xd;&#xa;SafeguardPlusInd	,	&#xd;&#xa;CovELimitIncluded	,	&#xd;&#xa;RoofReplacementCompleteYear	,	&#xd;&#xa;CovELimitIncrease	,	&#xd;&#xa;OwnerOccupiedUnits	,	&#xd;&#xa;TenantOccupiedUnits	,	&#xd;&#xa;ReplacementCostDwellingInd	,	&#xd;&#xa;FeetToPropertyLine	,	&#xd;&#xa;GalvanizedPipeInd	,	&#xd;&#xa;WorkersCompInservant	,	&#xd;&#xa;WorkersCompOutservant	,	&#xd;&#xa;LiabilityTerritoryCd	,	&#xd;&#xa;PremisesLiabilityMedPayInd	,	&#xd;&#xa;RelatedPrivateStructureExclusion	,	&#xd;&#xa;VandalismExclusion	,	&#xd;&#xa;VandalismInd	,	&#xd;&#xa;RoofExclusion	,	&#xd;&#xa;ExpandedReplacementCostInd	,	&#xd;&#xa;ReplacementValueInd	,	&#xd;&#xa;OtherPolicyNumber1	,	&#xd;&#xa;OtherPolicyNumber2	,	&#xd;&#xa;OtherPolicyNumber3	,	&#xd;&#xa;PrimaryPolicyNumber	,	&#xd;&#xa;OtherPolicyNumbers	,	&#xd;&#xa;ReportedFireHazardScore	,	&#xd;&#xa;FireHazardScore	,	&#xd;&#xa;ReportedSteepSlopeInd	,	&#xd;&#xa;SteepSlopeInd	,	&#xd;&#xa;ReportedHomeReplacementCost	,	&#xd;&#xa;ReportedProtectionClass	,	&#xd;&#xa;EarthquakeZone	,	&#xd;&#xa;MMIScore	,	&#xd;&#xa;HomeInspectionDiscountInd	,	&#xd;&#xa;RatingTier	,	&#xd;&#xa;SoilTypeCd	,	&#xd;&#xa;ReportedFireLineAssessment	,	&#xd;&#xa;AAISFireProtectionClass	,	&#xd;&#xa;InspectionScore	,	&#xd;&#xa;AnnualRents	,	&#xd;&#xa;PitchOfRoof	,	&#xd;&#xa;TotalLivingSqFt	,	&#xd;&#xa;ParkingSqFt	,	&#xd;&#xa;ParkingType	,	&#xd;&#xa;RetrofitCompleted	,	&#xd;&#xa;NumPools	,	&#xd;&#xa;FullyFenced	,	&#xd;&#xa;DivingBoard	,	&#xd;&#xa;Gym	,	&#xd;&#xa;FreeWeights	,	&#xd;&#xa;WireFencing	,	&#xd;&#xa;OtherRecreational	,	&#xd;&#xa;OtherRecreationalDesc	,	&#xd;&#xa;HealthInspection	,	&#xd;&#xa;HealthInspectionDt	,	&#xd;&#xa;HealthInspectionCited	,	&#xd;&#xa;PriorDefectRepairs	,	&#xd;&#xa;MSBReconstructionEstimate	,	&#xd;&#xa;BIIndemnityPeriod	,	&#xd;&#xa;EquipmentBreakdown	,	&#xd;&#xa;MoneySecurityOnPremises	,	&#xd;&#xa;MoneySecurityOffPremises	,	&#xd;&#xa;WaterBackupSump	,	&#xd;&#xa;SprinkleredBuildings	,	&#xd;&#xa;SurveillanceCams	,	&#xd;&#xa;GatedComplexKeyAccess	,	&#xd;&#xa;EQRetrofit	,	&#xd;&#xa;UnitsPerBuilding	,	&#xd;&#xa;NumStories	,	&#xd;&#xa;ConstructionQuality	,	&#xd;&#xa;BurglaryRobbery	,	&#xd;&#xa;NFPAClassification	,	&#xd;&#xa;AreasOfCoverage	,	&#xd;&#xa;CODetector	,	&#xd;&#xa;SmokeDetector	,	&#xd;&#xa;SmokeDetectorInspectInd	,	&#xd;&#xa;WaterHeaterSecured	,	&#xd;&#xa;BoltedOrSecured	,	&#xd;&#xa;SoftStoryCripple	,	&#xd;&#xa;SeniorHousingPct	,	&#xd;&#xa;DesignatedSeniorHousing	,	&#xd;&#xa;StudentHousingPct	,	&#xd;&#xa;DesignatedStudentHousing	,	&#xd;&#xa;PriorLosses	,	&#xd;&#xa;TenantEvictions	,	&#xd;&#xa;VacancyRateExceed	,	&#xd;&#xa;SeasonalRentals	,	&#xd;&#xa;CondoInsuingAgmt	,	&#xd;&#xa;GasValve	,	&#xd;&#xa;OwnerOccupiedPct	,	&#xd;&#xa;RestaurantName	,	&#xd;&#xa;HoursOfOperation	,	&#xd;&#xa;RestaurantSqFt	,	&#xd;&#xa;SeatingCapacity	,	&#xd;&#xa;AnnualGrossSales	,	&#xd;&#xa;SeasonalOrClosed	,	&#xd;&#xa;BarCocktailLounge	,	&#xd;&#xa;LiveEntertainment	,	&#xd;&#xa;BeerWineGrossSales	,	&#xd;&#xa;DistilledSpiritsServed	,	&#xd;&#xa;KitchenDeepFryer	,	&#xd;&#xa;SolidFuelCooking	,	&#xd;&#xa;ANSULSystem	,	&#xd;&#xa;ANSULAnnualInspection	,	&#xd;&#xa;TenantNamesList	,	&#xd;&#xa;TenantBusinessType	,	&#xd;&#xa;TenantGLLiability	,	&#xd;&#xa;InsuredOccupiedPortion	,	&#xd;&#xa;ValetParking	,	&#xd;&#xa;LessorSqFt	,	&#xd;&#xa;BuildingRiskNumber	,	&#xd;&#xa;MultiPolicyIndUmbrella	,	&#xd;&#xa;PoolInd	,	&#xd;&#xa;StudsUpRenovation	,	&#xd;&#xa;StudsUpRenovationCompleteYear	,	&#xd;&#xa;MultiPolicyNumberUmbrella	,	&#xd;&#xa;RCTMSBAmt	,	&#xd;&#xa;RCTMSBHomeStyle	,	&#xd;&#xa;WINSOverrideNonSmokerDiscount	,	&#xd;&#xa;WINSOverrideSeniorDiscount	,	&#xd;&#xa;ITV	,	&#xd;&#xa;ITVDate	,	&#xd;&#xa;MSBReportType	,	&#xd;&#xa;VandalismDesiredInd	,	&#xd;&#xa;WoodShakeSiding	,	&#xd;&#xa;CSEAgent	,	&#xd;&#xa;PropertyManager	,	&#xd;&#xa;RentersInsurance	,	&#xd;&#xa;WaterDetectionDevice	,	&#xd;&#xa;AutoHomeInd	,	&#xd;&#xa;EarthquakeUmbrellaInd	,	&#xd;&#xa;LandlordInd	,	&#xd;&#xa;LossAssessment	,	&#xd;&#xa;GasShutOffInd	,	&#xd;&#xa;WaterDed	,	&#xd;&#xa;ServiceLine	,	&#xd;&#xa;FunctionalReplacementCost	,	&#xd;&#xa;MilesOfStreet	,	&#xd;&#xa;HOAExteriorStructure	,	&#xd;&#xa;RetailPortionDevelopment	,	&#xd;&#xa;LightIndustrialType	,	&#xd;&#xa;LightIndustrialDescription	,	&#xd;&#xa;PoolCoverageLimit	,	&#xd;&#xa;MultifamilyResidentialBuildings	,	&#xd;&#xa;SinglefamilyDwellings	,	&#xd;&#xa;AnnualPayroll	,	&#xd;&#xa;AnnualRevenue	,	&#xd;&#xa;BedsOccupied	,	&#xd;&#xa;EmergencyLighting	,	&#xd;&#xa;ExitSignsPosted	,	&#xd;&#xa;FullTimeStaff	,	&#xd;&#xa;LicensedBeds	,	&#xd;&#xa;NumberofFireExtinguishers	,	&#xd;&#xa;OtherFireExtinguishers	,	&#xd;&#xa;OxygenTanks	,	&#xd;&#xa;PartTimeStaff	,	&#xd;&#xa;SmokingPermitted	,	&#xd;&#xa;StaffOnDuty	,	&#xd;&#xa;TypeofFireExtinguishers	,	&#xd;&#xa;SourceSystem,		&#xd;&#xa;LOADDATE		&#xd;&#xa;&#x29;		&#xd;&#xa;select		&#xd;&#xa; BUILDING_ID ,		&#xd;&#xa; VALID_FROMDATE ,		&#xd;&#xa; lead&#x28;VALID_FROMDATE&#x29; OVER &#x28; PARTITION BY Building_UniqueId  ORDER BY VALID_FROMDATE &#x29;    VALID_TODATE ,		&#xd;&#xa;RECORD_VERSION	,	&#xd;&#xa;BUILDING_UniqueId	,	&#xd;&#xa;Policy_Uniqueid,		&#xd;&#xa;Policy_Id,		&#xd;&#xa;spinnbuilding_id,		&#xd;&#xa;Status,		&#xd;&#xa;Building_NaturalKey,		&#xd;&#xa;StateProvCd,		&#xd;&#xa;County,		&#xd;&#xa;PostalCode,		&#xd;&#xa;City,		&#xd;&#xa;Addr1,		&#xd;&#xa;Addr2,		&#xd;&#xa;BldgNumber	,	&#xd;&#xa;BusinessCategory	,	&#xd;&#xa;BusinessClass	,	&#xd;&#xa;ConstructionCd	,	&#xd;&#xa;RoofCd	,	&#xd;&#xa;YearBuilt	,	&#xd;&#xa;SqFt	,	&#xd;&#xa;Stories	,	&#xd;&#xa;Units	,	&#xd;&#xa;OccupancyCd	,	&#xd;&#xa;ProtectionClass	,	&#xd;&#xa;TerritoryCd	,	&#xd;&#xa;BuildingLimit	,	&#xd;&#xa;ContentsLimit	,	&#xd;&#xa;ValuationMethod	,	&#xd;&#xa;InflationGuardPct	,	&#xd;&#xa;OrdinanceOrLawInd	,	&#xd;&#xa;ScheduledPremiumMod	,	&#xd;&#xa;WindHailExclusion	,	&#xd;&#xa;CovALimit	,	&#xd;&#xa;CovBLimit	,	&#xd;&#xa;CovCLimit	,	&#xd;&#xa;CovDLimit	,	&#xd;&#xa;CovELimit	,	&#xd;&#xa;CovFLimit	,	&#xd;&#xa;AllPerilDed	,	&#xd;&#xa;BurglaryAlarmType	,	&#xd;&#xa;FireAlarmType	,	&#xd;&#xa;CovBLimitIncluded	,	&#xd;&#xa;CovBLimitIncrease	,	&#xd;&#xa;CovCLimitIncluded	,	&#xd;&#xa;CovCLimitIncrease	,	&#xd;&#xa;CovDLimitIncluded	,	&#xd;&#xa;CovDLimitIncrease	,	&#xd;&#xa;OrdinanceOrLawPct	,	&#xd;&#xa;NeighborhoodCrimeWatchInd	,	&#xd;&#xa;EmployeeCreditInd	,	&#xd;&#xa;MultiPolicyInd	,	&#xd;&#xa;HomeWarrantyCreditInd	,	&#xd;&#xa;YearOccupied	,	&#xd;&#xa;YearPurchased	,	&#xd;&#xa;TypeOfStructure	,	&#xd;&#xa;FeetToFireHydrant	,	&#xd;&#xa;NumberOfFamilies	,	&#xd;&#xa;MilesFromFireStation	,	&#xd;&#xa;Rooms	,	&#xd;&#xa;RoofPitch	,	&#xd;&#xa;FireDistrict	,	&#xd;&#xa;SprinklerSystem	,	&#xd;&#xa;FireExtinguisherInd	,	&#xd;&#xa;KitchenFireExtinguisherInd	,	&#xd;&#xa;DeadboltInd	,	&#xd;&#xa;GatedCommunityInd	,	&#xd;&#xa;CentralHeatingInd	,	&#xd;&#xa;Foundation	,	&#xd;&#xa;WiringRenovation	,	&#xd;&#xa;WiringRenovationCompleteYear	,	&#xd;&#xa;PlumbingRenovation	,	&#xd;&#xa;HeatingRenovation	,	&#xd;&#xa;PlumbingRenovationCompleteYear	,	&#xd;&#xa;ExteriorPaintRenovation	,	&#xd;&#xa;HeatingRenovationCompleteYear	,	&#xd;&#xa;CircuitBreakersInd	,	&#xd;&#xa;CopperWiringInd	,	&#xd;&#xa;ExteriorPaintRenovationCompleteYear	,	&#xd;&#xa;CopperPipesInd	,	&#xd;&#xa;EarthquakeRetrofitInd	,	&#xd;&#xa;PrimaryFuelSource	,	&#xd;&#xa;SecondaryFuelSource	,	&#xd;&#xa;UsageType	,	&#xd;&#xa;HomegardCreditInd	,	&#xd;&#xa;MultiPolicyNumber	,	&#xd;&#xa;LocalFireAlarmInd	,	&#xd;&#xa;NumLosses	,	&#xd;&#xa;CovALimitIncrease	,	&#xd;&#xa;CovALimitIncluded	,	&#xd;&#xa;MonthsRentedOut	,	&#xd;&#xa;RoofReplacement	,	&#xd;&#xa;SafeguardPlusInd	,	&#xd;&#xa;CovELimitIncluded	,	&#xd;&#xa;RoofReplacementCompleteYear	,	&#xd;&#xa;CovELimitIncrease	,	&#xd;&#xa;OwnerOccupiedUnits	,	&#xd;&#xa;TenantOccupiedUnits	,	&#xd;&#xa;ReplacementCostDwellingInd	,	&#xd;&#xa;FeetToPropertyLine	,	&#xd;&#xa;GalvanizedPipeInd	,	&#xd;&#xa;WorkersCompInservant	,	&#xd;&#xa;WorkersCompOutservant	,	&#xd;&#xa;LiabilityTerritoryCd	,	&#xd;&#xa;PremisesLiabilityMedPayInd	,	&#xd;&#xa;RelatedPrivateStructureExclusion	,	&#xd;&#xa;VandalismExclusion	,	&#xd;&#xa;VandalismInd	,	&#xd;&#xa;RoofExclusion	,	&#xd;&#xa;ExpandedReplacementCostInd	,	&#xd;&#xa;ReplacementValueInd	,	&#xd;&#xa;OtherPolicyNumber1	,	&#xd;&#xa;OtherPolicyNumber2	,	&#xd;&#xa;OtherPolicyNumber3	,	&#xd;&#xa;PrimaryPolicyNumber	,	&#xd;&#xa;OtherPolicyNumbers	,	&#xd;&#xa;ReportedFireHazardScore	,	&#xd;&#xa;FireHazardScore	,	&#xd;&#xa;ReportedSteepSlopeInd	,	&#xd;&#xa;SteepSlopeInd	,	&#xd;&#xa;ReportedHomeReplacementCost	,	&#xd;&#xa;ReportedProtectionClass	,	&#xd;&#xa;EarthquakeZone	,	&#xd;&#xa;MMIScore	,	&#xd;&#xa;HomeInspectionDiscountInd	,	&#xd;&#xa;RatingTier	,	&#xd;&#xa;SoilTypeCd	,	&#xd;&#xa;ReportedFireLineAssessment	,	&#xd;&#xa;AAISFireProtectionClass	,	&#xd;&#xa;InspectionScore	,	&#xd;&#xa;AnnualRents	,	&#xd;&#xa;PitchOfRoof	,	&#xd;&#xa;TotalLivingSqFt	,	&#xd;&#xa;ParkingSqFt	,	&#xd;&#xa;ParkingType	,	&#xd;&#xa;RetrofitCompleted	,	&#xd;&#xa;NumPools	,	&#xd;&#xa;FullyFenced	,	&#xd;&#xa;DivingBoard	,	&#xd;&#xa;Gym	,	&#xd;&#xa;FreeWeights	,	&#xd;&#xa;WireFencing	,	&#xd;&#xa;OtherRecreational	,	&#xd;&#xa;OtherRecreationalDesc	,	&#xd;&#xa;HealthInspection	,	&#xd;&#xa;HealthInspectionDt	,	&#xd;&#xa;HealthInspectionCited	,	&#xd;&#xa;PriorDefectRepairs	,	&#xd;&#xa;MSBReconstructionEstimate	,	&#xd;&#xa;BIIndemnityPeriod	,	&#xd;&#xa;EquipmentBreakdown	,	&#xd;&#xa;MoneySecurityOnPremises	,	&#xd;&#xa;MoneySecurityOffPremises	,	&#xd;&#xa;WaterBackupSump	,	&#xd;&#xa;SprinkleredBuildings	,	&#xd;&#xa;SurveillanceCams	,	&#xd;&#xa;GatedComplexKeyAccess	,	&#xd;&#xa;EQRetrofit	,	&#xd;&#xa;UnitsPerBuilding	,	&#xd;&#xa;NumStories	,	&#xd;&#xa;ConstructionQuality	,	&#xd;&#xa;BurglaryRobbery	,	&#xd;&#xa;NFPAClassification	,	&#xd;&#xa;AreasOfCoverage	,	&#xd;&#xa;CODetector	,	&#xd;&#xa;SmokeDetector	,	&#xd;&#xa;SmokeDetectorInspectInd	,	&#xd;&#xa;WaterHeaterSecured	,	&#xd;&#xa;BoltedOrSecured	,	&#xd;&#xa;SoftStoryCripple	,	&#xd;&#xa;SeniorHousingPct	,	&#xd;&#xa;DesignatedSeniorHousing	,	&#xd;&#xa;StudentHousingPct	,	&#xd;&#xa;DesignatedStudentHousing	,	&#xd;&#xa;PriorLosses	,	&#xd;&#xa;TenantEvictions	,	&#xd;&#xa;VacancyRateExceed	,	&#xd;&#xa;SeasonalRentals	,	&#xd;&#xa;CondoInsuingAgmt	,	&#xd;&#xa;GasValve	,	&#xd;&#xa;OwnerOccupiedPct	,	&#xd;&#xa;RestaurantName	,	&#xd;&#xa;HoursOfOperation	,	&#xd;&#xa;RestaurantSqFt	,	&#xd;&#xa;SeatingCapacity	,	&#xd;&#xa;AnnualGrossSales	,	&#xd;&#xa;SeasonalOrClosed	,	&#xd;&#xa;BarCocktailLounge	,	&#xd;&#xa;LiveEntertainment	,	&#xd;&#xa;BeerWineGrossSales	,	&#xd;&#xa;DistilledSpiritsServed	,	&#xd;&#xa;KitchenDeepFryer	,	&#xd;&#xa;SolidFuelCooking	,	&#xd;&#xa;ANSULSystem	,	&#xd;&#xa;ANSULAnnualInspection	,	&#xd;&#xa;TenantNamesList	,	&#xd;&#xa;TenantBusinessType	,	&#xd;&#xa;TenantGLLiability	,	&#xd;&#xa;InsuredOccupiedPortion	,	&#xd;&#xa;ValetParking	,	&#xd;&#xa;LessorSqFt	,	&#xd;&#xa;BuildingRiskNumber	,	&#xd;&#xa;MultiPolicyIndUmbrella	,	&#xd;&#xa;PoolInd	,	&#xd;&#xa;StudsUpRenovation	,	&#xd;&#xa;StudsUpRenovationCompleteYear	,	&#xd;&#xa;MultiPolicyNumberUmbrella	,	&#xd;&#xa;RCTMSBAmt	,	&#xd;&#xa;RCTMSBHomeStyle	,	&#xd;&#xa;WINSOverrideNonSmokerDiscount	,	&#xd;&#xa;WINSOverrideSeniorDiscount	,	&#xd;&#xa;ITV	,	&#xd;&#xa;ITVDate	,	&#xd;&#xa;MSBReportType	,	&#xd;&#xa;VandalismDesiredInd	,	&#xd;&#xa;WoodShakeSiding	,	&#xd;&#xa;CSEAgent	,	&#xd;&#xa;PropertyManager	,	&#xd;&#xa;RentersInsurance	,	&#xd;&#xa;WaterDetectionDevice	,	&#xd;&#xa;AutoHomeInd	,	&#xd;&#xa;EarthquakeUmbrellaInd	,	&#xd;&#xa;LandlordInd	,	&#xd;&#xa;LossAssessment	,	&#xd;&#xa;GasShutOffInd	,	&#xd;&#xa;WaterDed	,	&#xd;&#xa;ServiceLine	,	&#xd;&#xa;FunctionalReplacementCost	,	&#xd;&#xa;MilesOfStreet	,	&#xd;&#xa;HOAExteriorStructure	,	&#xd;&#xa;RetailPortionDevelopment	,	&#xd;&#xa;LightIndustrialType	,	&#xd;&#xa;LightIndustrialDescription	,	&#xd;&#xa;PoolCoverageLimit,		&#xd;&#xa;MultifamilyResidentialBuildings	,	&#xd;&#xa;SinglefamilyDwellings	,	&#xd;&#xa;AnnualPayroll	,	&#xd;&#xa;AnnualRevenue	,	&#xd;&#xa;BedsOccupied	,	&#xd;&#xa;EmergencyLighting	,	&#xd;&#xa;ExitSignsPosted	,	&#xd;&#xa;FullTimeStaff	,	&#xd;&#xa;LicensedBeds	,	&#xd;&#xa;NumberofFireExtinguishers	,	&#xd;&#xa;OtherFireExtinguishers	,	&#xd;&#xa;OxygenTanks	,	&#xd;&#xa;PartTimeStaff	,	&#xd;&#xa;SmokingPermitted	,	&#xd;&#xa;StaffOnDuty	,	&#xd;&#xa;TypeofFireExtinguishers	,	&#xd;&#xa;SourceSystem,		&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate		&#xd;&#xa;from &#x23;DIM_BUILDING		&#xd;&#xa;where record_version&#x3c;&#x3e;0		&#xd;&#xa;ORDER BY BUILDING_UniqueId, VALID_TODATE&#x3b;		&#xd;&#xa; 		&#xd;&#xa;		&#xd;&#xa; 		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa; --adjusting Valid From for 1st vehicle records		&#xd;&#xa;update		&#xd;&#xa;    FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;set		&#xd;&#xa;    DIM_BUILDING.VALID_FROMDATE &#x3d; cast&#x28;&#x27;1900-01-01&#x27; as datetime&#x29;		&#xd;&#xa;from		&#xd;&#xa;    &#x28;		&#xd;&#xa;select BUILDING_UniqueID		&#xd;&#xa;,min&#x28;Record_Version&#x29; r		&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;group by BUILDING_UniqueID		&#xd;&#xa;&#x29; d		&#xd;&#xa;join		&#xd;&#xa;FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;on  DIM_BUILDING.BUILDING_UniqueID&#x3d;d.BUILDING_UniqueID		&#xd;&#xa;and DIM_BUILDING.RECORD_VERSION&#x3d;d.r		&#xd;&#xa;and VALID_FROMDATE&#x3c;&#x3e;&#x27;1900-01-01 00&#x3a;00&#x3a;00.000&#x27;&#x3b;		&#xd;&#xa;		&#xd;&#xa; --update valid_todate if any		&#xd;&#xa;update		&#xd;&#xa;    FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;set		&#xd;&#xa;    DIM_BUILDING.VALID_TODATE &#x3d; cast&#x28;&#x27;3000-01-01&#x27; as datetime&#x29;		&#xd;&#xa;from		&#xd;&#xa;    &#x28;		&#xd;&#xa;select BUILDING_UniqueID		&#xd;&#xa;,max&#x28;Record_Version&#x29; r		&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;group by BUILDING_UniqueID		&#xd;&#xa;&#x29; d		&#xd;&#xa;join		&#xd;&#xa;FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;on  DIM_BUILDING.BUILDING_UniqueID&#x3d;d.BUILDING_UniqueID		&#xd;&#xa;and DIM_BUILDING.RECORD_VERSION&#x3d;d.r		&#xd;&#xa;and &#x28;VALID_TODATE&#x3c;&#x27;3000-01-01&#x27; or VALID_TODATE is null&#x29;&#x3b;		&#xd;&#xa;		&#xd;&#xa;   --adjusting record_version		&#xd;&#xa;with data as &#x28;select building_id, row_number&#x28;&#x29; over&#x28;partition by building_uniqueid order by valid_fromdate, valid_todate&#x29; rn		&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_building d		&#xd;&#xa;where audit_id&#x3d;0&#x29;		&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_building		&#xd;&#xa;set record_version&#x3d;data.rn		&#xd;&#xa;from fsbi_dw_spinn.dbo.dim_building v		&#xd;&#xa;join data on v.building_id&#x3d;data.building_id		&#xd;&#xa;where audit_id&#x3d;0&#x3b;		&#xd;&#xa;		&#xd;&#xa; --adjusting null valid_todate		&#xd;&#xa;update fsbi_dw_spinn.dbo.dim_building		&#xd;&#xa;set valid_todate&#x3d;valid_fromdate		&#xd;&#xa;where valid_todate is null		&#xd;&#xa;and audit_id&#x3d;0&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;IF OBJECT_ID&#x28;&#x27;tempdb..&#x23;max_building_id&#x27;&#x29; IS NOT NULL		&#xd;&#xa;drop table &#x23;max_building_id&#x3b;		&#xd;&#xa;		&#xd;&#xa;select max&#x28;building_id&#x29; m into &#x23;max_building_id from fsbi_dw_spinn.dbo.dim_building&#x3b;		&#xd;&#xa;		&#xd;&#xa;  --Historical records		&#xd;&#xa;INSERT INTO FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;&#x28;		&#xd;&#xa;BUILDING_ID,		&#xd;&#xa;VALID_FROMDATE,		&#xd;&#xa;VALID_TODATE ,		&#xd;&#xa;RECORD_VERSION,		&#xd;&#xa;Building_UniqueId,		&#xd;&#xa;Policy_Uniqueid,		&#xd;&#xa;Policy_Id,		&#xd;&#xa;spinnbuilding_id,		&#xd;&#xa;Status,		&#xd;&#xa;Building_NaturalKey,		&#xd;&#xa;StateProvCd,		&#xd;&#xa;County,		&#xd;&#xa;PostalCode,		&#xd;&#xa;City,		&#xd;&#xa;Addr1,		&#xd;&#xa;Addr2,		&#xd;&#xa;BldgNumber	,	&#xd;&#xa;BusinessCategory	,	&#xd;&#xa;BusinessClass	,	&#xd;&#xa;ConstructionCd	,	&#xd;&#xa;RoofCd	,	&#xd;&#xa;YearBuilt	,	&#xd;&#xa;SqFt	,	&#xd;&#xa;Stories	,	&#xd;&#xa;Units	,	&#xd;&#xa;OccupancyCd	,	&#xd;&#xa;ProtectionClass	,	&#xd;&#xa;TerritoryCd	,	&#xd;&#xa;BuildingLimit	,	&#xd;&#xa;ContentsLimit	,	&#xd;&#xa;ValuationMethod	,	&#xd;&#xa;InflationGuardPct	,	&#xd;&#xa;OrdinanceOrLawInd	,	&#xd;&#xa;ScheduledPremiumMod	,	&#xd;&#xa;WindHailExclusion	,	&#xd;&#xa;CovALimit	,	&#xd;&#xa;CovBLimit	,	&#xd;&#xa;CovCLimit	,	&#xd;&#xa;CovDLimit	,	&#xd;&#xa;CovELimit	,	&#xd;&#xa;CovFLimit	,	&#xd;&#xa;AllPerilDed	,	&#xd;&#xa;BurglaryAlarmType	,	&#xd;&#xa;FireAlarmType	,	&#xd;&#xa;CovBLimitIncluded	,	&#xd;&#xa;CovBLimitIncrease	,	&#xd;&#xa;CovCLimitIncluded	,	&#xd;&#xa;CovCLimitIncrease	,	&#xd;&#xa;CovDLimitIncluded	,	&#xd;&#xa;CovDLimitIncrease	,	&#xd;&#xa;OrdinanceOrLawPct	,	&#xd;&#xa;NeighborhoodCrimeWatchInd	,	&#xd;&#xa;EmployeeCreditInd	,	&#xd;&#xa;MultiPolicyInd	,	&#xd;&#xa;HomeWarrantyCreditInd	,	&#xd;&#xa;YearOccupied	,	&#xd;&#xa;YearPurchased	,	&#xd;&#xa;TypeOfStructure	,	&#xd;&#xa;FeetToFireHydrant	,	&#xd;&#xa;NumberOfFamilies	,	&#xd;&#xa;MilesFromFireStation	,	&#xd;&#xa;Rooms	,	&#xd;&#xa;RoofPitch	,	&#xd;&#xa;FireDistrict	,	&#xd;&#xa;SprinklerSystem	,	&#xd;&#xa;FireExtinguisherInd	,	&#xd;&#xa;KitchenFireExtinguisherInd	,	&#xd;&#xa;DeadboltInd	,	&#xd;&#xa;GatedCommunityInd	,	&#xd;&#xa;CentralHeatingInd	,	&#xd;&#xa;Foundation	,	&#xd;&#xa;WiringRenovation	,	&#xd;&#xa;WiringRenovationCompleteYear	,	&#xd;&#xa;PlumbingRenovation	,	&#xd;&#xa;HeatingRenovation	,	&#xd;&#xa;PlumbingRenovationCompleteYear	,	&#xd;&#xa;ExteriorPaintRenovation	,	&#xd;&#xa;HeatingRenovationCompleteYear	,	&#xd;&#xa;CircuitBreakersInd	,	&#xd;&#xa;CopperWiringInd	,	&#xd;&#xa;ExteriorPaintRenovationCompleteYear	,	&#xd;&#xa;CopperPipesInd	,	&#xd;&#xa;EarthquakeRetrofitInd	,	&#xd;&#xa;PrimaryFuelSource	,	&#xd;&#xa;SecondaryFuelSource	,	&#xd;&#xa;UsageType	,	&#xd;&#xa;HomegardCreditInd	,	&#xd;&#xa;MultiPolicyNumber	,	&#xd;&#xa;LocalFireAlarmInd	,	&#xd;&#xa;NumLosses	,	&#xd;&#xa;CovALimitIncrease	,	&#xd;&#xa;CovALimitIncluded	,	&#xd;&#xa;MonthsRentedOut	,	&#xd;&#xa;RoofReplacement	,	&#xd;&#xa;SafeguardPlusInd	,	&#xd;&#xa;CovELimitIncluded	,	&#xd;&#xa;RoofReplacementCompleteYear	,	&#xd;&#xa;CovELimitIncrease	,	&#xd;&#xa;OwnerOccupiedUnits	,	&#xd;&#xa;TenantOccupiedUnits	,	&#xd;&#xa;ReplacementCostDwellingInd	,	&#xd;&#xa;FeetToPropertyLine	,	&#xd;&#xa;GalvanizedPipeInd	,	&#xd;&#xa;WorkersCompInservant	,	&#xd;&#xa;WorkersCompOutservant	,	&#xd;&#xa;LiabilityTerritoryCd	,	&#xd;&#xa;PremisesLiabilityMedPayInd	,	&#xd;&#xa;RelatedPrivateStructureExclusion	,	&#xd;&#xa;VandalismExclusion	,	&#xd;&#xa;VandalismInd	,	&#xd;&#xa;RoofExclusion	,	&#xd;&#xa;ExpandedReplacementCostInd	,	&#xd;&#xa;ReplacementValueInd	,	&#xd;&#xa;OtherPolicyNumber1	,	&#xd;&#xa;OtherPolicyNumber2	,	&#xd;&#xa;OtherPolicyNumber3	,	&#xd;&#xa;PrimaryPolicyNumber	,	&#xd;&#xa;OtherPolicyNumbers	,	&#xd;&#xa;ReportedFireHazardScore	,	&#xd;&#xa;FireHazardScore	,	&#xd;&#xa;ReportedSteepSlopeInd	,	&#xd;&#xa;SteepSlopeInd	,	&#xd;&#xa;ReportedHomeReplacementCost	,	&#xd;&#xa;ReportedProtectionClass	,	&#xd;&#xa;EarthquakeZone	,	&#xd;&#xa;MMIScore	,	&#xd;&#xa;HomeInspectionDiscountInd	,	&#xd;&#xa;RatingTier	,	&#xd;&#xa;SoilTypeCd	,	&#xd;&#xa;ReportedFireLineAssessment	,	&#xd;&#xa;AAISFireProtectionClass	,	&#xd;&#xa;InspectionScore	,	&#xd;&#xa;AnnualRents	,	&#xd;&#xa;PitchOfRoof	,	&#xd;&#xa;TotalLivingSqFt	,	&#xd;&#xa;ParkingSqFt	,	&#xd;&#xa;ParkingType	,	&#xd;&#xa;RetrofitCompleted	,	&#xd;&#xa;NumPools	,	&#xd;&#xa;FullyFenced	,	&#xd;&#xa;DivingBoard	,	&#xd;&#xa;Gym	,	&#xd;&#xa;FreeWeights	,	&#xd;&#xa;WireFencing	,	&#xd;&#xa;OtherRecreational	,	&#xd;&#xa;OtherRecreationalDesc	,	&#xd;&#xa;HealthInspection	,	&#xd;&#xa;HealthInspectionDt	,	&#xd;&#xa;HealthInspectionCited	,	&#xd;&#xa;PriorDefectRepairs	,	&#xd;&#xa;MSBReconstructionEstimate	,	&#xd;&#xa;BIIndemnityPeriod	,	&#xd;&#xa;EquipmentBreakdown	,	&#xd;&#xa;MoneySecurityOnPremises	,	&#xd;&#xa;MoneySecurityOffPremises	,	&#xd;&#xa;WaterBackupSump	,	&#xd;&#xa;SprinkleredBuildings	,	&#xd;&#xa;SurveillanceCams	,	&#xd;&#xa;GatedComplexKeyAccess	,	&#xd;&#xa;EQRetrofit	,	&#xd;&#xa;UnitsPerBuilding	,	&#xd;&#xa;NumStories	,	&#xd;&#xa;ConstructionQuality	,	&#xd;&#xa;BurglaryRobbery	,	&#xd;&#xa;NFPAClassification	,	&#xd;&#xa;AreasOfCoverage	,	&#xd;&#xa;CODetector	,	&#xd;&#xa;SmokeDetector	,	&#xd;&#xa;SmokeDetectorInspectInd	,	&#xd;&#xa;WaterHeaterSecured	,	&#xd;&#xa;BoltedOrSecured	,	&#xd;&#xa;SoftStoryCripple	,	&#xd;&#xa;SeniorHousingPct	,	&#xd;&#xa;DesignatedSeniorHousing	,	&#xd;&#xa;StudentHousingPct	,	&#xd;&#xa;DesignatedStudentHousing	,	&#xd;&#xa;PriorLosses	,	&#xd;&#xa;TenantEvictions	,	&#xd;&#xa;VacancyRateExceed	,	&#xd;&#xa;SeasonalRentals	,	&#xd;&#xa;CondoInsuingAgmt	,	&#xd;&#xa;GasValve	,	&#xd;&#xa;OwnerOccupiedPct	,	&#xd;&#xa;RestaurantName	,	&#xd;&#xa;HoursOfOperation	,	&#xd;&#xa;RestaurantSqFt	,	&#xd;&#xa;SeatingCapacity	,	&#xd;&#xa;AnnualGrossSales	,	&#xd;&#xa;SeasonalOrClosed	,	&#xd;&#xa;BarCocktailLounge	,	&#xd;&#xa;LiveEntertainment	,	&#xd;&#xa;BeerWineGrossSales	,	&#xd;&#xa;DistilledSpiritsServed	,	&#xd;&#xa;KitchenDeepFryer	,	&#xd;&#xa;SolidFuelCooking	,	&#xd;&#xa;ANSULSystem	,	&#xd;&#xa;ANSULAnnualInspection	,	&#xd;&#xa;TenantNamesList	,	&#xd;&#xa;TenantBusinessType	,	&#xd;&#xa;TenantGLLiability	,	&#xd;&#xa;InsuredOccupiedPortion	,	&#xd;&#xa;ValetParking	,	&#xd;&#xa;LessorSqFt	,	&#xd;&#xa;BuildingRiskNumber	,	&#xd;&#xa;MultiPolicyIndUmbrella	,	&#xd;&#xa;PoolInd	,	&#xd;&#xa;StudsUpRenovation	,	&#xd;&#xa;StudsUpRenovationCompleteYear	,	&#xd;&#xa;MultiPolicyNumberUmbrella	,	&#xd;&#xa;RCTMSBAmt	,	&#xd;&#xa;RCTMSBHomeStyle	,	&#xd;&#xa;WINSOverrideNonSmokerDiscount	,	&#xd;&#xa;WINSOverrideSeniorDiscount	,	&#xd;&#xa;ITV	,	&#xd;&#xa;ITVDate	,	&#xd;&#xa;MSBReportType	,	&#xd;&#xa;VandalismDesiredInd	,	&#xd;&#xa;WoodShakeSiding	,	&#xd;&#xa;CSEAgent	,	&#xd;&#xa;PropertyManager	,	&#xd;&#xa;RentersInsurance	,	&#xd;&#xa;WaterDetectionDevice	,	&#xd;&#xa;AutoHomeInd	,	&#xd;&#xa;EarthquakeUmbrellaInd	,	&#xd;&#xa;LandlordInd	,	&#xd;&#xa;LossAssessment	,	&#xd;&#xa;GasShutOffInd	,	&#xd;&#xa;WaterDed	,	&#xd;&#xa;ServiceLine	,	&#xd;&#xa;FunctionalReplacementCost	,	&#xd;&#xa;MilesOfStreet	,	&#xd;&#xa;HOAExteriorStructure	,	&#xd;&#xa;RetailPortionDevelopment	,	&#xd;&#xa;LightIndustrialType	,	&#xd;&#xa;LightIndustrialDescription	,	&#xd;&#xa;PoolCoverageLimit	,	&#xd;&#xa;MultifamilyResidentialBuildings	,	&#xd;&#xa;SinglefamilyDwellings	,	&#xd;&#xa;AnnualPayroll	,	&#xd;&#xa;AnnualRevenue	,	&#xd;&#xa;BedsOccupied	,	&#xd;&#xa;EmergencyLighting	,	&#xd;&#xa;ExitSignsPosted	,	&#xd;&#xa;FullTimeStaff	,	&#xd;&#xa;LicensedBeds	,	&#xd;&#xa;NumberofFireExtinguishers	,	&#xd;&#xa;OtherFireExtinguishers	,	&#xd;&#xa;OxygenTanks	,	&#xd;&#xa;PartTimeStaff	,	&#xd;&#xa;SmokingPermitted	,	&#xd;&#xa;StaffOnDuty	,	&#xd;&#xa;TypeofFireExtinguishers	,	&#xd;&#xa;SourceSystem,		&#xd;&#xa;LOADDATE	,	&#xd;&#xa;audit_id ,		&#xd;&#xa;original_valid_fromdate,		&#xd;&#xa;original_valid_todate		&#xd;&#xa;&#x29;		&#xd;&#xa;SELECT		&#xd;&#xa;-&#x23;max_building_id.m - row_number&#x28;&#x29; over &#x28;order by building_uniqueid,ChangeDate&#x29; building_ID ,		&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_FROMDATE ,		&#xd;&#xa; &#x27;1900-01-01&#x27; VALID_TODATE ,		&#xd;&#xa;-1 RECORD_VERSION	, 	&#xd;&#xa;BUILDING_UniqueId	,	&#xd;&#xa;p.pol_uniqueid Policy_Uniqueid,		&#xd;&#xa;Policy_Id,		&#xd;&#xa;spinnbuilding_id,		&#xd;&#xa;Status,		&#xd;&#xa;Building_NaturalKey,		&#xd;&#xa;StateProvCd,		&#xd;&#xa;County,		&#xd;&#xa;PostalCode,		&#xd;&#xa;City,		&#xd;&#xa;Addr1,		&#xd;&#xa;Addr2,		&#xd;&#xa;BldgNumber	,	&#xd;&#xa;BusinessCategory	,	&#xd;&#xa;BusinessClass	,	&#xd;&#xa;ConstructionCd	,	&#xd;&#xa;RoofCd	,	&#xd;&#xa;YearBuilt	,	&#xd;&#xa;SqFt	,	&#xd;&#xa;Stories	,	&#xd;&#xa;Units	,	&#xd;&#xa;OccupancyCd	,	&#xd;&#xa;ProtectionClass	,	&#xd;&#xa;TerritoryCd	,	&#xd;&#xa;BuildingLimit	,	&#xd;&#xa;ContentsLimit	,	&#xd;&#xa;ValuationMethod	,	&#xd;&#xa;InflationGuardPct	,	&#xd;&#xa;OrdinanceOrLawInd	,	&#xd;&#xa;ScheduledPremiumMod	,	&#xd;&#xa;WindHailExclusion	,	&#xd;&#xa;CovALimit	,	&#xd;&#xa;CovBLimit	,	&#xd;&#xa;CovCLimit	,	&#xd;&#xa;CovDLimit	,	&#xd;&#xa;CovELimit	,	&#xd;&#xa;CovFLimit	,	&#xd;&#xa;AllPerilDed	,	&#xd;&#xa;BurglaryAlarmType	,	&#xd;&#xa;FireAlarmType	,	&#xd;&#xa;CovBLimitIncluded	,	&#xd;&#xa;CovBLimitIncrease	,	&#xd;&#xa;CovCLimitIncluded	,	&#xd;&#xa;CovCLimitIncrease	,	&#xd;&#xa;CovDLimitIncluded	,	&#xd;&#xa;CovDLimitIncrease	,	&#xd;&#xa;OrdinanceOrLawPct	,	&#xd;&#xa;NeighborhoodCrimeWatchInd	,	&#xd;&#xa;EmployeeCreditInd	,	&#xd;&#xa;MultiPolicyInd	,	&#xd;&#xa;HomeWarrantyCreditInd	,	&#xd;&#xa;YearOccupied	,	&#xd;&#xa;YearPurchased	,	&#xd;&#xa;TypeOfStructure	,	&#xd;&#xa;FeetToFireHydrant	,	&#xd;&#xa;NumberOfFamilies	,	&#xd;&#xa;MilesFromFireStation	,	&#xd;&#xa;Rooms	,	&#xd;&#xa;RoofPitch	,	&#xd;&#xa;FireDistrict	,	&#xd;&#xa;SprinklerSystem	,	&#xd;&#xa;FireExtinguisherInd	,	&#xd;&#xa;KitchenFireExtinguisherInd	,	&#xd;&#xa;DeadboltInd	,	&#xd;&#xa;GatedCommunityInd	,	&#xd;&#xa;CentralHeatingInd	,	&#xd;&#xa;Foundation	,	&#xd;&#xa;WiringRenovation	,	&#xd;&#xa;WiringRenovationCompleteYear	,	&#xd;&#xa;PlumbingRenovation	,	&#xd;&#xa;HeatingRenovation	,	&#xd;&#xa;PlumbingRenovationCompleteYear	,	&#xd;&#xa;ExteriorPaintRenovation	,	&#xd;&#xa;HeatingRenovationCompleteYear	,	&#xd;&#xa;CircuitBreakersInd	,	&#xd;&#xa;CopperWiringInd	,	&#xd;&#xa;ExteriorPaintRenovationCompleteYear	,	&#xd;&#xa;CopperPipesInd	,	&#xd;&#xa;EarthquakeRetrofitInd	,	&#xd;&#xa;PrimaryFuelSource	,	&#xd;&#xa;SecondaryFuelSource	,	&#xd;&#xa;UsageType	,	&#xd;&#xa;HomegardCreditInd	,	&#xd;&#xa;MultiPolicyNumber	,	&#xd;&#xa;LocalFireAlarmInd	,	&#xd;&#xa;NumLosses	,	&#xd;&#xa;CovALimitIncrease	,	&#xd;&#xa;CovALimitIncluded	,	&#xd;&#xa;MonthsRentedOut	,	&#xd;&#xa;RoofReplacement	,	&#xd;&#xa;SafeguardPlusInd	,	&#xd;&#xa;CovELimitIncluded	,	&#xd;&#xa;RoofReplacementCompleteYear	,	&#xd;&#xa;CovELimitIncrease	,	&#xd;&#xa;OwnerOccupiedUnits	,	&#xd;&#xa;TenantOccupiedUnits	,	&#xd;&#xa;ReplacementCostDwellingInd	,	&#xd;&#xa;FeetToPropertyLine	,	&#xd;&#xa;GalvanizedPipeInd	,	&#xd;&#xa;WorkersCompInservant	,	&#xd;&#xa;WorkersCompOutservant	,	&#xd;&#xa;LiabilityTerritoryCd	,	&#xd;&#xa;PremisesLiabilityMedPayInd	,	&#xd;&#xa;RelatedPrivateStructureExclusion	,	&#xd;&#xa;VandalismExclusion	,	&#xd;&#xa;VandalismInd	,	&#xd;&#xa;RoofExclusion	,	&#xd;&#xa;ExpandedReplacementCostInd	,	&#xd;&#xa;ReplacementValueInd	,	&#xd;&#xa;OtherPolicyNumber1	,	&#xd;&#xa;OtherPolicyNumber2	,	&#xd;&#xa;OtherPolicyNumber3	,	&#xd;&#xa;PrimaryPolicyNumber	,	&#xd;&#xa;OtherPolicyNumbers	,	&#xd;&#xa;ReportedFireHazardScore	,	&#xd;&#xa;FireHazardScore	,	&#xd;&#xa;ReportedSteepSlopeInd	,	&#xd;&#xa;SteepSlopeInd	,	&#xd;&#xa;ReportedHomeReplacementCost	,	&#xd;&#xa;ReportedProtectionClass	,	&#xd;&#xa;EarthquakeZone	,	&#xd;&#xa;MMIScore	,	&#xd;&#xa;HomeInspectionDiscountInd	,	&#xd;&#xa;RatingTier	,	&#xd;&#xa;SoilTypeCd	,	&#xd;&#xa;ReportedFireLineAssessment	,	&#xd;&#xa;AAISFireProtectionClass	,	&#xd;&#xa;InspectionScore	,	&#xd;&#xa;AnnualRents	,	&#xd;&#xa;PitchOfRoof	,	&#xd;&#xa;TotalLivingSqFt	,	&#xd;&#xa;ParkingSqFt	,	&#xd;&#xa;ParkingType	,	&#xd;&#xa;RetrofitCompleted	,	&#xd;&#xa;NumPools	,	&#xd;&#xa;FullyFenced	,	&#xd;&#xa;DivingBoard	,	&#xd;&#xa;Gym	,	&#xd;&#xa;FreeWeights	,	&#xd;&#xa;WireFencing	,	&#xd;&#xa;OtherRecreational	,	&#xd;&#xa;OtherRecreationalDesc	,	&#xd;&#xa;HealthInspection	,	&#xd;&#xa;HealthInspectionDt	,	&#xd;&#xa;HealthInspectionCited	,	&#xd;&#xa;PriorDefectRepairs	,	&#xd;&#xa;MSBReconstructionEstimate	,	&#xd;&#xa;BIIndemnityPeriod	,	&#xd;&#xa;EquipmentBreakdown	,	&#xd;&#xa;MoneySecurityOnPremises	,	&#xd;&#xa;MoneySecurityOffPremises	,	&#xd;&#xa;WaterBackupSump	,	&#xd;&#xa;SprinkleredBuildings	,	&#xd;&#xa;SurveillanceCams	,	&#xd;&#xa;GatedComplexKeyAccess	,	&#xd;&#xa;EQRetrofit	,	&#xd;&#xa;UnitsPerBuilding	,	&#xd;&#xa;NumStories	,	&#xd;&#xa;ConstructionQuality	,	&#xd;&#xa;BurglaryRobbery	,	&#xd;&#xa;NFPAClassification	,	&#xd;&#xa;AreasOfCoverage	,	&#xd;&#xa;CODetector	,	&#xd;&#xa;SmokeDetector	,	&#xd;&#xa;SmokeDetectorInspectInd	,	&#xd;&#xa;WaterHeaterSecured	,	&#xd;&#xa;BoltedOrSecured	,	&#xd;&#xa;SoftStoryCripple	,	&#xd;&#xa;SeniorHousingPct	,	&#xd;&#xa;DesignatedSeniorHousing	,	&#xd;&#xa;StudentHousingPct	,	&#xd;&#xa;DesignatedStudentHousing	,	&#xd;&#xa;PriorLosses	,	&#xd;&#xa;TenantEvictions	,	&#xd;&#xa;VacancyRateExceed	,	&#xd;&#xa;SeasonalRentals	,	&#xd;&#xa;CondoInsuingAgmt	,	&#xd;&#xa;GasValve	,	&#xd;&#xa;OwnerOccupiedPct	,	&#xd;&#xa;RestaurantName	,	&#xd;&#xa;HoursOfOperation	,	&#xd;&#xa;RestaurantSqFt	,	&#xd;&#xa;SeatingCapacity	,	&#xd;&#xa;AnnualGrossSales	,	&#xd;&#xa;SeasonalOrClosed	,	&#xd;&#xa;BarCocktailLounge	,	&#xd;&#xa;LiveEntertainment	,	&#xd;&#xa;BeerWineGrossSales	,	&#xd;&#xa;DistilledSpiritsServed	,	&#xd;&#xa;KitchenDeepFryer	,	&#xd;&#xa;SolidFuelCooking	,	&#xd;&#xa;ANSULSystem	,	&#xd;&#xa;ANSULAnnualInspection	,	&#xd;&#xa;TenantNamesList	,	&#xd;&#xa;TenantBusinessType	,	&#xd;&#xa;TenantGLLiability	,	&#xd;&#xa;InsuredOccupiedPortion	,	&#xd;&#xa;ValetParking	,	&#xd;&#xa;LessorSqFt	,	&#xd;&#xa;BuildingRiskNumber	,	&#xd;&#xa;MultiPolicyIndUmbrella	,	&#xd;&#xa;PoolInd	,	&#xd;&#xa;StudsUpRenovation	,	&#xd;&#xa;StudsUpRenovationCompleteYear	,	&#xd;&#xa;MultiPolicyNumberUmbrella	,	&#xd;&#xa;RCTMSBAmt	,	&#xd;&#xa;RCTMSBHomeStyle	,	&#xd;&#xa;WINSOverrideNonSmokerDiscount	,	&#xd;&#xa;WINSOverrideSeniorDiscount	,	&#xd;&#xa;ITV	,	&#xd;&#xa;ITVDate	,	&#xd;&#xa;MSBReportType	,	&#xd;&#xa;VandalismDesiredInd	,	&#xd;&#xa;WoodShakeSiding	,	&#xd;&#xa;CSEAgent	,	&#xd;&#xa;PropertyManager	,	&#xd;&#xa;RentersInsurance	,	&#xd;&#xa;WaterDetectionDevice	,	&#xd;&#xa;AutoHomeInd	,	&#xd;&#xa;EarthquakeUmbrellaInd	,	&#xd;&#xa;LandlordInd	,	&#xd;&#xa;LossAssessment	,	&#xd;&#xa;GasShutOffInd	,	&#xd;&#xa;WaterDed	,	&#xd;&#xa;ServiceLine	,	&#xd;&#xa;FunctionalReplacementCost	,	&#xd;&#xa;MilesOfStreet	,	&#xd;&#xa;HOAExteriorStructure	,	&#xd;&#xa;RetailPortionDevelopment	,	&#xd;&#xa;LightIndustrialType	,	&#xd;&#xa;LightIndustrialDescription	,	&#xd;&#xa;PoolCoverageLimit,		&#xd;&#xa;MultifamilyResidentialBuildings	,	&#xd;&#xa;SinglefamilyDwellings	,	&#xd;&#xa;AnnualPayroll	,	&#xd;&#xa;AnnualRevenue	,	&#xd;&#xa;BedsOccupied	,	&#xd;&#xa;EmergencyLighting	,	&#xd;&#xa;ExitSignsPosted	,	&#xd;&#xa;FullTimeStaff	,	&#xd;&#xa;LicensedBeds	,	&#xd;&#xa;NumberofFireExtinguishers	,	&#xd;&#xa;OtherFireExtinguishers	,	&#xd;&#xa;OxygenTanks	,	&#xd;&#xa;PartTimeStaff	,	&#xd;&#xa;SmokingPermitted	,	&#xd;&#xa;StaffOnDuty	,	&#xd;&#xa;TypeofFireExtinguishers	,	&#xd;&#xa;SourceSystem,		&#xd;&#xa;cast&#x28;&#x27;01-01-1900&#x27; as date&#x29; LoadDate	,	&#xd;&#xa;112 audit_id ,		&#xd;&#xa;ChangeDate original_valid_fromdate,		&#xd;&#xa;ChangeDate original_valid_todate		&#xd;&#xa;from  &#x23;stg_building  stg 		&#xd;&#xa;join fsbi_dw_spinn.dbo.dim_policy p		&#xd;&#xa; on cast&#x28;stg.policyRef as varchar&#x29;&#x3d;p.pol_uniqueid		&#xd;&#xa;join &#x23;max_building_id on 1&#x3d;1		&#xd;&#xa;where Hist_Flg&#x3d;&#x27;Y&#x27;&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;	&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;&#x2f;&#x2a;run several times till 0 deleted and run adjust record_version at the end&#x2a;&#x2f;		&#xd;&#xa;&#x2f;&#x2a;		&#xd;&#xa;Few corrupted records		&#xd;&#xa;1050361_Building-933552249-697123961_1		&#xd;&#xa;1164182_Building-1032418240-711364767_1		&#xd;&#xa;914070_DTOBuilding-1946511364-250616350_1		&#xd;&#xa;996030_DTOBuilding-528126851-678071706_1		&#xd;&#xa;&#x2a;&#x2f;		&#xd;&#xa;update FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;set audit_id&#x3d;113		&#xd;&#xa;where BUILDING_id in &#x28;select BUILDING_id from FSBI_DW_SPINN.dbo.DIM_BUILDING v		&#xd;&#xa;join 		&#xd;&#xa;&#x28;select		&#xd;&#xa; BUILDING_Uniqueid		&#xd;&#xa;,valid_fromdate		&#xd;&#xa;,valid_todate		&#xd;&#xa;,min&#x28;record_version&#x29; record_version		&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;where audit_id&#x3d;0		&#xd;&#xa;group by 		&#xd;&#xa;BUILDING_Uniqueid		&#xd;&#xa;,valid_fromdate		&#xd;&#xa;,valid_todate		&#xd;&#xa;having count&#x28;BUILDING_id&#x29;&#x3e;1&#x29; d		&#xd;&#xa;on v.BUILDING_Uniqueid&#x3d;d.BUILDING_Uniqueid		&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate		&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate		&#xd;&#xa;and v.record_version&#x3d;d.record_version		&#xd;&#xa;&#x29;		&#xd;&#xa;and audit_id&#x3d;0&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;delete from FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;where BUILDING_id in &#x28;select BUILDING_id from FSBI_DW_SPINN.dbo.DIM_BUILDING v		&#xd;&#xa;join 		&#xd;&#xa;&#x28;select		&#xd;&#xa; BUILDING_Uniqueid		&#xd;&#xa;,valid_fromdate		&#xd;&#xa;,valid_todate		&#xd;&#xa;,min&#x28;record_version&#x29; record_version		&#xd;&#xa;from FSBI_DW_SPINN.dbo.DIM_BUILDING		&#xd;&#xa;where audit_id&#x3d;0		&#xd;&#xa;group by 		&#xd;&#xa;BUILDING_Uniqueid		&#xd;&#xa;,valid_fromdate		&#xd;&#xa;,valid_todate		&#xd;&#xa;having count&#x28;BUILDING_id&#x29;&#x3e;1&#x29; d		&#xd;&#xa;on v.BUILDING_Uniqueid&#x3d;d.BUILDING_Uniqueid		&#xd;&#xa;and v.valid_fromdate&#x3d;d.valid_fromdate		&#xd;&#xa;and v.valid_todate&#x3d;d.valid_todate		&#xd;&#xa;and v.record_version&#x3d;d.record_version		&#xd;&#xa;&#x29;		&#xd;&#xa;and audit_id&#x3d;0&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;update fsbi_dw_spinn.dbo.DIM_BUILDING		&#xd;&#xa;set audit_id&#x3d;114		&#xd;&#xa;where  BUILDING_id in &#x28;select d2.BUILDING_id 		&#xd;&#xa;from fsbi_dw_spinn.dbo.DIM_BUILDING d		&#xd;&#xa;join fsbi_dw_spinn.dbo.DIM_BUILDING d2		&#xd;&#xa;on d.BUILDING_uniqueid&#x3d;d2.BUILDING_uniqueid		&#xd;&#xa;and d.valid_fromdate&#x3d;d2.valid_fromdate		&#xd;&#xa;and d2.valid_fromdate&#x3c;&#x3e;d2.valid_todate		&#xd;&#xa;where d.valid_fromdate&#x3d;d.valid_todate		&#xd;&#xa;and d.audit_id in &#x28;0,113&#x29;		&#xd;&#xa;and d2.audit_id in &#x28;0,113&#x29;&#x29;&#x3b;		&#xd;&#xa;		&#xd;&#xa;		&#xd;&#xa;delete from fsbi_dw_spinn.dbo.DIM_BUILDING		&#xd;&#xa;where valid_fromdate&#x3d;valid_todate		&#xd;&#xa;and audit_id in &#x28;0,113&#x29;&#x3b;		&#xd;&#xa;</sql>
      <useVariableSubstitution>T</useVariableSubstitution>
      <sqlfromfile>F</sqlfromfile>
      <sqlfilename/>
      <sendOneStatement>T</sendOneStatement>
      <connection>4SBI_DataWarehouse</connection>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>346</xloc>
      <yloc>562</yloc>
      </entry>
    <entry>
      <name>TR_DIM_BUILDINGRISK_HISTORICAL</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_BUILDINGRISK_HISTORICAL</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>88</xloc>
      <yloc>633</yloc>
      </entry>
    <entry>
      <name>TR_DIM_LOCATION_HISTORICAL</name>
      <description/>
      <type>TRANS</type>
      <specification_method>rep_name</specification_method>
      <trans_object_id/>
      <filename/>
      <transname>TR_DIM_LOCATION_HISTORICAL</transname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Dimension_Transformations</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <clear_rows>N</clear_rows>
      <clear_files>N</clear_files>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Basic</loglevel>
      <cluster>N</cluster>
      <slave_server_name/>
      <set_append_logfile>N</set_append_logfile>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <create_parent_folder>N</create_parent_folder>
      <logging_remote_work>N</logging_remote_work>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>308</xloc>
      <yloc>639</yloc>
      </entry>
    <entry>
      <name>SJB_Dimensions_Applications_Tasks</name>
      <description/>
      <type>JOB</type>
      <specification_method>rep_name</specification_method>
      <job_object_id/>
      <filename/>
      <jobname>SJB_Dimensions_Applications_Tasks</jobname>
      <directory>&#x2f;Custom_ETL&#x2f;Custom_Job</directory>
      <arg_from_previous>N</arg_from_previous>
      <params_from_previous>N</params_from_previous>
      <exec_per_row>N</exec_per_row>
      <set_logfile>N</set_logfile>
      <logfile/>
      <logext/>
      <add_date>N</add_date>
      <add_time>N</add_time>
      <loglevel>Nothing</loglevel>
      <slave_server_name/>
      <wait_until_finished>Y</wait_until_finished>
      <follow_abort_remote>N</follow_abort_remote>
      <expand_remote_job>N</expand_remote_job>
      <create_parent_folder>N</create_parent_folder>
      <pass_export>N</pass_export>
      <force_separate_logging>N</force_separate_logging>
      <parameters>        <pass_all_parameters>Y</pass_all_parameters>
      </parameters>      <set_append_logfile>N</set_append_logfile>
      <parallel>N</parallel>
      <draw>Y</draw>
      <nr>0</nr>
      <xloc>807</xloc>
      <yloc>844</yloc>
      </entry>
  </entries>
  <hops>
    <hop>
      <from>START</from>
      <to>TR_DIM_DRIVER</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_VEHICLE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_BUILDING</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_BUILDINGRISK</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_LOCATION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_CATASTROPHE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_DRIVER</from>
      <to>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_DRIVER</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_VEHICLE</from>
      <to>SQL Adjusting Record_Version in Late Coming SCD Type 2 records  in DIM_VEHICLE</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_BUILDING</from>
      <to>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_BUILDING</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_CARFAX</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>SQL DIM_VEHICLE Historical Load</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>SQL DIM_DRIVER Historical Load</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>SQL DIM_BUILDING Historical Load</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_BUILDINGRISK</from>
      <to>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_BUILDINGRISK</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_LOCATION</from>
      <to>SQL Adjusting Record_Version in Late Coming SCD Type 2 records in DIM_LOCATION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_BUILDINGRISK_HISTORICAL</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_BUILDINGRISK_HISTORICAL</from>
      <to>SQL After Historical Load Only - Adjusting DIM_BUILDINGRISK</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>TR_DIM_LOCATION_HISTORICAL</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
    <hop>
      <from>TR_DIM_LOCATION_HISTORICAL</from>
      <to>SQL After Historical Load Only - Adjusting DIM_LOCATION</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>N</enabled>
      <evaluation>Y</evaluation>
      <unconditional>N</unconditional>
    </hop>
    <hop>
      <from>START</from>
      <to>SJB_Dimensions_Applications_Tasks</to>
      <from_nr>0</from_nr>
      <to_nr>0</to_nr>
      <enabled>Y</enabled>
      <evaluation>Y</evaluation>
      <unconditional>Y</unconditional>
    </hop>
  </hops>
  <notepads>
    <notepad>
      <note>DIM_BUILDING, DIM_VEHICLE and DIM_DRIVER Initial load is done via SQL&#xd;&#xa;Pentaho SPOON is too slow&#xd;&#xa;</note>
      <xloc>81</xloc>
      <yloc>815</yloc>
      <width>505</width>
      <heigth>70</heigth>
      <fontname>Segoe UI</fontname>
      <fontsize>9</fontsize>
      <fontbold>N</fontbold>
      <fontitalic>N</fontitalic>
      <fontcolorred>0</fontcolorred>
      <fontcolorgreen>0</fontcolorgreen>
      <fontcolorblue>0</fontcolorblue>
      <backgroundcolorred>255</backgroundcolorred>
      <backgroundcolorgreen>205</backgroundcolorgreen>
      <backgroundcolorblue>112</backgroundcolorblue>
      <bordercolorred>100</bordercolorred>
      <bordercolorgreen>100</bordercolorgreen>
      <bordercolorblue>100</bordercolorblue>
      <drawshadow>Y</drawshadow>
    </notepad>
  </notepads>
<attributes><group><name>JobRestart</name>
<attribute><key>UniqueConnections</key>
<value>N</value>
</attribute></group></attributes>

</job>
